<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Introduction to R</title>
  <meta name="description" content="This is the course handbook for the Glasgow University Open Studies course Introduction to R, academic session 2022." />
  <meta name="generator" content="bookdown #bookdown:version# and GitBook 2.6.7" />

  <meta property="og:title" content="Introduction to R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is the course handbook for the Glasgow University Open Studies course Introduction to R, academic session 2022." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Introduction to R" />
  
  <meta name="twitter:description" content="This is the course handbook for the Glasgow University Open Studies course Introduction to R, academic session 2022." />
  

<meta name="author" content="Gaby Mahrholz, Greta Todorova, Wilhelmiina Toivo, and Jaimie Torrance, updated by Johanna Werner in 2022" />


<meta name="date" content="2022-05-07" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<!--bookdown:link_prev-->
<!--bookdown:link_next-->
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



<!--bookdown:title:start-->
<div id="header">
<h1 class="title">Introduction to R</h1>
<p class="author"><em>Gaby Mahrholz, Greta Todorova, Wilhelmiina Toivo, and Jaimie Torrance, updated by Johanna Werner in 2022</em></p>
<p class="date"><em>2022-05-07</em></p>
</div>
<!--bookdown:title:end-->

<!--bookdown:toc:start-->
  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">
<!--bookdown:toc2:start-->
<ul>
<li><a href="#about-this-course">About this course<span></span></a>
<ul>
<li><a href="#intended-learning-outcomes">Intended Learning Outcomes<span></span></a></li>
<li><a href="#what-will-i-need-to-complete-this-course">What will I need to complete this course?<span></span></a></li>
<li><a href="#about-the-assessments">About the Assessments<span></span></a>
<ul>
<li><a href="#formative-assessments">Formative Assessments<span></span></a></li>
<li><a href="#summative-assessments">Summative Assessments<span></span></a></li>
<li><a href="#late-submissions-extensions">Late submissions &amp; extensions<span></span></a></li>
<li><a href="#how-to-submit-your-assessments">How to Submit Your Assessments<span></span></a></li>
</ul></li>
<li><a href="#assistance">Assistance<span></span></a></li>
<li><a href="#why-are-these-materials-open">Why are these materials open?<span></span></a></li>
<li><a href="#acknowledgement">Acknowledgement<span></span></a></li>
</ul></li>
<li><a href="#before">Assignment before starting the course<span></span></a>
<ul>
<li><a href="#accessing"><span class="toc-section-number">0.1</span> Access to RStudio<span></span></a>
<ul>
<li><a href="#install"><span class="toc-section-number">0.1.1</span> Installing R and RStudio on Your Own Machine<span></span></a></li>
<li><a href="#accessing-rstudio-on-university-computers"><span class="toc-section-number">0.1.2</span> Accessing RStudio on University Computers<span></span></a></li>
<li><a href="#using-rstudio-cloud"><span class="toc-section-number">0.1.3</span> Using RStudio Cloud<span></span></a></li>
</ul></li>
<li><a href="#maximising-reproducibility-and-visibility"><span class="toc-section-number">0.2</span> Maximising Reproducibility and Visibility<span></span></a></li>
</ul></li>
<li><a href="#introduction"><span class="toc-section-number">1</span> Introduction<span></span></a>
<ul>
<li><a href="#intended-learning-outcomes-1">Intended Learning Outcomes<span></span></a></li>
<li><a href="#computer-literacy-basics"><span class="toc-section-number">1.1</span> Computer Literacy Basics<span></span></a></li>
<li><a href="#r-and-r-studio"><span class="toc-section-number">1.2</span> R and R Studio<span></span></a>
<ul>
<li><a href="#r"><span class="toc-section-number">1.2.1</span> R<span></span></a></li>
<li><a href="#rstudio-ide"><span class="toc-section-number">1.2.2</span> RStudio IDE<span></span></a></li>
</ul></li>
<li><a href="#r-r-studio-and-associated-file-types"><span class="toc-section-number">1.3</span> R, R Studio and Associated File Types<span></span></a>
<ul>
<li><a href="#file-structuredirectories"><span class="toc-section-number">1.3.1</span> File Structure/Directories<span></span></a></li>
<li><a href="#file-extensions"><span class="toc-section-number">1.3.2</span> File Extensions<span></span></a></li>
<li><a href="#zip-files"><span class="toc-section-number">1.3.3</span> .zip Files<span></span></a></li>
<li><a href="#rstudio-specific-files"><span class="toc-section-number">1.3.4</span> RStudio Specific Files<span></span></a></li>
<li><a href="#r-files"><span class="toc-section-number">1.3.5</span> .r Files<span></span></a></li>
<li><a href="#rmd-files"><span class="toc-section-number">1.3.6</span> .Rmd files<span></span></a></li>
</ul></li>
<li><a href="#comments"><span class="toc-section-number">1.4</span> Comments<span></span></a></li>
<li><a href="#saving-your-file"><span class="toc-section-number">1.5</span> Saving your file<span></span></a></li>
<li><a href="#sessions"><span class="toc-section-number">1.6</span> Sessions<span></span></a>
<ul>
<li><a href="#what-is-a-session-in-r"><span class="toc-section-number">1.6.1</span> What is a session in R?<span></span></a></li>
<li><a href="#restarting-your-current-session"><span class="toc-section-number">1.6.2</span> Restarting Your Current Session<span></span></a></li>
</ul></li>
<li><a href="#packages"><span class="toc-section-number">1.7</span> Packages<span></span></a>
<ul>
<li><a href="#installing-packages"><span class="toc-section-number">1.7.1</span> Installing Packages<span></span></a></li>
<li><a href="#load-tidyverse"><span class="toc-section-number">1.7.2</span> Loading Packages<span></span></a></li>
</ul></li>
<li><a href="#functions"><span class="toc-section-number">1.8</span> Functions<span></span></a>
<ul>
<li><a href="#what-is-a-function"><span class="toc-section-number">1.8.1</span> What is a function?<span></span></a></li>
<li><a href="#the-anatomy-of-a-function-names-and-arguments"><span class="toc-section-number">1.8.2</span> The Anatomy of a Function: names and arguments<span></span></a></li>
</ul></li>
<li><a href="#formative-homework"><span class="toc-section-number">1.9</span> Formative Homework<span></span></a>
<ul>
<li><a href="#install-r-and-rstudio-on-your-personal-computer"><span class="toc-section-number">1.9.1</span> Install R and RStudio on your personal computer<span></span></a></li>
<li><a href="#installing-and-loading-tidyverse"><span class="toc-section-number">1.9.2</span> Installing and Loading tidyverse<span></span></a></li>
</ul></li>
</ul></li>
<li><a href="#introduction-to-data"><span class="toc-section-number">2</span> Introduction to Data<span></span></a>
<ul>
<li><a href="#intended-learning-outcomes-2">Intended Learning Outcomes<span></span></a></li>
<li><a href="#pre-steps"><span class="toc-section-number">2.1</span> Pre-Steps<span></span></a>
<ul>
<li><a href="#downloading-materials"><span class="toc-section-number">2.1.1</span> Downloading materials<span></span></a></li>
<li><a href="#unzipping-the-zip-folder"><span class="toc-section-number">2.1.2</span> Unzipping the zip folder<span></span></a></li>
<li><a href="#setting-the-working-directory"><span class="toc-section-number">2.1.3</span> Setting the working directory<span></span></a></li>
<li><a href="#load-tidyverse-into-the-library"><span class="toc-section-number">2.1.4</span> Load tidyverse into the library<span></span></a></li>
</ul></li>
<li><a href="#basic-data-types"><span class="toc-section-number">2.2</span> Basic data types<span></span></a>
<ul>
<li><a href="#character"><span class="toc-section-number">2.2.1</span> Character<span></span></a></li>
<li><a href="#numeric"><span class="toc-section-number">2.2.2</span> Numeric<span></span></a></li>
<li><a href="#logical"><span class="toc-section-number">2.2.3</span> Logical<span></span></a></li>
</ul></li>
<li><a href="#vectors"><span class="toc-section-number">2.3</span> Vectors<span></span></a>
<ul>
<li><a href="#creating-vectors"><span class="toc-section-number">2.3.1</span> Creating vectors<span></span></a></li>
<li><a href="#converting-vectors-into-different-data-types-of-vectors-aka-funky-things-we-can-do"><span class="toc-section-number">2.3.2</span> Converting vectors into different data types of vectors aka funky things we can do<span></span></a></li>
<li><a href="#adding-elements-to-existing-vectors"><span class="toc-section-number">2.3.3</span> Adding elements to existing vectors<span></span></a></li>
</ul></li>
<li><a href="#tibble---the-new-way-of-creating-a-dataframe"><span class="toc-section-number">2.4</span> Tibble - the new way of creating a dataframe<span></span></a>
<ul>
<li><a href="#what-the-heck-is-a-tibble-do-you-mean-table"><span class="toc-section-number">2.4.1</span> What the heck is a tibble? Do you mean table?<span></span></a></li>
<li><a href="#how-to-make-a-tibble-from-scratch"><span class="toc-section-number">2.4.2</span> How to make a tibble from scratch<span></span></a></li>
</ul></li>
<li><a href="#reading-in-data"><span class="toc-section-number">2.5</span> Reading in data<span></span></a>
<ul>
<li><a href="#from-pre-existing-databases"><span class="toc-section-number">2.5.1</span> from pre-existing databases<span></span></a></li>
<li><a href="#from-existing-data-files"><span class="toc-section-number">2.5.2</span> from existing data files<span></span></a></li>
</ul></li>
<li><a href="#last-point-for-today"><span class="toc-section-number">2.6</span> Last point for today<span></span></a></li>
<li><a href="#summative-homework"><span class="toc-section-number">2.7</span> Summative Homework<span></span></a></li>
</ul></li>
<li><a href="#data-transformation-1-basic-one-table-verbs"><span class="toc-section-number">3</span> Data Transformation 1: Basic One Table Verbs<span></span></a>
<ul>
<li><a href="#intended-learning-outcomes-3">Intended Learning Outcomes<span></span></a></li>
<li><a href="#data-wrangling"><span class="toc-section-number">3.1</span> Data Wrangling<span></span></a></li>
<li><a href="#pre-steps-1"><span class="toc-section-number">3.2</span> Pre-Steps<span></span></a>
<ul>
<li><a href="#downloading-materials-1"><span class="toc-section-number">3.2.1</span> Downloading materials<span></span></a></li>
<li><a href="#unzipping-the-zip-folder-1"><span class="toc-section-number">3.2.2</span> Unzipping the zip folder<span></span></a></li>
<li><a href="#setting-the-working-directory-1"><span class="toc-section-number">3.2.3</span> Setting the working directory<span></span></a></li>
<li><a href="#loading-in-the-required-packages-into-the-library"><span class="toc-section-number">3.2.4</span> Loading in the required packages into the library<span></span></a></li>
<li><a href="#read-in-the-data"><span class="toc-section-number">3.2.5</span> Read in the data<span></span></a></li>
<li><a href="#view-the-data"><span class="toc-section-number">3.2.6</span> View the data<span></span></a></li>
</ul></li>
<li><a href="#select"><span class="toc-section-number">3.3</span> select()<span></span></a></li>
<li><a href="#arrange"><span class="toc-section-number">3.4</span> arrange()<span></span></a></li>
<li><a href="#filter"><span class="toc-section-number">3.5</span> filter()<span></span></a>
<ul>
<li><a href="#single-criterion"><span class="toc-section-number">3.5.1</span> Single criterion<span></span></a></li>
<li><a href="#multiple-criteria"><span class="toc-section-number">3.5.2</span> Multiple criteria<span></span></a></li>
</ul></li>
<li><a href="#mutate"><span class="toc-section-number">3.6</span> mutate()<span></span></a>
<ul>
<li><a href="#read-in-second-dataset"><span class="toc-section-number">3.6.1</span> Read in second dataset<span></span></a></li>
</ul></li>
<li><a href="#summarise"><span class="toc-section-number">3.7</span> summarise()<span></span></a></li>
<li><a href="#adding-group_by"><span class="toc-section-number">3.8</span> Adding group_by()<span></span></a></li>
<li><a href="#formative-homework-1"><span class="toc-section-number">3.9</span> Formative Homework<span></span></a>
<ul>
<li><a href="#brief-introduction-to-the-homework-data"><span class="toc-section-number">3.9.1</span> Brief introduction to the homework data<span></span></a></li>
</ul></li>
</ul></li>
<li><a href="#data-transformation-2-more-one-and-two-table-verbs"><span class="toc-section-number">4</span> Data Transformation 2: More One and Two Table Verbs<span></span></a>
<ul>
<li><a href="#intended-learning-outcomes-4">Intended Learning Outcomes<span></span></a></li>
<li><a href="#pre-steps-2"><span class="toc-section-number">4.1</span> Pre-Steps<span></span></a></li>
<li><a href="#practicing-the-wikham-six"><span class="toc-section-number">4.2</span> Practicing the Wikham Six<span></span></a>
<ul>
<li><a href="#select-1"><span class="toc-section-number">4.2.1</span> select()<span></span></a></li>
<li><a href="#arrange-1"><span class="toc-section-number">4.2.2</span> arrange()<span></span></a></li>
<li><a href="#filter-1"><span class="toc-section-number">4.2.3</span> filter()<span></span></a></li>
<li><a href="#mutate-1"><span class="toc-section-number">4.2.4</span> mutate()<span></span></a></li>
<li><a href="#group_by-and-summarise"><span class="toc-section-number">4.2.5</span> group_by() and summarise()<span></span></a></li>
<li><a href="#bringing-it-all-together"><span class="toc-section-number">4.2.6</span> Bringing it all together<span></span></a></li>
</ul></li>
<li><a href="#pipes"><span class="toc-section-number">4.3</span> The pipe operator (%&gt;%)<span></span></a></li>
<li><a href="#two-table-verbs"><span class="toc-section-number">4.4</span> Two-Table Verbs<span></span></a>
<ul>
<li><a href="#bringing-in-new-data"><span class="toc-section-number">4.4.1</span> Bringing in new data<span></span></a></li>
<li><a href="#mutating-join-verbs"><span class="toc-section-number">4.4.2</span> Mutating Join Verbs<span></span></a></li>
<li><a href="#mutating-join-summary"><span class="toc-section-number">4.4.3</span> Mutating Join Summary<span></span></a></li>
<li><a href="#binding-join-verbs"><span class="toc-section-number">4.4.4</span> Binding Join Verbs<span></span></a></li>
</ul></li>
<li><a href="#additional-information"><span class="toc-section-number">4.5</span> Additional information<span></span></a></li>
<li><a href="#summative-homework-1"><span class="toc-section-number">4.6</span> Summative Homework<span></span></a></li>
</ul></li>
<li><a href="#data-transformation-3-tidy-data"><span class="toc-section-number">5</span> Data Transformation 3: Tidy Data<span></span></a>
<ul>
<li><a href="#intended-learning-outcomes-5">Intended Learning Outcomes<span></span></a></li>
<li><a href="#pre-steps-3"><span class="toc-section-number">5.1</span> Pre-steps<span></span></a></li>
<li><a href="#tidy-data"><span class="toc-section-number">5.2</span> Tidy data<span></span></a></li>
<li><a href="#pivot_longer-and-pivot_wider"><span class="toc-section-number">5.3</span> pivot_longer() and pivot_wider()<span></span></a>
<ul>
<li><a href="#pivot_longer"><span class="toc-section-number">5.3.1</span> pivot_longer()<span></span></a></li>
<li><a href="#pivot_wider"><span class="toc-section-number">5.3.2</span> pivot_wider()<span></span></a></li>
</ul></li>
<li><a href="#separate-and-unite"><span class="toc-section-number">5.4</span> separate() and unite()<span></span></a>
<ul>
<li><a href="#separate"><span class="toc-section-number">5.4.1</span> separate()<span></span></a></li>
<li><a href="#additional-arguments-for-separate"><span class="toc-section-number">5.4.2</span> additional arguments for separate()<span></span></a></li>
<li><a href="#unite"><span class="toc-section-number">5.4.3</span> unite()<span></span></a></li>
<li><a href="#additional-arguments-for-unite"><span class="toc-section-number">5.4.4</span> additional arguments for unite()<span></span></a></li>
</ul></li>
<li><a href="#bonus-materials-mutate-row-names-from-the-mtcars"><span class="toc-section-number">5.5</span> Bonus materials: mutate row names from the <code>mtcars</code><span></span></a></li>
<li><a href="#additional-information-1"><span class="toc-section-number">5.6</span> Additional information<span></span></a></li>
<li><a href="#formative-homework-2"><span class="toc-section-number">5.7</span> Formative Homework<span></span></a></li>
</ul></li>
<li><a href="#data-transformation-4-fine-tuned-data-manipulation"><span class="toc-section-number">6</span> Data Transformation 4: Fine-tuned Data Manipulation<span></span></a>
<ul>
<li><a href="#intended-learning-outcomes-6">Intended Learning Outcomes<span></span></a></li>
<li><a href="#pre-steps-4"><span class="toc-section-number">6.1</span> Pre-steps<span></span></a></li>
<li><a href="#rename"><span class="toc-section-number">6.2</span> rename()<span></span></a></li>
<li><a href="#conditional-statements"><span class="toc-section-number">6.3</span> Conditional statements<span></span></a>
<ul>
<li><a href="#recode"><span class="toc-section-number">6.3.1</span> recode()<span></span></a></li>
<li><a href="#ifelse"><span class="toc-section-number">6.3.2</span> ifelse()<span></span></a></li>
<li><a href="#case_when"><span class="toc-section-number">6.3.3</span> case_when()<span></span></a></li>
</ul></li>
<li><a href="#distinct"><span class="toc-section-number">6.4</span> distinct()<span></span></a></li>
<li><a href="#recap"><span class="toc-section-number">6.5</span> Recap<span></span></a>
<ul>
<li><a href="#question-1"><span class="toc-section-number">6.5.1</span> Question 1<span></span></a></li>
<li><a href="#question-2"><span class="toc-section-number">6.5.2</span> Question 2<span></span></a></li>
<li><a href="#question-3"><span class="toc-section-number">6.5.3</span> Question 3<span></span></a></li>
<li><a href="#question-4"><span class="toc-section-number">6.5.4</span> Question 4<span></span></a></li>
<li><a href="#question-5"><span class="toc-section-number">6.5.5</span> Question 5<span></span></a></li>
</ul></li>
<li><a href="#summative-homework-2"><span class="toc-section-number">6.6</span> Summative Homework<span></span></a></li>
</ul></li>
<li><a href="#data-visualisation-1"><span class="toc-section-number">7</span> Data Visualisation 1<span></span></a>
<ul>
<li><a href="#pre-class-activities"><span class="toc-section-number">7.1</span> Pre-class Activities<span></span></a></li>
<li><a href="#intended-learning-outcomes-7">Intended Learning Outcomes<span></span></a></li>
<li><a href="#pre-steps-5"><span class="toc-section-number">7.2</span> Pre-steps<span></span></a></li>
<li><a href="#introduction-to-the-data"><span class="toc-section-number">7.3</span> Introduction to the data<span></span></a></li>
<li><a href="#some-warm-up-tasks"><span class="toc-section-number">7.4</span> Some warm-up tasks<span></span></a></li>
<li><a href="#the-package-ggplot2"><span class="toc-section-number">7.5</span> The package GGPLOT2<span></span></a></li>
<li><a href="#layering"><span class="toc-section-number">7.6</span> Layering<span></span></a>
<ul>
<li><a href="#layer-1"><span class="toc-section-number">7.6.1</span> Layer 1<span></span></a></li>
<li><a href="#layer-2-and-onward"><span class="toc-section-number">7.6.2</span> Layer 2 and onward<span></span></a></li>
</ul></li>
<li><a href="#how-do-we-choose-the-type-of-plot"><span class="toc-section-number">7.7</span> How do we choose the type of plot?<span></span></a>
<ul>
<li><a href="#data-format"><span class="toc-section-number">7.7.1</span> Data format<span></span></a></li>
<li><a href="#number-of-variables"><span class="toc-section-number">7.7.2</span> Number of variables<span></span></a></li>
<li><a href="#types-of-plots"><span class="toc-section-number">7.7.3</span> Types of plots<span></span></a></li>
<li><a href="#groupings"><span class="toc-section-number">7.7.4</span> Groupings<span></span></a></li>
</ul></li>
<li><a href="#now-lets-have-a-look-at-different-plots-with-more-complexity"><span class="toc-section-number">7.8</span> Now let’s have a look at different plots with more complexity<span></span></a></li>
<li><a href="#other-plots"><span class="toc-section-number">7.9</span> Other plots<span></span></a></li>
<li><a href="#formative-homework-3"><span class="toc-section-number">7.10</span> Formative Homework<span></span></a></li>
</ul></li>
<li><a href="#data-visualisation-2"><span class="toc-section-number">8</span> Data Visualisation 2<span></span></a>
<ul>
<li><a href="#additional-resources"><span class="toc-section-number">8.1</span> Additional Resources<span></span></a></li>
<li><a href="#intended-learning-outcomes-8">Intended Learning Outcomes<span></span></a></li>
<li><a href="#pre-steps-6"><span class="toc-section-number">8.2</span> Pre-steps<span></span></a></li>
<li><a href="#re-introduction-to-the-data"><span class="toc-section-number">8.3</span> Re-introduction to the data<span></span></a></li>
<li><a href="#create-multiple-plots-in-one"><span class="toc-section-number">8.4</span> Create multiple plots in one<span></span></a>
<ul>
<li><a href="#select-the-data-beforehand-and-create-different-plots."><span class="toc-section-number">8.4.1</span> Select the data beforehand and create different plots.<span></span></a></li>
<li><a href="#facets"><span class="toc-section-number">8.4.2</span> Facets<span></span></a></li>
</ul></li>
<li><a href="#global-and-local-aesthetics"><span class="toc-section-number">8.5</span> Global and Local aesthetics<span></span></a></li>
<li><a href="#themes-making-your-plots-pretty-looking-the-way-you-want-them-to"><span class="toc-section-number">8.6</span> Themes: Making your plots pretty: looking the way you want them to<span></span></a>
<ul>
<li><a href="#ready-made-themes"><span class="toc-section-number">8.6.1</span> Ready-made themes<span></span></a></li>
<li><a href="#adding-axes-titles-and-headings"><span class="toc-section-number">8.6.2</span> Adding axes titles and headings<span></span></a></li>
</ul></li>
<li><a href="#changing-colours"><span class="toc-section-number">8.7</span> Changing colours<span></span></a></li>
<li><a href="#legends"><span class="toc-section-number">8.8</span> Legends<span></span></a></li>
<li><a href="#changing-axes-ticks"><span class="toc-section-number">8.9</span> Changing axes ticks<span></span></a></li>
<li><a href="#saving-plots"><span class="toc-section-number">8.10</span> Saving plots<span></span></a></li>
<li><a href="#summative-homework-3"><span class="toc-section-number">8.11</span> Summative Homework<span></span></a></li>
</ul></li>
<li><a href="#errors"><span class="toc-section-number">9</span> Errors<span></span></a>
<ul>
<li><a href="#intended-learning-outcomes-9">Intended Learning Outcomes<span></span></a></li>
<li><a href="#errors-how-to-avoid-some-and-live-through-the-rest"><span class="toc-section-number">9.1</span> Errors: How to avoid some and live through the rest<span></span></a></li>
<li><a href="#debugging"><span class="toc-section-number">9.2</span> Debugging<span></span></a>
<ul>
<li><a href="#messages-from-r"><span class="toc-section-number">9.2.1</span> Messages from R<span></span></a></li>
<li><a href="#error-messages"><span class="toc-section-number">9.2.2</span> Error Messages<span></span></a></li>
<li><a href="#multiple-errors"><span class="toc-section-number">9.2.3</span> Multiple Errors<span></span></a></li>
<li><a href="#finding-errors-in-longer-code-segments"><span class="toc-section-number">9.2.4</span> Finding errors in longer code segments<span></span></a></li>
<li><a href="#warning-messages"><span class="toc-section-number">9.2.5</span> Warning Messages<span></span></a></li>
<li><a href="#other-messages"><span class="toc-section-number">9.2.6</span> Other Messages<span></span></a></li>
</ul></li>
<li><a href="#searching-for-help-online"><span class="toc-section-number">9.3</span> Searching for Help Online<span></span></a>
<ul>
<li><a href="#googling-it"><span class="toc-section-number">9.3.1</span> Googling It<span></span></a></li>
<li><a href="#stack-overflow"><span class="toc-section-number">9.3.2</span> Stack Overflow<span></span></a></li>
<li><a href="#youtube"><span class="toc-section-number">9.3.3</span> YouTube<span></span></a></li>
<li><a href="#further-reading"><span class="toc-section-number">9.3.4</span> Further Reading<span></span></a></li>
</ul></li>
<li><a href="#formative-exercises"><span class="toc-section-number">9.4</span> Formative Exercises<span></span></a></li>
</ul></li>
<li><a href="#recap-before-the-final-assessment"><span class="toc-section-number">10</span> Recap: Before the final assessment<span></span></a>
<ul>
<li><a href="#outline-for-today"><span class="toc-section-number">10.1</span> Outline for today<span></span></a></li>
<li><a href="#lecture-10-bringing-your-skills-together"><span class="toc-section-number">10.2</span> Lecture 10: Bringing your skills together<span></span></a>
<ul>
<li><a href="#question-1-1">Question 1<span></span></a></li>
<li><a href="#question-2-1">Question 2<span></span></a></li>
<li><a href="#question-3-1">Question 3<span></span></a></li>
<li><a href="#question-4-1">Question 4<span></span></a></li>
<li><a href="#question-5-1">Question 5<span></span></a></li>
<li><a href="#question-6">Question 6<span></span></a></li>
<li><a href="#question-7">Question 7<span></span></a></li>
<li><a href="#question-8">Question 8<span></span></a></li>
<li><a href="#question-9">Question 9<span></span></a></li>
<li><a href="#question-10">Question 10<span></span></a></li>
<li><a href="#question-11">Question 11<span></span></a></li>
<li><a href="#question-12-bonus">Question 12 (Bonus)<span></span></a></li>
<li><a href="#question-13-bonus">Question 13 (Bonus)<span></span></a></li>
<li><a href="#question-14-bonus">Question 14 (Bonus)<span></span></a></li>
</ul></li>
<li><a href="#solutions"><span class="toc-section-number">10.3</span> Solutions<span></span></a></li>
</ul></li>
<li><a href="#appendices">Appendices<span></span></a>
<ul>
<li><a href="#changing-the-appearance-of-rmarkdown">Changing the Appearance of RMarkdown<span></span></a></li>
<li><a href="#source-materials">Source Materials<span></span></a></li>
<li><a href="#further-reading-1">Further Reading<span></span></a>
<ul>
<li><a href="#statistics">Statistics<span></span></a></li>
<li><a href="#more-advanced-use-of-r">More Advanced Use of R<span></span></a></li>
</ul></li>
</ul></li>
<li><a href="#references"><span class="toc-section-number">11</span> References<span></span></a></li>
<li><a href="#before">Assignment before starting the course<span></span></a>
<ul>
<li><a href="#accessing"><span class="toc-section-number">11.1</span> Access to RStudio<span></span></a>
<ul>
<li><a href="#install"><span class="toc-section-number">11.1.1</span> Installing R and RStudio on Your Own Machine<span></span></a></li>
<li><a href="#accessing-rstudio-on-university-computers-1"><span class="toc-section-number">11.1.2</span> Accessing RStudio on University Computers<span></span></a></li>
<li><a href="#using-rstudio-cloud-1"><span class="toc-section-number">11.1.3</span> Using RStudio Cloud<span></span></a></li>
</ul></li>
<li><a href="#maximising-reproducibility-and-visibility-1"><span class="toc-section-number">11.2</span> Maximising Reproducibility and Visibility<span></span></a></li>
</ul></li>
</ul>
<!--bookdown:toc2:end-->
      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!--bookdown:toc:end-->
<!--bookdown:body:start-->
<div id="about-this-course" class="section level1 unnumbered hasAnchor">
<h1 class="unnumbered hasAnchor">About this course<a href="#about-this-course" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This course is a short introduction on using R for dealing with data.</p>
<div id="intended-learning-outcomes" class="section level2 unnumbered hasAnchor">
<h2 class="unnumbered hasAnchor">Intended Learning Outcomes<a href="#intended-learning-outcomes" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The Intended Learning Outcomes (ILOs) for the entire course are:</p>
<ul>
<li>Demonstrate how R and RStudio work by transforming and cleaning different types of data into an appropriate format for analysis and creating graphical representations to visualise different types of data;</li>
<li>Calculate summary statistics using R; and</li>
<li>Interpret common error messages and use in-built help facilities to debug their code.</li>
</ul>
<p>Each chapter contained within will come with its own specific ILOs which will be clearly specified at the top of each page.</p>
<p>These ILOs will be the points that will be covered in the assessments.</p>
</div>
<div id="what-will-i-need-to-complete-this-course" class="section level2 unnumbered hasAnchor">
<h2 class="unnumbered hasAnchor">What will I need to complete this course?<a href="#what-will-i-need-to-complete-this-course" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To successfully complete this course, you will need access to a computer that either already has, or you can download R and RStudio software on. This computer will need to use a Windows, Mac or Linux based operating system. You <em>can</em> run RStudio on a Chromebook sometimes, but the process is more complex (see <a href="https://www.reddit.com/r/chromeos/comments/8r5lwb/r_studio_for_chromebook/">here</a>).</p>
<p>If you cannot use RStudio on your computer you might want to consider using <a href="https://rstudio.cloud/">RStudio Cloud</a>.</p>
<p>All University of Glasgow Library computers should have this software installed. If you have enrolled in the University, you should have access to these.</p>
<p>Before the first lesson you will be given the task of either installing R and RStudio on your own personal computer, or finding another suitable method of accessing the software. Full instructions will be given in <a href="@ref(#accessing)">Chapter 1</a> of this coursebook.</p>
<div class="info">
<p>
<strong>If you are having issues with access, talk to your tutors via
the via the Microsoft Teams channel as soon as possible so that we can
help you!</strong> R, like any skill, will get better with practice and
we want to ensure you can practice and complete the assessments as
easily as possible.
</p>
</div>
</div>
<div id="about-the-assessments" class="section level2 unnumbered hasAnchor">
<h2 class="unnumbered hasAnchor">About the Assessments<a href="#about-the-assessments" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="formative-assessments" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Formative Assessments<a href="#formative-assessments" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>These assessments allow you to revise the concepts that you have learned in class. They do not count towards the course grade and, although we encourage you to, there is no requirement to complete them.</p>
<p>These may take the form of coding assessments and/or multiple choice questions (MCQs) that will be delivered in the same format as the summative assessments - a downloadable file that you fill in the blanks of.</p>
<p>The answers for each of the formative assessments will be available at 5pm one week after the assessment is posted.</p>
<div class="info">
<p>
If you encounter something in the formative assessments that you want
to ask a question about, then please use the Teams channel.
</p>
</div>
</div>
<div id="summative-assessments" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Summative Assessments<a href="#summative-assessments" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>These are the assessments that count towards your course grade</strong>.</p>
<p>There will be 5 take-home exercises to complete as you progress through this course. They will be evenly spaced across the entire 10-week span, occurring every two weeks (after L2, L4, L6, L8, and L10). You will have one week from the time of the release of each assessment to submit your answer(s). The solutions of the summative assessments will be released with the grades and feedback (see schedule below), however, we can release solutions earlier once everyone has submitted or we have information that someone is not submitting their assessment for a particular week. So please let us know if you are not planning to submit a specific assessment.</p>
<p>For the summative assessments, we ask you to <strong>complete .Rmd files</strong> (either by answering multiple choice questions, producing code or explaining what a code chunk does), and upload them to Moodle in the assessment submission section. The .Rmd files and data for specific assessments will be provided in a <strong>zip folder within each lecture tile</strong> you are asked to download and unzip before you start an assessment. The folder you download will also contain a questions file. It is strongly recommended to <strong>read the questions file in combination with the .Rmd</strong>, as they might provide additional information (such as giving you hints what output to expect, or what a graph may look like etc.).</p>
<div class="warning">
<p>
Summative assessments will be due <strong>ONE HOUR before the start
of the next class</strong> the following week (see schedule below for
specific dates).
</p>
<p>
We recommend that you start these early and, if required, seek
assistance from the staff as early as possible. Please make use of the
Teams channel if you are struggling or have questions! Remember you are
not allowed to post any code on Teams.
</p>
</div>
<div id="schedule-of-summative-assessments" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Schedule of summative assessments<a href="#schedule-of-summative-assessments" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<table>
<colgroup>
<col width="18%" />
<col width="25%" />
<col width="18%" />
<col width="13%" />
<col width="24%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Summative assessment</th>
<th align="left">Assesses ILOs from lectures</th>
<th align="left">Assessment released</th>
<th align="left">Submission due</th>
<th align="left">Grades &amp; Feedback released</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1 (week 2)</td>
<td align="left">1 and 2</td>
<td align="left">11/04 at 6pm</td>
<td align="left">18/04 at 5pm</td>
<td align="left">25/04 at 5pm</td>
</tr>
<tr class="even">
<td align="left">2 (week 4)</td>
<td align="left">3 and 4</td>
<td align="left">25/04 at 6pm</td>
<td align="left">02/05 at 5pm</td>
<td align="left">09/05 at 5pm</td>
</tr>
<tr class="odd">
<td align="left">3 (week 6)</td>
<td align="left">5 and 6</td>
<td align="left">09/05 at 6pm</td>
<td align="left">16/05 at 5pm</td>
<td align="left">23/05 at 5pm</td>
</tr>
<tr class="even">
<td align="left">4 (week 8)</td>
<td align="left">7 and 8</td>
<td align="left">23/05 at 6pm</td>
<td align="left">30/05 at 5pm</td>
<td align="left">06/06 at 5pm</td>
</tr>
<tr class="odd">
<td align="left">5 (week 10)</td>
<td align="left">1-10</td>
<td align="left">06/06 at 6pm</td>
<td align="left">13/06 at 5pm</td>
<td align="left">20/06 at 5pm</td>
</tr>
</tbody>
</table>
<p><br>
Keep in mind that the column <code>Assesses ILOs from lectures</code> means that the assessment will test you predominantly on skills gained within the lectures listed (e.g. for week 4 that means lectures 3 and 4), however you will also need to use knowledge from previous lessons as your learning is supposed to be cumulative (e.g. basic knowledge from lectures 1 and 2).</p>
<p>We will never ask you to memorise any code as this is not how people produce code in reality. You may use notes and resources you complete in class to do these assessments and consult online resources to help you. You can work together to complete these tasks, but remember that grades are given on an individual basis and that <strong>you must not plagiarise</strong> the work of others.</p>
<p><strong>For the purposes of your final grade, only 4 of these assessments will be counted and each will be worth 25%</strong>. The lowest score out of the 5 assessments will be dropped and not taken into account when calculating your final grade. We encourage you to complete all 5 assessments. You must complete at least 75% (= 3 summative assessments) to be eligible for course credits.</p>
</div>
</div>
<div id="late-submissions-extensions" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Late submissions &amp; extensions<a href="#late-submissions-extensions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There will be penalties for late submissions. Your work will be assessed in the usual way, and the primary grade and secondary band will be adjusted to include reductions by two secondary bands for each working day (or part of a working day) the work was submitted late. For example, for submitting an assessment 6 hours after deadline with an assessed grade (had it been submitted on time) of A5, a penalty of 2 secondary bands reduction would result in a final grade of B2.</p>
<p>You can apply for extensions for up to 5 working days. In that case, no grade points will be taken off your final grade for submitting after the official deadline. Please email Gaby (<a href="mailto:g.mahrholz.1@research.gla.ac.uk" class="email">g.mahrholz.1@research.gla.ac.uk</a>) if you find yourself struggling to submit on time. We are here for you.</p>
<p>For extensions after 5 working days, you have to submit a good cause form. If an extension for good cause has been granted, and the extension is past the date that solutions for the assessment have been released, an alternative assessment will be provided.</p>
<p>Any blank document, or document that was submitted in a format other than an R Markdown file ending in .Rmd, will be considered as not submitted.</p>
</div>
<div id="how-to-submit-your-assessments" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">How to Submit Your Assessments<a href="#how-to-submit-your-assessments" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>An .Rmd file to complete each summative assessment will be provided to you. In this file, you will be provided with code chunks in which to type your answers.</p>
<p>Once you have provided code in all of the appropriate slots, you will then upload this file to the Assessment Submission section on Moodle.</p>
<p>Formative assessments are not to be uploaded to Moodle. You will be provided an answer key to which you can compare your own answers. If you have questions about either your own answers or those provided by the tutors, please ask about it on the appropriate Teams channel.</p>
</div>
</div>
<div id="assistance" class="section level2 unnumbered hasAnchor">
<h2 class="unnumbered hasAnchor">Assistance<a href="#assistance" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You can ask questions on the Microsoft Teams channel that accompanies this course. We ask that you do not post solutions to assessments here and any solutions posted will be removed.</p>
</div>
<div id="why-are-these-materials-open" class="section level2 unnumbered hasAnchor">
<h2 class="unnumbered hasAnchor">Why are these materials open?<a href="#why-are-these-materials-open" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>These materials have been adapted from various sources. Some of these materials have been Open Educational Materials with CC-BY-SA licenses. This means that any materials that use them must also be made open (SA means “share alike”).</p>
<p>We also believe in the value of open educational materials. Your course fees contribute to the development of this course, but also to providing you with lectures, supporting staff and certification and credits at the end of the course.</p>
</div>
<div id="acknowledgement" class="section level2 unnumbered hasAnchor">
<h2 class="unnumbered hasAnchor">Acknowledgement<a href="#acknowledgement" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The materials were initially developed for the University of Glasgow Short Courses for the academic term 2019/20 by <a href="https://www.psy.gla.ac.uk/otherstaff/?id=GM005">Gaby Mahrholz</a>, <a href="https://www.psy.gla.ac.uk/otherstaff/?id=KH001">Kate Haining</a>, <a href="https://www.psy.gla.ac.uk/otherstaff/?id=RL003">Rebecca Lai</a>, <a href="https://www.psy.gla.ac.uk/otherstaff/?id=GKT01">Greta Todorova</a>, and <a href="https://www.psy.gla.ac.uk/otherstaff/?id=TIWT1">Wilhelmiina Toivo</a>, and modified for the academic term 2020/21 by the current tutors.</p>
<!--chapter:end:index.Rmd-->
</div>
</div>
<div id="before" class="section level1 unnumbered hasAnchor">
<h1 class="unnumbered hasAnchor">Assignment before starting the course<a href="#before" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This assignment is an important one as it will enable you to complete your future assignments. It looks long, but it is mostly screenshots to guide you through the process of installing the required software, or a short guide on how to use RStudio Cloud.</p>
<div id="accessing" class="section level2 hasAnchor" number="0.1">
<h2 class="hasAnchor"><span class="header-section-number">0.1</span> Access to RStudio<a href="#accessing" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Please ensure by the next class that you have access to the software so that you can practice using the formative assignments and complete the summative assignments when they are issued.</p>
<p>The first summative assignment will be issued after class next week and you will be given one week to complete and submit it.</p>
<div id="install" class="section level3 hasAnchor" number="0.1.1">
<h3 class="hasAnchor"><span class="header-section-number">0.1.1</span> Installing R and RStudio on Your Own Machine<a href="#install" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Unfortunately this is not as simple as installing software normally is on your computer. There are two separate things that you will need to install.</p>
<div id="first-install-r" class="section level4 hasAnchor" number="0.1.1.1">
<h4 class="hasAnchor"><span class="header-section-number">0.1.1.1</span> First: Install R<a href="#first-install-r" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Follow <a href="https://www.stats.bris.ac.uk/R/">this link</a> and click on the part that says Download R R-4.1.3-win for Windows (or Mac). You will get the following pop-up dialogue (please note that as you are installing a newer version of R your download will be called R-4.1.3-win.exe instead of R-3.6.2 in the picture):</p>
<center>
<img src="images/download_prompt_R.png">
</center>
<p>Click “Save File”. The file will then be downloaded to your computer, most likely the “Downloads” folder unless you have changed your settings. Double click to run the file.</p>
<p>You will be asked if you want to allow this to make changes to your computer, click yes. Select your language preference, review the license agreement and click next. The following screen will be presented:</p>
<center>
<img src="images/install_wiz_1.png">
</center>
<p>Click next without changing the folder. The next screen let’s you customise the installation, but we shouldn’t need to make any changes at this point so click next without unselecting any components:</p>
<center>
<img src="images/install_wiz_2.png">
</center>
<p>Also leave the star-up options as standard and click next:</p>
<center>
<img src="images/install_wiz_3.png">
</center>
<p>Leave the start menu folder as standard:</p>
<center>
<img src="images/install_wiz_4.png">
</center>
<p>Don’t make any changes to the additional tasks part, just click next:</p>
<center>
<img src="images/install_wiz_5.png">
</center>
<p>The Install Wizard will then install R:</p>
<center>
<img src="images/install_wiz_6.png">
</center>
<p>You will be told when installation is complete:</p>
<center>
<img src="images/install_wiz_7.png">
</center>
</div>
<div id="second-install-rstudio" class="section level4 hasAnchor" number="0.1.1.2">
<h4 class="hasAnchor"><span class="header-section-number">0.1.1.2</span> Second: Install RStudio<a href="#second-install-rstudio" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Follow <a href="https://rstudio.com/products/rstudio/download/">this link</a> to the RStudio website. Scroll down and press the button “Download” under RStudio Desktop- not the Server Option. On the next page press the button under stage 2, “Download RStudio for Windows”. Your download will start and you will see the following prompt (note your as your download is a newer version it will again be named slightly differently RStudio-2022.02.1-461) :</p>
<center>
<img src="images/download_prompt_Rstudio.png">
</center>
<p>Click “Save File” when the button becomes active.</p>
<p>Look in your download folder and double click the downloaded file. Click to allow the program to make changes to your computer. You will see this part next:</p>
<center>
<img src="images/install_wiz_studio_1.png">
</center>
<p>Click next on this next window. Do not change the installation location. Click next:</p>
<center>
<img src="images/install_wiz_studio_2.png">
</center>
<p>You will be taken to this screen. Again, don’t change the start menu folder location here.</p>
<center>
<img src="images/install_wiz_studio_3.png">
</center>
<p>Click next and the installation will begin:</p>
<center>
<img src="images/install_wiz_studio_4.png">
</center>
<p>You will then be notified when the installation is complete with this screen:</p>
<center>
<img src="images/install_wiz_studio_5.png">
</center>
</div>
<div id="opening-rstudio" class="section level4 hasAnchor" number="0.1.1.3">
<h4 class="hasAnchor"><span class="header-section-number">0.1.1.3</span> Opening RStudio<a href="#opening-rstudio" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Remember that we have installed <strong>two</strong> programs on our computer. R, which is the base program, and RStudio, which is an extension of R.</p>
<p>The software that we want to open and use is RStudio, not R. We want the shiny interface and added features.</p>
</div>
</div>
<div id="accessing-rstudio-on-university-computers" class="section level3 hasAnchor" number="0.1.2">
<h3 class="hasAnchor"><span class="header-section-number">0.1.2</span> Accessing RStudio on University Computers<a href="#accessing-rstudio-on-university-computers" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If you have a student card you will be able to access computing facilities provided for students, including those in the various libraries across campus. All university computers should have R and RStudio installed, as well as the required packages for this course.</p>
<p>You will not be required to install anything on university computers, please don’t attempt to do so because we don’t want the IT guys to yell at us.</p>
<p>To login to the university computers you will require your GUID and password.</p>
</div>
<div id="using-rstudio-cloud" class="section level3 hasAnchor" number="0.1.3">
<h3 class="hasAnchor"><span class="header-section-number">0.1.3</span> Using RStudio Cloud<a href="#using-rstudio-cloud" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We recognise that not all students will have access to their own computers, and that some of those students will not be able to travel to campus to use the provided facilities. For this reason we recommend to those in that postition to think about using RStudio Cloud, available <a href="https://rstudio.cloud/">here</a>.</p>
<p>The RStudio Cloud allows you an electronic workspace, hosted by the RStudio team themselves.</p>
<p>Navigate to the page and click the “Sign Up” button at the top right-hand side of the page.</p>
<p>Once you are logged in you will see your (for now) empty workspace:</p>
<center>
<img src="images/rstudio_cloud.png">
</center>
<p>Click on “new project” and you will be taken to this page:</p>
<center>
<img src="images/rstudio_cloud_new.png">
</center>
<p>As you can see it is almost identical to the way the program would appear on your computer if you had installed it there.</p>
<p>To name your project you can click the name at the top of the page and type in a new one:</p>
<center>
<img src="images/rstudio_cloud_nameproj.png">
</center>
<p>You will also need to upload any data files to the server before you can work with them. This is done with the
addition to the panel Files/Plots/Packages/Help/Viewer on the right- the “Files” pane now had a button to upload:</p>
<center>
<img src="images/rstudio_cloud_upload1.png">
</center>
<p>Pressing this will open a pop-up box. Click on the “browse” button, navigate through your directories and identify the file you wish to upload and confirm. Then press ok. The file should then be uploaded and displayed in the files pane.</p>
<center>
<img src="images/rstudio_cloud_upload2.png">
</center>
<div class="info">
<p>
If at any point you are struggling to access the required materials
or software it is important that you contact the tutors <strong>at the
earliest opportunity</strong> to discuss the issues you are having.
</p>
<p>
We want you to do well and have a good experience learning with us,
let us know if you are experiencing difficulty so that we may help you
resolve it!
</p>
</div>
<div id="downloading-your-files-from-rstudio-cloud" class="section level4 hasAnchor" number="0.1.3.1">
<h4 class="hasAnchor"><span class="header-section-number">0.1.3.1</span> Downloading Your Files from RStudio Cloud<a href="#downloading-your-files-from-rstudio-cloud" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>If you are using RStudio Cloud your files will be saved on the cloud, but you will need to download the .Rmd files that you have been working with (containing coursework etc) to upload them to the assignment submission pages on Moodle.</p>
<p>Here you can see the file <code>myfile.Rmd</code> that I have made on the cloud. To download it I select the checkbox next to the file and click on the “More” drop-down menu and click “export”, as shown here:</p>
<center>
<img src="images/rstudio_cloud_download1.png">
</center>
<p>I then get a dialogue box asking me if I want to name the file something different. I will stick with the original name, so I just click “Download”:</p>
<center>
<img src="images/rstudio_cloud_download2.png">
</center>
<p>Now I get a pop-up as I would when downloading any other file. To save the file ensure “Save File” is selected and click “OK”:</p>
<center>
<img src="images/rstudio_cloud_download3.png">
</center>
<p>The file will then be saved in the folder where your downloads are saved (usually the “Downloads” folder by default). You can then navigate to this file when browsing files to upload to Moodle.</p>
</div>
</div>
</div>
<div id="maximising-reproducibility-and-visibility" class="section level2 hasAnchor" number="0.2">
<h2 class="hasAnchor"><span class="header-section-number">0.2</span> Maximising Reproducibility and Visibility<a href="#maximising-reproducibility-and-visibility" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In order to set up R the way that we require, there are a few more steps.</p>
<p>First, open RStudio and click on the Tools menu at the top of the page and click on the part that says “Global Options”:</p>
<center>
<img src="images/tools.png">
</center>
<p>Next, a dialogue box will open. Ensure that these tick boxes and options are selected on yours and click apply:</p>
<center>
<img src="images/options.png">
</center>
<p>Finally, go to RMarkdown and ensure that this option is unchecked:</p>
<center>
<img src="images/inline.png">
</center>
<p>This meaning of the first part will be discussed in future lessons, and the second will mean that graphs that you make will be in the “Plots” tab to the right of the console. This means that code will not be obscured whenever you make a graph.</p>
<!--chapter:end:00-before.Rmd-->
</div>
</div>
<div id="introduction" class="section level1 hasAnchor" number="1">
<h1 class="hasAnchor"><span class="header-section-number">1</span> Introduction<a href="#introduction" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="intended-learning-outcomes-1" class="section level2 unnumbered hasAnchor">
<h2 class="unnumbered hasAnchor">Intended Learning Outcomes<a href="#intended-learning-outcomes-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>By the end of this session you should be:</p>
<ol style="list-style-type: decimal">
<li>Familiar enough with a computer to open, save and access previously saved files.</li>
<li>Able to describe R and Studio, the coding environment and the associated file types.</li>
<li>Able to install, load and describe the nature of R packages and describe the nature and use of functions in general.</li>
</ol>
<p>This lesson is led by <a href="https://www.gla.ac.uk/schools/psychologyneuroscience/staff/johannawerner/">Johanna Werner</a>.</p>
</div>
<div id="computer-literacy-basics" class="section level2 hasAnchor" number="1.1">
<h2 class="hasAnchor"><span class="header-section-number">1.1</span> Computer Literacy Basics<a href="#computer-literacy-basics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In order to successfully navigate this course there are a number of things that you need to know about computers more generally. This section includes everything that you are <em>required</em> to know or learn.</p>
<p>We are aware that many people will have been using computers for many years, and in some cases many people will have grown up with them in their household. We have noticed, however, that a number of our incoming students are not familiar with many of the basic concepts that are required to be a successful coder. There is an assumption that “digital native” automatically equates to “computer literate” but in many cases we have found this assumption to be incorrect.</p>
<p>More people than ever before are using some sort of personal computing device, but the type of use differs greatly from what we are going to be doing over the next 10 weeks. Many mobile phones, tablets and (increasingly) PC operating systems hide many of their operations from users. This can create a feeling of competency with computers that can quickly dissolve when asked to engage with anything slightly more complex.</p>
<p>If you already know most of this then we apologise, but there may be people with us who don’t. This is a beginner class, so we thought it prudent to start us all off on the same footing.</p>
</div>
<div id="r-and-r-studio" class="section level2 hasAnchor" number="1.2">
<h2 class="hasAnchor"><span class="header-section-number">1.2</span> R and R Studio<a href="#r-and-r-studio" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Are they different? Yes! Is this important? Yes!</p>
<div id="r" class="section level3 hasAnchor" number="1.2.1">
<h3 class="hasAnchor"><span class="header-section-number">1.2.1</span> R<a href="#r" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><img src="images/Rlogo.png" height="50" width="50" alt="R Commander Logo" align="right" style="margin:10px 10px"></p>
<p>R is a programming language and completely free software, and it is widely used for data analysis. It is a stand-alone program and can be run on it’s own without R Studio, but it’s not particularly user friendly.</p>
<center>
<img src="images/commander.png" alt="R Commander" style="margin:10px 10px">
</center>
</div>
<div id="rstudio-ide" class="section level3 hasAnchor" number="1.2.2">
<h3 class="hasAnchor"><span class="header-section-number">1.2.2</span> RStudio IDE<a href="#rstudio-ide" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><img src="images/rstudio.png" height="75" width="190" alt="R Studio Logo" align="right" style="margin:10px 10px"></p>
<p>RStudio IDE (short for <strong>I</strong>ntegrated <strong>D</strong>evelopment <strong>E</strong>nvironment) is essentially a shiny facade, which sits atop R and gives it many useful features and makes it much <em>easier to use</em>.</p>
<p>When you first open it you get 3 main panels, which can be seen in the picture below.</p>
<center>
<img src="images/open.png" style="margin:10px 10px">
</center>
<div id="console" class="section level4 hasAnchor" number="1.2.2.1">
<h4 class="hasAnchor"><span class="header-section-number">1.2.2.1</span> Console<a href="#console" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>This is essentially the same thing as R commander. You can run code in here, and it can be a useful playground to try out new things and do things that you don’t necessarily want saved into a script because <strong>it’s not permanent- anything typed here will be lost when you close R</strong>!</p>
<p>Examples of things you might want to run in the console include, but are not limited to, running new functions and seeing what they do, or installing packages (never EVER done in a script).</p>
<p>This is what the console looks like before you have run any code:</p>
<center>
<img src="images/console.png" alt="The Console" style="margin:10px 10px">
</center>
</div>
<div id="environmenthistoryconnections" class="section level4 hasAnchor" number="1.2.2.2">
<h4 class="hasAnchor"><span class="header-section-number">1.2.2.2</span> Environment/History/Connections<a href="#environmenthistoryconnections" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>This panel is tabbed, with 2 tabs that you need to pay particular attention to right now:</p>
<ul>
<li><p><strong>Environment</strong>: this contains all of the virtual “objects” that you have created. These include, but are not limited to, variables containing data that you have read in, lists, individual values, custom-written functions.</p>
<p>Objects can and should be created in your scripts. When you close R you might lose some of the objects, but as long as you have the script containing the instructions to re-create these objects you can re-run it and make them again.</p></li>
<li><p><strong>History</strong>: this is a list of all of the commands that you have run in the past “session”, which can be useful to go back to some times if you did run some code in the console that you want to look at again. To scroll through you can put the cursor in the console window and use up and down keys.</p></li>
</ul>
<p>At this point you don’t really need to worry about the one called connections (it lets you connect to things like online data sources).</p>
<p>This is what that panel looks like for me right now… it’s empty!</p>
<center>
<img src="images/environment.png" alt="The Environment" style="margin:10px 10px">
</center>
</div>
<div id="filesplotspackageshelpviewer" class="section level4 hasAnchor" number="1.2.2.3">
<h4 class="hasAnchor"><span class="header-section-number">1.2.2.3</span> Files/Plots/Packages/Help/Viewer<a href="#filesplotspackageshelpviewer" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>This panel set is going to be extremely useful to you throughout the duration of your career as an R user. Viewer is not immediately required, so we’ll just cover Files, Plots, Packages and Help.</p>
<ul>
<li><p><strong>Files</strong>: Shows a file browser that lets you look around in your file structure. helpful hint: click on the more button and “Go to working directory” to see the same files that R can see. <strong>You <em>can</em> load files in through this tab, but you should always strive to do it in the script!</strong></p></li>
<li><p><strong>Plots</strong>: A tab that displays plots that you have made. You can navigate backwards and forwards between multiple plots- allowing you to test out new things and see the changes in comparison to each other.</p></li>
<li><p><strong>Packages</strong>: This allows you to look at the R packages that are installed on the machine that you are using, and the check box next to it indicates if it is loaded in from the library. <strong>You <em>can</em> click the box to load a package, but you should always strive to do it in the script!</strong></p></li>
<li><p><strong>Help</strong>: this window displays the built in help information, much the same as Microsoft Word or Powerpoint has. You can search using the search box, but you can also type into the console. For example, if I wanted to find the help file for the <code>library()</code> function I would type <code>?library</code>. the result is displayed in the help tab to the right.</p></li>
</ul>
<center>
<img src="images/using_help_2.png" alt="Using the console for help" style="margin:10px 10px">
</center>
<p>Alternatively, you can type the name of the function you want help with into the search box in the help tab:</p>
<center>
<img src="images/using_help.png" alt="Using the Help panel for help" style="margin:10px 10px">
</center>
<p>Sometimes these files are not exactly written in a manner that could be considered accessible to novice users. You get the hang of reading them over time. In this case you might want to try Googling it… we <strong>all</strong> do it, no matter our level of experience!</p>
<p>Even Googling can be difficult, but you will eventually get a better idea of the types of search terms most likely to direct you to the information that you are after.</p>
</div>
</div>
</div>
<div id="r-r-studio-and-associated-file-types" class="section level2 hasAnchor" number="1.3">
<h2 class="hasAnchor"><span class="header-section-number">1.3</span> R, R Studio and Associated File Types<a href="#r-r-studio-and-associated-file-types" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>When you open a program, such as Microsoft Word, you haven’t actually created a Word document you’ve just started the program. Opening RStudio is much the same. Even though it can function without opening a file, there is much utility to be added by opening a file.</p>
<p>When you open a file, the console will shrink and the space taken away in the window will be taken up by the new file.</p>
<p>Opening a new file allows you to write code that can be saved, amended, shared etc. Code sharing is an important aspect of reproducibility!</p>
<p>R can handle a lot of different files types, we will only focus on the two types. These are .r and .Rmd files. Both are saved as plain text files. Many of the files R uses are plain text files at their core. What changes is how R interprets the files, and the types of outputs that you can get from them.</p>
<div id="file-structuredirectories" class="section level3 hasAnchor" number="1.3.1">
<h3 class="hasAnchor"><span class="header-section-number">1.3.1</span> File Structure/Directories<a href="#file-structuredirectories" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Your files should be stored in something called <strong>“directories”</strong>. This is the technical name for a folder. It is a storage space on your computer. Here you can see all of the files contained within the folder for this course document in the <strong>“File Explorer”</strong>, the program used to view files and folders in Windows:</p>
<center>
<img src="images/folder.png">
</center>
<p><br></p>
<p>Each folder and the files within will have a specific <strong>“file path”</strong>, an address within your file storage system that allows you and the computer to pinpoint the location of the information that you and it need to perform tasks involving that file. In windows you can get the file path of a folder by clicking on the bar at the top of the folder when you are looking in it in the file explorer:</p>
<center>
<img src="images/path.png">
</center>
<p><br></p>
<p>This will be necessary later when you start to use RStudio in conjunction with external files, such as data files.</p>
</div>
<div id="file-extensions" class="section level3 hasAnchor" number="1.3.2">
<h3 class="hasAnchor"><span class="header-section-number">1.3.2</span> File Extensions<a href="#file-extensions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Files come in different types, and each different type comes with a different <strong>file extension</strong>, meaning that it is associated with a different type of program. A <strong>file extension</strong> is that part after a full-stop in the file name. Some common ones are:</p>
<ul>
<li>.xlsx: a spreadsheet file associated with Microsoft Excel</li>
<li>.docx: a formatted text document associated with Microsoft Word</li>
<li>.pdf: a <strong>P</strong>ortable <strong>D</strong>ocument <strong>F</strong>ile, commonly text and images, associated with Adobe Acrobat</li>
<li>.txt: a plain text file, can be opened in multiple programs such as Notepad or other word processing software.</li>
<li>.zip: a <em>compressed folder</em> which can contain many files. These files must be <em>uncompressed/extracted</em> before you use them successfully.</li>
</ul>
</div>
<div id="zip-files" class="section level3 hasAnchor" number="1.3.3">
<h3 class="hasAnchor"><span class="header-section-number">1.3.3</span> .zip Files<a href="#zip-files" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In this course we will often ask you to download a folder with multiple files and this will be stored on Moodle as a zip file. A zip file is a folder that contains files that have been compressed to make the file size smaller and enables you to download multiple files at once, however, before you use the files from a zip folder you first need to extract them.</p>
<ol style="list-style-type: decimal">
<li>Click on the link to download the compressed folder.</li>
<li>Navigate to the zip file (probably in your downloads folder) and open it. You will see all the files it contains but don’t use these - click “Extract all” on the top ribbon.</li>
<li>You will be asked to select a location to save the unzipped files. Normally the default location it suggests will be the same folder and so you can just click “Extract”. If you want to unzip these files to a different place click browse and select the folder you want to keep it in. I like to keep all the files for one project in the same folder.</li>
<li>You can now delete the zip file and use the unzipped files. This is a really important step - if you use the compressed files your code may not work properly. This usually causes error messages relating to temporary files.</li>
</ol>
<center>
<figure>
<img src="images/zipping.gif">
<figcaption>
Adapted from Level 1 Data Skills, <span class="citation">(<a href="#ref-l1book" role="doc-biblioref">Nordmann and Woods 2019</a>)</span>.
</figcaption>
</figure>
</center>
<p><br></p>
</div>
<div id="rstudio-specific-files" class="section level3 hasAnchor" number="1.3.4">
<h3 class="hasAnchor"><span class="header-section-number">1.3.4</span> RStudio Specific Files<a href="#rstudio-specific-files" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>RStudio uses many different types of files, but each is a variation on a <strong>“plain text” file</strong>. This means that all files we will be using in class will be able to be opened in Notepad or other similar text programs. The three main ones we will be working with will be:</p>
<ul>
<li>.r: an R script</li>
<li>.Rmd: an RMarkdown document</li>
<li>.csv: <strong>C</strong>omma <strong>S</strong>eparated <strong>V</strong>alues file, a common and universal type of file containing data sets.</li>
</ul>
<div class="danger">
<p>
If the file extension on a file is incorrect it may not be recognised
as a file to be opened with a specific program and might not work.
</p>
<p>
This is particularly an issue when you are downloading your files for
class. As they are technically “plain text” files, some internet
browsers will download them with the extension “.txt”, or even add it on
as a second one which doesn’t work! Changing the extension to “.Rmd” or
removing the extra added one will solve this issue.
</p>
</div>
</div>
<div id="r-files" class="section level3 hasAnchor" number="1.3.5">
<h3 class="hasAnchor"><span class="header-section-number">1.3.5</span> .r Files<a href="#r-files" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This is what we refer to as a script. It is designed to be read by R, not so much by humans. To create a new script go to File &gt; New File &gt; R Script. This is what will be brought up:</p>
<center>
<img src="images/new_script.png">
</center>
<p><br></p>
<p>All of the text in an R script will default to being read as <strong>executable code (that is, text which is directed at the machine)</strong>. We can, however, tell R <strong>not</strong> to read it as executable code, but instead for the machine to ignore certain parts of it, by using something called <strong>comments</strong>- you will read more about these below.</p>
</div>
<div id="rmd-files" class="section level3 hasAnchor" number="1.3.6">
<h3 class="hasAnchor"><span class="header-section-number">1.3.6</span> .Rmd files<a href="#rmd-files" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>These are the types of files that you will mostly be using during this class. You will also be given some pre-formatted ones to complete your assessments on.</p>
<p>When you go to File &gt; New file &gt; R Markdown… you will be prompted to supply some information. You can do this, but don’t have to as you can change many of these parameters later:</p>
<center>
<img src="images/new_markdown_dialogue.png">
</center>
<p><br></p>
<p>When a new RMarkdown file is opened the file isn’t empty. What you actually get is an example with a YAML header (at the top bordered with the dashes), some code chunks (in the shaded sections, more on these in a minute), text and some headers (the hashtagged blue text <strong>outside</strong> of chunks).</p>
<p>I like to think of the way this file type is interpreted as being <em>like a script, but flipped</em>- the default interpretation of text aimed at humans. If we want <strong>executable code</strong> we need to prompt R to read the text in this way. This is done using “code chunks”, or sometimes just called “chunks”.</p>
<center>
<img src="images/new_markdown.png">
</center>
<p><br></p>
<div id="code-chunks" class="section level4 hasAnchor" number="1.3.6.1">
<h4 class="hasAnchor"><span class="header-section-number">1.3.6.1</span> Code Chunks<a href="#code-chunks" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Code chunks are bordered by “backticks”, which look an awful lot like apostrophes but they are different! These are important as they tell R where it needs to start and stop reading.</p>
<p>Chunks also contain “curly brackets” at the start which contains various bits of information necessary to how the computer reads it. This includes what programming language you are writing in there (yes! R can understand other programming languages!), name of the chunk (used for a variety of reasons, such as our marking software and document indexing) and other attributes which are not necessary to learn about right now.</p>
<center>
<img src="images/chunk.png">
</center>
<p><br></p>
<div class="danger">
<p>
The chunk <strong>must</strong> have the backticks to show the
beginning and end of the executable code, otherwise the code doesn’t
run.
</p>
<p>
You must not add any code or text to the lines which contain
backticks other than the code to alter the attributes of the chunk
within the curly brackets (and only if you know how to do so). If you do
this the code will not run and other chunks in the document might also
be affected.
</p>
</div>
<p>Hashtags used inside of code chunks don’t result in headers, but rather are ignored as the comments discussed in the section about .r files.</p>
</div>
</div>
</div>
<div id="comments" class="section level2 hasAnchor" number="1.4">
<h2 class="hasAnchor"><span class="header-section-number">1.4</span> Comments<a href="#comments" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Comments can- and should- be used throughout both .r and .Rmd file types. These are anything written <em>after</em> a hashtag symbol (and, if using a .Rmd file, within a code chunk). This symbol instructs the computer to disregard this text, letting it know that this is not for it to interpret as executable code but rather it is something for the human user to read and interpret.</p>
<p>These are handy for letting others know what each piece of code was written to do, or to inform your future self of what you were doing.</p>
<p>Make use of comments in the code we write in class and let this function as your class-notes.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># this is what a comment looks like. Anything AFTER a hashtag.</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># R doesn&#39;t &quot;speak&quot; natural languages so it would not be able </span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># to understand any of this and would give errors!</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># comments are for humans. You can use them to put notes in scripts to</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># remind yourself of what is happening, or to inform people with whom</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># you have shared your code.</span></span></code></pre></div>
</div>
<div id="saving-your-file" class="section level2 hasAnchor" number="1.5">
<h2 class="hasAnchor"><span class="header-section-number">1.5</span> Saving your file<a href="#saving-your-file" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As mentioned before, anything in the console vanishes when you close R. Any objects that you have used code to make (those things that live in the environment) should vanish too.</p>
<p>Your script is a set of instructions on how to make those objects. If you have saved your script or markdown, you can just re-run it and get back to where you left off when you last saved your progress.</p>
<p>Saving your file for the first time is as easy as going to File &gt; Save As and filling in the details in the dialogue box as appropriate:</p>
<center>
<img src="images/save_as_menu.png" width="198">
<img src="images/save_as_dialogue.png" width="602">
</center>
<p><br></p>
<p>Saving changes to an already existing file is done by going to File &gt; Save:</p>
<center>
<img src="images/save.png">
</center>
<p><br></p>
</div>
<div id="sessions" class="section level2 hasAnchor" number="1.6">
<h2 class="hasAnchor"><span class="header-section-number">1.6</span> Sessions<a href="#sessions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="what-is-a-session-in-r" class="section level3 hasAnchor" number="1.6.1">
<h3 class="hasAnchor"><span class="header-section-number">1.6.1</span> What is a session in R?<a href="#what-is-a-session-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A session in R is a segment of time/workspace/processor time that is dedicated to performing a specific processing or analysis task. It can be difficult to wrap your head around at first, but it helps to draw comparisons with software that we are already familiar with.</p>
<p>Let’s go back to Microsoft Word. We can have an essay open in one window and class notes opened up in another window. Both are instances of Word, but they are dedicated to two different tasks which just so happen to be running concurrently.</p>
<p>You can have multiple sessions open in R, but we wouldn’t recommend it, because it can become confusing. We can start a new session by going to Session &gt; new session. We are much more interested in a task which is closely linked to this idea- restarting your current session.</p>
<center>
<img src="images/session_menu.png">
</center>
<p><br></p>
</div>
<div id="restarting-your-current-session" class="section level3 hasAnchor" number="1.6.2">
<h3 class="hasAnchor"><span class="header-section-number">1.6.2</span> Restarting Your Current Session<a href="#restarting-your-current-session" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This can be done by going to Session &gt; Restart R, see the image above.</p>
<p>Restarting your R session does some important things:</p>
<ul>
<li>it clears the environment of objects if R is set up in a maximally reproducible way- so make sure your script is saved so that you keep the instructions for making them again</li>
<li>it “unloads” packages that you have called from the library using the <code>library()</code> function</li>
<li>If you encounter an error with an unknown source sometimes restarting the session can clear the problem</li>
<li>It allows you to test the reproducibility of the script that you are writing by clearing the environment and starting over with only the instructions you have provided, without the possibility of “contamination” of objects inadvertently created in other ways, such as playing in the console</li>
</ul>
</div>
</div>
<div id="packages" class="section level2 hasAnchor" number="1.7">
<h2 class="hasAnchor"><span class="header-section-number">1.7</span> Packages<a href="#packages" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>R is a programming language which is primarily used for data processing and analysis. As the software is open source a number of people have created extensions to the software to adapt it to their needs.</p>
<p>These software extensions are referred to as “packages”.</p>
<div id="installing-packages" class="section level3 hasAnchor" number="1.7.1">
<h3 class="hasAnchor"><span class="header-section-number">1.7.1</span> Installing Packages<a href="#installing-packages" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There are a number of functions that we will be using in this course that are not part of the original programming language. The most common package we will be using will be one called “tidyverse”.</p>
<p>We will use the example of tidyverse to show you how to install packages that you might need.</p>
<div id="install-tidyverse" class="section level4 hasAnchor" number="1.7.1.1">
<h4 class="hasAnchor"><span class="header-section-number">1.7.1.1</span> What is Tidyverse?<a href="#install-tidyverse" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="danger">
<p>
Do not install any packages on the university machines. All the
packages you need are already installed. You would only need to install
packages if you are using your own machine.
</p>
<p>
You must also never place <code>install.packages()</code> in any r
script or RMarkdown document: installing it a second time can break the
installation and by sharing this script you would be attempting to force
others to install it on their machines.
</p>
<p>
This is at best rude and at worst it can break their
installation.
</p>
</div>
<p>Tidyverse is a “metapackage”- a package that is actually a collection of packages that have been bundled together. It was developed by Hadley Wickham. You can read more abut the package <a href="https://www.tidyverse.org/">here</a>.</p>
</div>
<div id="install.packages" class="section level4 hasAnchor" number="1.7.1.2">
<h4 class="hasAnchor"><span class="header-section-number">1.7.1.2</span> <code>install.packages()</code><a href="#install.packages" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>When you install a package, you should do this in the console part of the interface, as shown here:</p>
<center>
<img src="images/console.png" alt="The Console" style="margin:10px 10px">
</center>
<p>Types the following in and then hit “enter”:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">install.packages</span>(<span class="st">&quot;tidyverse&quot;</span>)</span></code></pre></div>
<p>Note that the name of the package is in quotation marks when used here. This is not always the case!</p>
<p>The console will then fill with a lot of text showing you what is being done. It is not necessary to understand all of this.</p>
<p>Look out for this message being printed in the console</p>
<center>
<img src="images/tidyverse_installed.png" style="border:1px solid #000000">
</center>
<p>This indicates that the package has been installed successfully. There will be many of these messages for different packages. There may even be parts after this message if the computer determines that other “dependencies” (additional software that tidyverse requires to run) are required.</p>
<p>Once R has stopped working (doing it’s current task) the <code>&gt;</code> will reappear in the console. This symbol reappearing means that R is ready for further code.</p>
<p>To install other packages you would reuse the <strong>function</strong> <code>install.packages()</code>, replacing the name “tidyverse” with the name of the package you want to install.</p>
<p>We will cover functions shortly.</p>
</div>
</div>
<div id="load-tidyverse" class="section level3 hasAnchor" number="1.7.2">
<h3 class="hasAnchor"><span class="header-section-number">1.7.2</span> Loading Packages<a href="#load-tidyverse" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now that we have installed tidyverse it is on our machine but it is not ready to use yet!</p>
<p>It is easier to understand if you think about it like this: if you install Instagram on your phone you only do it once and you have to open the app each time you want to use it.</p>
<p>Similarly, once tidyverse is installed it is on your computer until you remove it. If you want to use it you need to “open it”. This is done by using another <strong>function</strong>, <code>library()</code>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<p>This must be done before you use tidyverse. We normally do this in the first chunk in the document, essentially gathering our tools before we start working.</p>
<p>If you want to load other packages you would reuse the <strong>function</strong> <code>library()</code>, replacing “tidyverse” with the name of the package you want to load.</p>
</div>
</div>
<div id="functions" class="section level2 hasAnchor" number="1.8">
<h2 class="hasAnchor"><span class="header-section-number">1.8</span> Functions<a href="#functions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>“Function” is a word that you will hear a lot in this class. But what are they? What do they look like? what are they made up of?</p>
<div id="what-is-a-function" class="section level3 hasAnchor" number="1.8.1">
<h3 class="hasAnchor"><span class="header-section-number">1.8.1</span> What is a function?<a href="#what-is-a-function" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If I were to tell you to jump, you would understand the action I was asking you to perform wouldn’t you? But before you carry it out you might ask me a question in return: how high?</p>
<p>This is what a function is for R… it’s a command that tells R to do something. It just does it in a way that R understands.</p>
</div>
<div id="the-anatomy-of-a-function-names-and-arguments" class="section level3 hasAnchor" number="1.8.2">
<h3 class="hasAnchor"><span class="header-section-number">1.8.2</span> The Anatomy of a Function: names and arguments<a href="#the-anatomy-of-a-function-names-and-arguments" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Functions are made up of elements. See the code chunk below:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">function_name</span>(argument1, argument2, etc...)</span></code></pre></div>
<p>The part outside of the brackets is the <strong>name of the function</strong>. This tells R exactly what to do- the action to be performed. The parts inside the brackets are called <strong>arguments</strong>… these provide information to R on what to perform the actions on (and input) and can provide information on slight changes to the actions.</p>
<div class="info">
<p>
Essentially the function name is the action to perform (jump) and the
arguments give information on how to perform the action (how high).
</p>
<p>
Think about <code>install.packages(“tidyverse”)</code> and
<code>library(tidyverse)</code>: what are the function names and what
are the arguments? Which part changes when you want to install and load
a different package?
</p>
</div>
<p>Once your function has taken the input and run the command on it, it will produce an output.</p>
<p>As we progress through this course, see if you can spot the functions, the arguments, the inputs and the outputs.</p>
</div>
</div>
<div id="formative-homework" class="section level2 hasAnchor" number="1.9">
<h2 class="hasAnchor"><span class="header-section-number">1.9</span> Formative Homework<a href="#formative-homework" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="install-r-and-rstudio-on-your-personal-computer" class="section level3 hasAnchor" number="1.9.1">
<h3 class="hasAnchor"><span class="header-section-number">1.9.1</span> Install R and RStudio on your personal computer<a href="#install-r-and-rstudio-on-your-personal-computer" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If you haven’t done so, please read the chapter <a href="@ref(#before)">Assignment before starting the course</a> and either install R and RStudio on your own computer, or familiarise yourself with the RStudio Cloud.</p>
</div>
<div id="installing-and-loading-tidyverse" class="section level3 hasAnchor" number="1.9.2">
<h3 class="hasAnchor"><span class="header-section-number">1.9.2</span> Installing and Loading tidyverse<a href="#installing-and-loading-tidyverse" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Use the information in the section @ref(install-tidyverse) above to install the tidyverse package on your RStudio installation.</p>
<div class="info">
<p>
If you are using RStudio Cloud you are provided with a completely
self-contained computing environment. This means that you can
<code>install.packages()</code> on your virtual RStudio too as
required.
</p>
</div>
<p>Load tidyverse from the using the <code>library()</code> function in section @ref(load-tidyverse). <em>For now</em> you can do this in either a new .r file, .Rmd file or even in the console.</p>
<p>If you successfully load it you will see this printed in the console:</p>
<center>
<img src="images/tidyverse_success.png">
</center>
<p>You will be using the tidyverse package in the next lesson, so don’t worry if you struggle with this at the moment.</p>
<!--chapter:end:01-intro.Rmd-->
</div>
</div>
</div>
<div id="introduction-to-data" class="section level1 hasAnchor" number="2">
<h1 class="hasAnchor"><span class="header-section-number">2</span> Introduction to Data<a href="#introduction-to-data" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="intended-learning-outcomes-2" class="section level2 unnumbered hasAnchor">
<h2 class="unnumbered hasAnchor">Intended Learning Outcomes<a href="#intended-learning-outcomes-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li>understand basic data types</li>
<li>create and store vectors</li>
<li>convert data types into one another</li>
<li>create a data table from scratch</li>
<li>import and store data</li>
</ol>
<p>This lesson is led by <a href="https://www.psy.gla.ac.uk/otherstaff/?id=TJ001">Johanna Werner</a>.</p>
</div>
<div id="pre-steps" class="section level2 hasAnchor" number="2.1">
<h2 class="hasAnchor"><span class="header-section-number">2.1</span> Pre-Steps<a href="#pre-steps" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Before we begin, we need to do some house-keeping.</p>
<div id="downloading-materials" class="section level3 hasAnchor" number="2.1.1">
<h3 class="hasAnchor"><span class="header-section-number">2.1.1</span> Downloading materials<a href="#downloading-materials" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>First, we need to download the materials we are working with today. You can find them on moodle. It’s a zip folder that contains an Rmd file called <code>L2_stub</code> and a data file in .csv format for later. <code>L2_stub</code> has all the code chunks listed for today’s lesson. You are more than welcome to add notes and comments to the Rmd (white chunks), however there is no need to copy any code.</p>
</div>
<div id="unzipping-the-zip-folder" class="section level3 hasAnchor" number="2.1.2">
<h3 class="hasAnchor"><span class="header-section-number">2.1.2</span> Unzipping the zip folder<a href="#unzipping-the-zip-folder" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The folder we have downloaded is a zip folder. R cannot handle zip folders very well, so the folder needs to be unzipped. Right-mouseclick on the zipped folder, then choose <code>Extract All...</code>.</p>
<p>Copy and paste/ move the folder to your M drive (or somewhere that makes sense to you - and where you can find it again - if you are using your own computer).</p>
<p>Check the unzipped folder contains the <code>L2_stub.Rmd</code> and a data file called <code>MM_data.csv</code>.</p>
</div>
<div id="setting-the-working-directory" class="section level3 hasAnchor" number="2.1.3">
<h3 class="hasAnchor"><span class="header-section-number">2.1.3</span> Setting the working directory<a href="#setting-the-working-directory" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>It is always good practice to set your working directory to the folder you are working with. This can be done in 2 ways:</p>
<ol style="list-style-type: decimal">
<li><p>In the menu, go to <strong>Session &gt; Set Working Directory &gt; Choose Directory</strong> (Ctrl + Shift + H also works as key short cut in a Windows environment). Then select the folder containing the data file and click ‘open’. You might not see any files in the folder you are selecting - that is fine.</p></li>
<li><p>In the <code>Files pane</code>, you could navigate to today’s folder, and once there click on <strong>More &gt; Set As Working Directory</strong>.</p></li>
</ol>
<p>Whichever way you prefer is fine. The files <code>L2_stub</code> and <code>MM_data.csv</code> should now be visible in the <code>Files pane</code>.</p>
</div>
<div id="load-tidyverse-into-the-library" class="section level3 hasAnchor" number="2.1.4">
<h3 class="hasAnchor"><span class="header-section-number">2.1.4</span> Load tidyverse into the library<a href="#load-tidyverse-into-the-library" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We will be using a few functions today that are part of the <code>tidyverse</code> package compilation. Let’s load tidyverse in the library now, so we do not have to worry about it later on.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<p>Yay, with that out of the way, we can begin Lesson 2.</p>
</div>
</div>
<div id="basic-data-types" class="section level2 hasAnchor" number="2.2">
<h2 class="hasAnchor"><span class="header-section-number">2.2</span> Basic data types<a href="#basic-data-types" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>There are plenty data types, however for our purposes we will be focussing on:</p>
<table>
<colgroup>
<col width="20%" />
<col width="51%" />
<col width="27%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">data type</th>
<th align="left">description</th>
<th align="left">example</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">character</td>
<td align="left">text string</td>
<td align="left"><code>"hello World!"</code>, <code>"35.2"</code>, <code>'TRUE'</code></td>
</tr>
<tr class="even">
<td align="left">double</td>
<td align="left">double precision floating point numbers</td>
<td align="left"><code>.033</code>, <code>-2.5</code></td>
</tr>
<tr class="odd">
<td align="left">integer</td>
<td align="left">positive &amp; negative whole numbers</td>
<td align="left"><code>0L</code>, <code>1L</code>, <code>365L</code></td>
</tr>
<tr class="even">
<td align="left">logical</td>
<td align="left">Boolean operator with only two possible values</td>
<td align="left"><code>TRUE</code>, <code>FALSE</code></td>
</tr>
</tbody>
</table>
<div id="character" class="section level3 hasAnchor" number="2.2.1">
<h3 class="hasAnchor"><span class="header-section-number">2.2.1</span> Character<a href="#character" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You can store any text as a value in your local environment. You can either use single or double inverted commas.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>my_quote <span class="ot">&lt;-</span> <span class="st">&#39;R is Fun to learn!&#39;</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(my_quote) <span class="co"># cat() prints the value stored in my_quote</span></span></code></pre></div>
<p>If you want to use a direct quote, you need to include a backslash before each inverted comma.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>direct_quote <span class="ot">&lt;-</span> <span class="st">&quot;My friend said </span><span class="sc">\&quot;</span><span class="st">R is Fun to learn</span><span class="sc">\&quot;</span><span class="st">, and we all agreed.&quot;</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(direct_quote)</span></code></pre></div>
<pre><code>## My friend said &quot;R is Fun to learn&quot;, and we all agreed.</code></pre>
<div class="info">
<p>
You can check the data type using the <code>typeof()</code> function.
If you want to know which class they belong to, you can use the
<code>class()</code> function.
</p>
</div>
</div>
<div id="numeric" class="section level3 hasAnchor" number="2.2.2">
<h3 class="hasAnchor"><span class="header-section-number">2.2.2</span> Numeric<a href="#numeric" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>double</code> and <code>integer</code> are both class numeric. Double is a number with decimal places whereas integer is a number that’s a full number. Any number will be stored as a <code>double</code> unless you specify <code>integer</code> by adding an L as a suffix.</p>
<p>Example:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(<span class="fl">359.1</span>)</span></code></pre></div>
<pre><code>## [1] &quot;double&quot;</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## [1] &quot;double&quot;</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(45L)</span></code></pre></div>
<pre><code>## [1] &quot;integer&quot;</code></pre>
</div>
<div id="logical" class="section level3 hasAnchor" number="2.2.3">
<h3 class="hasAnchor"><span class="header-section-number">2.2.3</span> Logical<a href="#logical" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A logical vector is a vector that only contains TRUE and FALSE values. You can use that type of data to compare (or relate) 2 pieces of information. We have several comparison (or relational) operators in R. A few of them are:</p>
<center>
<img src="images/Logical_operators.png">
</center>
<p>More information on logical comparison operators can be found on <a href="https://bookdown.org/ndphillips/YaRrr/logical-indexing.html" class="uri">https://bookdown.org/ndphillips/YaRrr/logical-indexing.html</a> (from which the above image was modified).</p>
<p>You could compare if two values are equal…</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="dv">100</span> <span class="sc">==</span> <span class="dv">100</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>… or if they are not equal.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="dv">100</span> <span class="sc">!=</span> <span class="dv">100</span></span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<p>We can test if one value is smaller or equal than the other…</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span> <span class="sc">&lt;=</span> <span class="dv">9-4</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>… or if one value is larger than another.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="dv">101</span> <span class="sc">&gt;</span> <span class="dv">111</span></span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<p>Note that it works with character strings as well. (Not really important for this class though)</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># &quot;a&quot; == &quot;a&quot; would be TRUE as both side of the comparison contain the same information.</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;a&quot;</span> <span class="sc">==</span> <span class="st">&quot;a&quot;</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># &quot;a&quot; &lt;= &quot;b&quot; would be TRUE as a comes before b in the alphabet (i.e. 1st letter vs 2nd letter)</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;a&quot;</span> <span class="sc">&lt;=</span> <span class="st">&quot;b&quot;</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># &quot;abc&quot; &gt; &quot;a&quot; would be TRUE as there are more values on the left than on the right</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;abc&quot;</span> <span class="sc">&gt;</span> <span class="st">&quot;a&quot;</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p><span style="font-size: 22px; font-weight: bold; color: hsl(24, 100%, 50%);">Question Time</span></p>
<p>Run the following examples in your Console and select from the drop down menu what data type they belong to:</p>
<ul>
<li>class(1): <select class='webex-select'><option value='blank'></option><option value=''>character</option><option value='answer'>double</option><option value=''>integer</option><option value=''>logical</option><option value=''>Error message</option></select></li>
<li>class(1L): <select class='webex-select'><option value='blank'></option><option value=''>character</option><option value=''>double</option><option value='answer'>integer</option><option value=''>logical</option><option value=''>Error message</option></select></li>
<li>class(1.0): <select class='webex-select'><option value='blank'></option><option value=''>character</option><option value='answer'>double</option><option value=''>integer</option><option value=''>logical</option><option value=''>Error message</option></select></li>
<li>class(“1”): <select class='webex-select'><option value='blank'></option><option value='answer'>character</option><option value=''>double</option><option value=''>integer</option><option value=''>logical</option><option value=''>Error message</option></select></li>
<li>class(1L == 2L): <select class='webex-select'><option value='blank'></option><option value=''>character</option><option value=''>double</option><option value=''>integer</option><option value='answer'>logical</option><option value=''>Error message</option></select></li>
<li>class(1L &lt;= 2L): <select class='webex-select'><option value='blank'></option><option value=''>character</option><option value=''>double</option><option value=''>integer</option><option value='answer'>logical</option><option value=''>Error message</option></select></li>
<li>class(1L &lt;= 2L, “1”): <select class='webex-select'><option value='blank'></option><option value=''>character</option><option value=''>double</option><option value=''>integer</option><option value=''>logical</option><option value='answer'>Error message</option></select></li>
</ul>
<div class="webex-solution">
<button>
Explain this - why is 1 not an integer?
</button>
<div class="solved">
<p>
Any number will be stored as a <code>double</code> unless you specify
<code>integer</code> by adding an L as a suffix.
</p>
</div>
</div>
</div>
</div>
<div id="vectors" class="section level2 hasAnchor" number="2.3">
<h2 class="hasAnchor"><span class="header-section-number">2.3</span> Vectors<a href="#vectors" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Vectors are one of the very simple data structure in R. You could define them as “a single entity consisting of a collection of things”.</p>
<div id="creating-vectors" class="section level3 hasAnchor" number="2.3.1">
<h3 class="hasAnchor"><span class="header-section-number">2.3.1</span> Creating vectors<a href="#creating-vectors" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If you want to combine more than one element into one vector, you can do that by using the <code>c()</code> function. c stands for combine or as my colleague once said, it’s hugging multiple elements together. All elements in the vector have to be of the same data type.</p>
<p><strong>Examples:</strong></p>
<p>This is a vector of datatype <code>double</code>.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">2.5</span>, <span class="fl">4.7</span>)</span></code></pre></div>
<pre><code>## [1] 1.0 2.5 4.7</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">2.5</span>, <span class="fl">4.7</span>))</span></code></pre></div>
<pre><code>## [1] &quot;double&quot;</code></pre>
<p>This is a vector of datatype <code>integer</code>. Adding the <code>L</code> makes it an integer, but see that in the printout the <code>L</code> is actually omitted.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(0L, 1L, 2L, 365L)</span></code></pre></div>
<pre><code>## [1]   0   1   2 365</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(<span class="fu">c</span>(0L, 1L, 2L, 365L))</span></code></pre></div>
<pre><code>## [1] &quot;integer&quot;</code></pre>
<p>This is a vector of datatype <code>character</code>.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="st">&quot;hello&quot;</span>, <span class="st">&quot;student&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;hello&quot;   &quot;student&quot;</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(<span class="fu">c</span>(<span class="st">&quot;hello&quot;</span>, <span class="st">&quot;student&quot;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;character&quot;</code></pre>
<p>This is a vector of datatype <code>logic</code>.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## [1]  TRUE FALSE</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(<span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>))</span></code></pre></div>
<pre><code>## [1] &quot;logical&quot;</code></pre>
<p>We have seen what vectors look like. If you want to store these vectors in your global environment, all you need is the <code>assignment operator &lt;-</code> and a <code>meaingful name</code> for “the thing” you want to store. Here the first example reads like: “Take a vector of 3 elements (namely 1, 2.5, 4.7) and store it in your <code>Global Environment</code> under the name <code>vec_double</code>.” You can then use the name you assigned to the vector within the <code>typeof()</code> function, rather than the vector itself.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>vec_double <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">2.5</span>, <span class="fl">4.7</span>)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(vec_double)</span></code></pre></div>
<pre><code>## [1] &quot;double&quot;</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>vec_integer <span class="ot">&lt;-</span> <span class="fu">c</span>(0L, 1L, 2L, 365L)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(vec_integer)</span></code></pre></div>
<pre><code>## [1] &quot;integer&quot;</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>vec_character <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;hello&quot;</span>, <span class="st">&quot;student&quot;</span>)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(vec_character)</span></code></pre></div>
<pre><code>## [1] &quot;character&quot;</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>vec_logic <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(vec_logic)</span></code></pre></div>
<pre><code>## [1] &quot;logical&quot;</code></pre>
<div class="funfact">
<p>
Funnily enough, a vector <code>i &lt;- c(1,3,4,6)</code> would be
stored as a <code>double</code>. However, when coded as
<code>i &lt;- 1:10</code> would be stored as an
<code>integer</code>.
</p>
<p>
Don’t believe it? Try it out in your Console!
</p>
</div>
<p><span style="font-size: 22px; font-weight: bold; color: hsl(24, 100%, 50%);">Question Time</span></p>
<div class="task">
<p>
<strong>Your turn</strong>
</p>
<ul>
<li>
<p>
Create a vector of your 3 favourite movies and call it
<code>favourite_movies</code>. What type of data are we
expecting?
</p>
</li>
<li>
<p>
Pick a couple of your family members or friends and create a
vector <code>years_birth</code> that lists their year of birth. How many
elements does the vector have, and what type of data are we
expecting?
</p>
</li>
<li>
<p>
Create a vector that holds all the letters of the alphabet and
call it <code>alph</code>.
</p>
</li>
<li>
<p>
Create a vector with 3 elements of your name, age, and the
country you are from. Store this vector under the name
<code>this_is_me</code>. What type of data are we expecting?
</p>
</li>
</ul>
</div>
<div class="webex-solution">
<button>
Explain this!
</button>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gaby&#39;s solution:</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>favourite_movies <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Red&quot;</span>, <span class="st">&quot;Cloud Atlas&quot;</span>, <span class="st">&quot;Hot Fuzz&quot;</span>) <span class="co"># character</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>years_birth <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1953</span>, <span class="dv">1975</span>) <span class="co"># double</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>alph <span class="ot">&lt;-</span> letters <span class="co"># muahahahaaaa! &amp; character</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>this_is_me <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Gaby&quot;</span>, <span class="dv">38</span>, <span class="st">&quot;Germany&quot;</span>) <span class="co"># character</span></span></code></pre></div>
<div class="solved">
<p>
More detailed explanations:
</p>
<p>
R has Built-in Constants:
</p>
<ul>
<li>
<code>letters</code>: the 26 lower-case letters of the Roman
alphabet; <br>
</li>
<li>
<code>LETTERS</code>: the 26 UPPER-case letters of the Roman
alphabet; <br>
</li>
<li>
<code>month.abb</code>: the three-letter abbreviations for the
English month names; <br>
</li>
<li>
<code>month.name</code>: the English names for the months of the
year; <br>
</li>
<li>
<code>pi</code>: the ratio of the circumference of a circle to its
diameter
</li>
</ul>
<p>
Of course, the task could have been solved typing alph &lt;- c(“a”,
“b”, “c”, “d”, “e”, “f”, “g”, “h”, “i”, “j”, “k”, “l”, “m”, “n”, “o”,
“p”, “q”, “r”, “s”, “t”, “u”, “v”, “w”, “x”, “y”, “z”)
</p>
<p>
<code>this_is_me</code> would be stored as a <code>character</code>
vector despite having text as well as numeric elements. Remember how we
said earlier that all elements have to be of the same data type? After
the next section, you will understand why they are stored as a character
and not as a numeric vector.
</p>
</div>
</div>
</div>
<div id="converting-vectors-into-different-data-types-of-vectors-aka-funky-things-we-can-do" class="section level3 hasAnchor" number="2.3.2">
<h3 class="hasAnchor"><span class="header-section-number">2.3.2</span> Converting vectors into different data types of vectors aka funky things we can do<a href="#converting-vectors-into-different-data-types-of-vectors-aka-funky-things-we-can-do" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can also reassign data types to our vectors we have just created. For example if we wanted to turn our <code>var_double</code> from <code>double</code> to <code>character</code>, we would code</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>vec_double_as_char <span class="ot">&lt;-</span> <span class="fu">as.character</span>(vec_double)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(vec_double_as_char)</span></code></pre></div>
<pre><code>## [1] &quot;character&quot;</code></pre>
<p>In your Global Environment, you can now see that the vector <code>vec_double</code> has 3 numeric elements (abbreviated <code>num</code>), whereas <code>vec_double_as_char</code> has 3 character elements (abbreviated <code>chr</code>). Also note that the numbers 1.2, 2.5, and 4.7 have now quotation marks around them.</p>
<p>Likewise, if we wanted to turn our integer vector <code>vec_integer</code> into data type <code>double</code>, we would use</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>vec_integer_as_double <span class="ot">&lt;-</span> <span class="fu">as.double</span>(vec_integer)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(vec_integer_as_double)</span></code></pre></div>
<pre><code>## [1] &quot;double&quot;</code></pre>
<p>In your Global Environment, see how <code>vec_integer</code> has <code>int</code> assigned to it, whereas <code>vec_integer_as_double</code> is now listed as <code>num</code>. The <code>typeof</code> function revealed that the 4 elements of <code>vec_integer_as_double</code> are now stored as data type <code>double</code>.</p>
<p>However, trying to turn a character vector into an <code>integer</code> or a <code>double</code> would fail.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>vec_char_as_int <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(vec_character) <span class="co"># same outcome if we tried as.double</span></span></code></pre></div>
<pre><code>## Warning: NAs durch Umwandlung erzeugt</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(vec_char_as_int)</span></code></pre></div>
<pre><code>## [1] &quot;integer&quot;</code></pre>
<p>R would still compute “something” but it would be accompanied by the above warning message. As you can see in your Global Environment, <code>vec_char_as_int</code> does indeed exist as a numeric vector with 2 elements, but <code>NA</code> tells us they are classified as missing values.</p>
<p>A logical vector can be converted into all other basic data types.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>vec_logic_as_int <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(vec_logic)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>vec_logic_as_int</span></code></pre></div>
<pre><code>## [1] 1 0</code></pre>
<p><code>TRUE</code> and <code>FALSE</code> will be coded as <code>1</code> and <code>0</code> respectively when converting a logical into a numeric vector (integer or double). When converting a logical into a characters, it will just read as <code>"TRUE"</code> and <code>"FALSE"</code>.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>vec_logic_as_char <span class="ot">&lt;-</span> <span class="fu">as.character</span>(vec_logic)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>vec_logic_as_char</span></code></pre></div>
<pre><code>## [1] &quot;TRUE&quot;  &quot;FALSE&quot;</code></pre>
<p><span style="font-size: 22px; font-weight: bold; color: hsl(24, 100%, 50%);">Question Time</span></p>
<p>Remember the vector <code>this_is_me</code>? Can you explain now why it was stored as <code>character</code>?</p>
<div class="webex-solution">
<button>
Nope, I don’t get it!
</button>
<div class="info">
<p>
<code>this_is_me</code> would be stored as a <code>character</code>
vector because this is the best way to retain all information. If this
were to be stored as a <code>numeric</code> vector, the name and home
country could only be coded as missing values <code>NA</code>. So rather
than trying to turn everything into a number (which is not possible/
does not retain meaningful information), R turns the number into
character (which is possible).
</p>
</div>
</div>
<p><br></p>
<p>With this in mind, what data type would the vector be stored as if you combined the following elements?</p>
<ol style="list-style-type: decimal">
<li>logical and double - i.e. c(TRUE, 45)</li>
<li>character and logical - i.e. c(“Sarah”, “Marc”, FALSE)</li>
<li>integer and logical - i.e. c(1:3, TRUE)</li>
<li>logical, double, and integer - i.e. c(FALSE, 99.5, 3L)</li>
</ol>
<div class="webex-solution">
<button>
Solution
</button>
<div class="solved">
<ol style="list-style-type: decimal">
<li>
double
</li>
<li>
character
</li>
<li>
integer
</li>
<li>
double
</li>
</ol>
</div>
</div>
</div>
<div id="adding-elements-to-existing-vectors" class="section level3 hasAnchor" number="2.3.3">
<h3 class="hasAnchor"><span class="header-section-number">2.3.3</span> Adding elements to existing vectors<a href="#adding-elements-to-existing-vectors" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s start with a vector called <code>friends</code> that has three names in it.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>friends <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Gaby&quot;</span>, <span class="st">&quot;Wil&quot;</span>, <span class="st">&quot;Greta&quot;</span>)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>friends</span></code></pre></div>
<pre><code>## [1] &quot;Gaby&quot;  &quot;Wil&quot;   &quot;Greta&quot;</code></pre>
<p>We can now add more <code>friends</code> to our little group of <code>friends</code> by adding them either at the end, or the beginning of the vector. <code>friends</code> will now have four, and five values respectively, since we are “overwriting” our existing vector with the new one of the same name.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>friends <span class="ot">&lt;-</span> <span class="fu">c</span>(friends, <span class="st">&quot;Kate&quot;</span>)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>friends</span></code></pre></div>
<pre><code>## [1] &quot;Gaby&quot;  &quot;Wil&quot;   &quot;Greta&quot; &quot;Kate&quot;</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>friends <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Rebecca&quot;</span>, friends)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>friends</span></code></pre></div>
<pre><code>## [1] &quot;Rebecca&quot; &quot;Gaby&quot;    &quot;Wil&quot;     &quot;Greta&quot;   &quot;Kate&quot;</code></pre>
<p>Vectors also support missing data. If we wanted to add “another friend” whose name we do not know yet, we can just simply add <code>NA</code> to <code>friends</code>.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>friends <span class="ot">&lt;-</span> <span class="fu">c</span>(friends, <span class="cn">NA</span>)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>friends</span></code></pre></div>
<pre><code>## [1] &quot;Rebecca&quot; &quot;Gaby&quot;    &quot;Wil&quot;     &quot;Greta&quot;   &quot;Kate&quot;    NA</code></pre>
<p>The vector <code>friends</code> would still be a character vector. Missing values do not alter the original data type. However, if you look in the Global Environment, you can see that the number of elements stored in <code>friends</code> increased from 5 to 6. To determine the number of elements in a vector in R (rather than eye sight), you can also use a function called <code>length()</code>.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(friends)</span></code></pre></div>
<pre><code>## [1] &quot;character&quot;</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(friends)</span></code></pre></div>
<pre><code>## [1] 6</code></pre>
<p>Well, now we decided that 5 friends in our little group of friends is sufficient, and we did not want anyone else to join, we could remove the “placeholder friend NA” by coding</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>friends <span class="ot">&lt;-</span> friends[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>friends</span></code></pre></div>
<pre><code>## [1] &quot;Rebecca&quot; &quot;Gaby&quot;    &quot;Wil&quot;     &quot;Greta&quot;   &quot;Kate&quot;</code></pre>
<p>You can see that the length of the vector <code>friends</code> is now back to 5 again.</p>
<div class="funfact">
<p>
<code>1:5</code> uses the colon operator<code>:</code> which is read
as in “access the vector elements 1, 5, and everything in between”. An
alternative way of writing out the above without using a colon operator
would be <code>friends[c(1,2,3,4,5)]</code>. Notice that you need the
<code>c()</code> function again.
</p>
</div>
<p>Just as easily, we can create vectors for numeric sequences. The function <code>seq()</code> is a neat way of doing this, or you can use the colon operator<code>:</code> again. Just with the elements in the vector above, the same logic applies here. For example <code>1:10</code> means, you want to list number 1, number 10, and all numbers in between.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>sequence1 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>sequence1</span></code></pre></div>
<pre><code>##  [1]  1  2  3  4  5  6  7  8  9 10</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>sequence2 <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">10</span>)</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>sequence2</span></code></pre></div>
<pre><code>##  [1]  1  2  3  4  5  6  7  8  9 10</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compare whether sequence1 and sequence2 are of the same data type</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(sequence1) <span class="sc">==</span> <span class="fu">typeof</span>(sequence2)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compare whether elements of sequence1 are the same as the elements in sequence2 </span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>sequence1 <span class="sc">==</span> sequence2</span></code></pre></div>
<pre><code>##  [1] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE</code></pre>
<p><span style="font-size: 22px; font-weight: bold; color: hsl(24, 100%, 50%);">Question Time</span></p>
<ul>
<li>What data type is <code>sequence1</code>? <select class='webex-select'><option value='blank'></option><option value=''>character</option><option value=''>double</option><option value='answer'>integer</option><option value=''>logical</option></select></li>
<li>What data type is <code>sequence2</code>? <select class='webex-select'><option value='blank'></option><option value=''>character</option><option value=''>double</option><option value='answer'>integer</option><option value=''>logical</option></select></li>
<li>If we were to store the output of <code>sequence1 == sequence2</code> in a vector, what data type would the vector be? <select class='webex-select'><option value='blank'></option><option value=''>character</option><option value=''>double</option><option value=''>integer</option><option value='answer'>logical</option></select></li>
</ul>
</div>
</div>
<div id="tibble---the-new-way-of-creating-a-dataframe" class="section level2 hasAnchor" number="2.4">
<h2 class="hasAnchor"><span class="header-section-number">2.4</span> Tibble - the new way of creating a dataframe<a href="#tibble---the-new-way-of-creating-a-dataframe" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="what-the-heck-is-a-tibble-do-you-mean-table" class="section level3 hasAnchor" number="2.4.1">
<h3 class="hasAnchor"><span class="header-section-number">2.4.1</span> What the heck is a tibble? Do you mean table?<a href="#what-the-heck-is-a-tibble-do-you-mean-table" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>First of all, tibble is not a spelling error; it’s the way r refers to its newest form of data table or dataframe. Strictly speaking, a tibble is a list of vectors.</p>
<div class="figure">
<img src="images/tibble.png" alt="" />
<p class="caption">Source: <a href="https://dcl-prog.stanford.edu/data-structure-basics.html#tibbles" class="uri">https://dcl-prog.stanford.edu/data-structure-basics.html#tibbles</a></p>
</div>
<p>You can create a dataframe either by using the <code>tibble()</code> function or a function called <code>data.frame()</code>. <code>tibble()</code> is part of the package <code>tidyverse</code> whereas <code>data.frame</code> can be found in base R and does not need an additional package read into the library. Tibbles are slightly different to dataframes in that</p>
<ul>
<li>they have better print properties (Dataframes print ALL data when you call the data whereas tibbles only print the first 10 rows of data)</li>
<li>character vectors are not coerced into factors (which you will be thankful for later on in your programming life)</li>
<li>column names are not modified (for example if you wanted to make a column called <code>Female Voices</code> you could just do that. <code>tibble</code> keeps it as <code>Female Voices</code> with a space between the two words, whereas the <code>data.table</code> function would change it to <code>Female.Voices</code>)</li>
</ul>
<p>If you want to read more about the differences between dataframes and tibbles (and appreciate the advantages of tibbles), have a look on <a href="https://cran.r-project.org/web/packages/tibble/vignettes/tibble.html" class="uri">https://cran.r-project.org/web/packages/tibble/vignettes/tibble.html</a>.</p>
</div>
<div id="how-to-make-a-tibble-from-scratch" class="section level3 hasAnchor" number="2.4.2">
<h3 class="hasAnchor"><span class="header-section-number">2.4.2</span> How to make a tibble from scratch<a href="#how-to-make-a-tibble-from-scratch" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now that you have learnt how to create vectors, we can try and combine them into a tibble. The easiest way is to use the <code>tibble()</code> function. Let’s say we want to create a tibble that is called <code>tibble_year</code> with 4 columns:</p>
<ul>
<li>The first column <code>month</code> lists all months of the year</li>
<li>The second column <code>abb_month</code> gives us the three-letter abbreviation of each year.</li>
<li>The third column <code>month_num</code> tells which number of the year is which month (e.g. January would be the first month of the year; December would be number 12).</li>
<li>The fourth column <code>season</code> would tell us in which season the month is (Northern hemisphere).</li>
</ul>
<p>Remember the Built-in Constants we were talking about earlier?</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remember to load tidyverse into your script at least once (usually at the beginning)</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>tibble_year <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">month =</span> month.name,</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">abb_month =</span> month.abb,</span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>                      <span class="at">month_num =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>,</span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">season =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;Winter&quot;</span>, <span class="dv">2</span>), <span class="fu">rep</span>(<span class="st">&quot;Spring&quot;</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">&quot;Summer&quot;</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">&quot;Autumn&quot;</span>, <span class="dv">3</span>), <span class="st">&quot;Winter&quot;</span>))</span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>tibble_year</span></code></pre></div>
<pre><code>## # A tibble: 12 x 4
##    month     abb_month month_num season
##    &lt;chr&gt;     &lt;chr&gt;         &lt;int&gt; &lt;chr&gt; 
##  1 January   Jan               1 Winter
##  2 February  Feb               2 Winter
##  3 March     Mar               3 Spring
##  4 April     Apr               4 Spring
##  5 May       May               5 Spring
##  6 June      Jun               6 Summer
##  7 July      Jul               7 Summer
##  8 August    Aug               8 Summer
##  9 September Sep               9 Autumn
## 10 October   Oct              10 Autumn
## 11 November  Nov              11 Autumn
## 12 December  Dec              12 Winter</code></pre>
<p>The generic structure of each of these columns we are creating is <code>column header name</code> <code>=</code> <code>values to fill in the rows</code>.</p>
<div class="info">
<p>
Here, we used the built-in replication function <code>rep()</code> to
build the column <code>season</code> which is a more time-efficient
approach than typing out 4 seasons 3 times. Of course, we could have
written season = c(“Winter”, “Winter”, “Spring”, “Spring”, “Spring”,
“Summer”, “Summer”, “Summer”, “Autumn”, “Autumn”, “Autumn”, “Winter”)
instead.
</p>
</div>
<p>We can now use the function <code>glimpse()</code> to see which data types our columns are. This is a very handy function to keep in mind for later!</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(tibble_year)</span></code></pre></div>
<pre><code>## Rows: 12
## Columns: 4
## $ month     &lt;chr&gt; &quot;January&quot;, &quot;February&quot;, &quot;March&quot;, &quot;April&quot;, &quot;May&quot;, &quot;June&quot;, &quot;Jul~
## $ abb_month &lt;chr&gt; &quot;Jan&quot;, &quot;Feb&quot;, &quot;Mar&quot;, &quot;Apr&quot;, &quot;May&quot;, &quot;Jun&quot;, &quot;Jul&quot;, &quot;Aug&quot;, &quot;Sep~
## $ month_num &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12
## $ season    &lt;chr&gt; &quot;Winter&quot;, &quot;Winter&quot;, &quot;Spring&quot;, &quot;Spring&quot;, &quot;Spring&quot;, &quot;Summer&quot;, ~</code></pre>
<p><code>glimpse()</code> tells us that our tibble has one column that is an integer, and three columns that are character strings. If we wanted to influence which datatype the columns (something that is not automatically assigned), we can do that by using the functions <code>as.double()</code>, <code>as.character()</code>, <code>as.integer()</code>, etc. we have seen earlier when we were talking about vectors. For example, if we wanted to modify the <code>integer</code> column as a <code>double</code>, we would type</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>tibble_year2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">month =</span> month.name,</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">abb_month =</span> month.abb,</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">month_num =</span> <span class="fu">as.double</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>),</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">season =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;Winter&quot;</span>, <span class="dv">2</span>), <span class="fu">rep</span>(<span class="st">&quot;Spring&quot;</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">&quot;Summer&quot;</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">&quot;Autumn&quot;</span>, <span class="dv">3</span>), <span class="st">&quot;Winter&quot;</span>))</span></code></pre></div>
<div class="warning">
<p>
If you click on the name of the dataset in your
<code>Global Environment</code> to view your dataframe, you would see no
actual difference between <code>tibble_year</code> and
<code>tibble_year2</code>. However, <code>glimpse()</code> would tell
you.
</p>
<p>
If I were a mean person, and had recoded month_num =
as.character(1:12) instead, you would not see it when you visually
inspect the data. What would the consequences be?
</p>
</div>
<p><span style="font-size: 22px; font-weight: bold; color: hsl(24, 100%, 50%);">Question Time</span></p>
<div class="task">
<p>
<strong>Your turn</strong>
</p>
<p>
Make a tibble called <code>mydata</code> with 5 columns and 10
rows:
</p>
<ul>
<li>
column 1 is called <code>PP_ID</code> and contains participant
numbers 1 to 10. Make sure this data type is <code>integer</code>.
</li>
<li>
column 2 is called <code>PP_Age</code> and and contains the age of
the participant. Make sure this data type is <code>double</code>.
</li>
<li>
column 3 is called <code>PP_Sex</code> and contains the sex of the
participant. Even PP_IDs are male, odd PP_IDs are female
participants.
</li>
<li>
column 4 is called <code>PP_Country</code> and contains the country
participants were born in. Surprise, surprise - they were all born in
Scotland!!!
</li>
<li>
column 5 is called <code>PP_Consent</code> and is an overview
whether participants have given their consent to participate in an
experiment (TRUE) or not (FALSE). Participants 1-9 have given their
consent, participant 10 has not.
</li>
</ul>
</div>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gaby&#39;s solution:</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>mydata <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">PP_ID =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">PP_Age =</span> <span class="fu">c</span>(<span class="dv">22</span>, <span class="dv">21</span>, <span class="dv">24</span>, <span class="dv">36</span>, <span class="dv">33</span>, <span class="dv">25</span>, <span class="dv">21</span>, <span class="dv">31</span>, <span class="dv">28</span>, <span class="dv">35</span>),</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">PP_Sex =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;Female&quot;</span>, <span class="st">&quot;Male&quot;</span>), <span class="dv">5</span>),</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">PP_Country =</span> <span class="st">&quot;Scotland&quot;</span>,</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">PP_Consent =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="cn">TRUE</span>, <span class="dv">9</span>), <span class="cn">FALSE</span>))</span></code></pre></div>
<div class="info">
<p>
But there are plenty of other ways how this could have been done. For
example:
</p>
<ul>
<li>
PP_ID = seq(10) <br>
</li>
<li>
PP_ID = as.integer(c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10)) <br>
</li>
<li>
PP_Age = as.double(22:31) <br>
</li>
<li>
PP_Sex = c(“Female”, “Male”, “Female”, “Male”, “Female”, “Male”,
“Female”, “Male”, “Female”, “Male”) <br>
</li>
<li>
PP_Country = rep(“Scotland”, 10) <br>
</li>
<li>
PP_Consent = c(TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE,
FALSE)
</li>
</ul>
</div>
</div>
</div>
</div>
<div id="reading-in-data" class="section level2 hasAnchor" number="2.5">
<h2 class="hasAnchor"><span class="header-section-number">2.5</span> Reading in data<a href="#reading-in-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="from-pre-existing-databases" class="section level3 hasAnchor" number="2.5.1">
<h3 class="hasAnchor"><span class="header-section-number">2.5.1</span> from pre-existing databases<a href="#from-pre-existing-databases" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>R comes with pre-installed datasets available for you to use and practice your skills on. If you want have an overview over all databases available type <code>data()</code> into your Console.</p>
<p>One of those datasets is called “Motor Trend Car Road Tests” or in short <code>mtcars</code>. If you type <code>mtcars</code> into your Console, you can see what the dataset looks like.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>mtcars</span></code></pre></div>
<pre><code>##                      mpg cyl  disp  hp drat    wt  qsec vs am gear carb
## Mazda RX4           21.0   6 160.0 110 3.90 2.620 16.46  0  1    4    4
## Mazda RX4 Wag       21.0   6 160.0 110 3.90 2.875 17.02  0  1    4    4
## Datsun 710          22.8   4 108.0  93 3.85 2.320 18.61  1  1    4    1
## Hornet 4 Drive      21.4   6 258.0 110 3.08 3.215 19.44  1  0    3    1
## Hornet Sportabout   18.7   8 360.0 175 3.15 3.440 17.02  0  0    3    2
## Valiant             18.1   6 225.0 105 2.76 3.460 20.22  1  0    3    1
## Duster 360          14.3   8 360.0 245 3.21 3.570 15.84  0  0    3    4
## Merc 240D           24.4   4 146.7  62 3.69 3.190 20.00  1  0    4    2
## Merc 230            22.8   4 140.8  95 3.92 3.150 22.90  1  0    4    2
## Merc 280            19.2   6 167.6 123 3.92 3.440 18.30  1  0    4    4
## Merc 280C           17.8   6 167.6 123 3.92 3.440 18.90  1  0    4    4
## Merc 450SE          16.4   8 275.8 180 3.07 4.070 17.40  0  0    3    3
## Merc 450SL          17.3   8 275.8 180 3.07 3.730 17.60  0  0    3    3
## Merc 450SLC         15.2   8 275.8 180 3.07 3.780 18.00  0  0    3    3
## Cadillac Fleetwood  10.4   8 472.0 205 2.93 5.250 17.98  0  0    3    4
## Lincoln Continental 10.4   8 460.0 215 3.00 5.424 17.82  0  0    3    4
## Chrysler Imperial   14.7   8 440.0 230 3.23 5.345 17.42  0  0    3    4
## Fiat 128            32.4   4  78.7  66 4.08 2.200 19.47  1  1    4    1
## Honda Civic         30.4   4  75.7  52 4.93 1.615 18.52  1  1    4    2
## Toyota Corolla      33.9   4  71.1  65 4.22 1.835 19.90  1  1    4    1
## Toyota Corona       21.5   4 120.1  97 3.70 2.465 20.01  1  0    3    1
## Dodge Challenger    15.5   8 318.0 150 2.76 3.520 16.87  0  0    3    2
## AMC Javelin         15.2   8 304.0 150 3.15 3.435 17.30  0  0    3    2
## Camaro Z28          13.3   8 350.0 245 3.73 3.840 15.41  0  0    3    4
## Pontiac Firebird    19.2   8 400.0 175 3.08 3.845 17.05  0  0    3    2
## Fiat X1-9           27.3   4  79.0  66 4.08 1.935 18.90  1  1    4    1
## Porsche 914-2       26.0   4 120.3  91 4.43 2.140 16.70  0  1    5    2
## Lotus Europa        30.4   4  95.1 113 3.77 1.513 16.90  1  1    5    2
## Ford Pantera L      15.8   8 351.0 264 4.22 3.170 14.50  0  1    5    4
## Ferrari Dino        19.7   6 145.0 175 3.62 2.770 15.50  0  1    5    6
## Maserati Bora       15.0   8 301.0 335 3.54 3.570 14.60  0  1    5    8
## Volvo 142E          21.4   4 121.0 109 4.11 2.780 18.60  1  1    4    2</code></pre>
<p>You can look up what all the column headers mean by typing <code>?mtcars</code> into your Console, or using the help tab to search for <code>mtcars</code>.</p>
<div class="question">
<p>
<code>mtcars</code> is a dataframe rather than a tibble. How do we
know that?
</p>
</div>
<div class="webex-solution">
<button>
Answer
</button>
<div class="solved">
<p>
When we called <code>mtcars</code> it printed the whole dataframe
rather than just the first 10 rows.
</p>
</div>
</div>
<p>However, we have seen what the data in <code>mtcars</code> looks now, but we would be able to work with it better if put it into our <code>Global Environment</code>. Let’s save <code>mtcars</code> as a dataframe called <code>data_mtcars</code>, and look at the first few rows which can be achieved using the <code>head()</code> function.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>data_mtcars <span class="ot">&lt;-</span> mtcars <span class="co"># read in as a dataframe</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_mtcars)</span></code></pre></div>
<pre><code>##                    mpg cyl disp  hp drat    wt  qsec vs am gear carb
## Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
## Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
## Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
## Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1
## Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2
## Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1</code></pre>
<p>Notice that we do not have a column header for the type of car. The reason is that the type of car is actually the name of the rows, rather than a column itself. As you can see in your <code>Global Environment</code>, <code>df_mtcars</code> has 32 observations, and 11 variables - car type is not one of them.</p>
<div class="info">
<p>
Adding the rownames as a separate column would be rather tricky at
this stage in the course (but you could try and do it after lecture
5).
</p>
</div>
<p>Another interesting dataset is called <code>starwars</code>. It can be found in the package <code>dplyr</code> which is part of <code>tidyverse</code>. So, as long as you have <code>tidyverse</code> loaded into your library, <code>starwars</code> should be available to you.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># if you have already done this in your Rmd, this step is superfluous</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>starwars</span></code></pre></div>
<pre><code>## # A tibble: 87 x 14
##    name     height  mass hair_color skin_color eye_color birth_year sex   gender
##    &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
##  1 Luke Sk~    172    77 blond      fair       blue            19   male  mascu~
##  2 C-3PO       167    75 &lt;NA&gt;       gold       yellow         112   none  mascu~
##  3 R2-D2        96    32 &lt;NA&gt;       white, bl~ red             33   none  mascu~
##  4 Darth V~    202   136 none       white      yellow          41.9 male  mascu~
##  5 Leia Or~    150    49 brown      light      brown           19   fema~ femin~
##  6 Owen La~    178   120 brown, gr~ light      blue            52   male  mascu~
##  7 Beru Wh~    165    75 brown      light      blue            47   fema~ femin~
##  8 R5-D4        97    32 &lt;NA&gt;       white, red red             NA   none  mascu~
##  9 Biggs D~    183    84 black      light      brown           24   male  mascu~
## 10 Obi-Wan~    182    77 auburn, w~ fair       blue-gray       57   male  mascu~
## # ... with 77 more rows, and 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;,
## #   films &lt;list&gt;, vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
<p>In comparison to <code>mtcars</code>, <code>starwars</code> is already a tibble (which you can see in the first line of the printout). It gives you the number of observations (87) and variables (13), the column headers, the data type of each column, and the first 10 rows of data. Again, it would be neater to work with the data if we saved the data tibble to our <code>Global Environment</code>. Let’s do that and call it <code>data_SW</code>.</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>data_SW <span class="ot">&lt;-</span> starwars</span></code></pre></div>
<p>Again, you could use the very handy <code>glimpse()</code> function to see what data types the columns are.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(data_SW)</span></code></pre></div>
<div class="funfact">
<p>
There are other built in datasets available, such as
<code>babynames</code>. The <code>babynames</code> dataset is located in
a package called <code>babynames</code> which needs to be installed
first, and then loaded into the library before you can look at the data.
Do you remember how we install packages and load them into the
library?
</p>
</div>
<div class="webex-solution">
<button>
Hint
</button>
<div class="solved">
<p>
install.packages(“babynames”) <br> library(babynames)
</p>
<p>
Remember that you only have to do the
<code>install.packages(“babynames”)</code> once - before you want to use
<code>babynames</code> for the very first time. Once you have installed
it, you can use it whenever you feel like by just loading it into the
library.
</p>
</div>
</div>
</div>
<div id="from-existing-data-files" class="section level3 hasAnchor" number="2.5.2">
<h3 class="hasAnchor"><span class="header-section-number">2.5.2</span> from existing data files<a href="#from-existing-data-files" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>R is able to handle different types of data files. The most common one available is <code>.csv</code>. CSV stands for <strong>comma-separated values</strong>. Usually, a <code>.csv</code> file is opened with some sort of excel programme (like Microsoft Excel, LibreOffice, OpenOffice, Apple Numbers, etc.) which takes the comma separator as a mean to format everything into a nice and neat table. If you open your data in Notepad, you can actually see the structure of it.</p>
<center>
<img src="images/MM_csv.PNG">
</center>
<div class="info">
<p>
There are other file types out there, apart from csv, like tsv
(tab-separated values), excel, SAS, or SPSS. However, these would go
beyond the scope of this class. All of our data will be in a .csv
format.
</p>
</div>
<p>Getting the data from the csv file into your <code>Global Environment</code> in R is by using a function called <code>read_csv()</code> from the package <code>tidyverse</code>. Since we did the house-keeping (i.e. loading in the package tidyverse into the library) at the very beginning, there is no need for us to do that again.</p>
<p>The data you just saw in the screenshot above are from <code>M&amp;Ms colours by bag</code> (<a href="http://www.randomservices.org/random/data/index.html" class="uri">http://www.randomservices.org/random/data/index.html</a>). The data table gives the color counts and net weight (in grams) for a sample of 30 bags of M&amp;M’s. The advertised net weight is 47.9 grams.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>MM_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;MM_data.csv&quot;</span>)</span></code></pre></div>
<pre><code>## Rows: 30 Columns: 7
## -- Column specification --------------------------------------------------------
## Delimiter: &quot;,&quot;
## dbl (7): Red, Green, Blue, Orange, Yellow, Brown, Weight
## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<p>As you can see, R is giving you a bit of an output of what it has just done - parsed some columns. The data is stored as an object in your <code>Global Environment</code> now, and we could either <code>call the data</code> (by typing <code>MM_data</code> into the <code>Console</code>) or use <code>glimpse()</code> to have a look what the data actually looks like and what data types are in each column.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>MM_data</span></code></pre></div>
<pre><code>## # A tibble: 30 x 7
##      Red Green  Blue Orange Yellow Brown Weight
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
##  1    15     9     3      3      9    19   49.8
##  2     9    17    19      3      3     8   49.0
##  3    14     8     6      8     19     4   50.4
##  4    15     7     3      8     16     8   49.2
##  5    10     3     7      9     22     4   47.6
##  6    12     7     6      5     17    11   49.8
##  7     6     7     3      6     26    10   50.2
##  8    14    11     4      1     14    17   51.7
##  9     4     2    10      6     18    18   48.4
## 10     9     9     3      9      8    15   46.2
## # ... with 20 more rows</code></pre>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(MM_data)</span></code></pre></div>
<pre><code>## Rows: 30
## Columns: 7
## $ Red    &lt;dbl&gt; 15, 9, 14, 15, 10, 12, 6, 14, 4, 9, 9, 8, 12, 9, 6, 4, 3, 14, 5~
## $ Green  &lt;dbl&gt; 9, 17, 8, 7, 3, 7, 7, 11, 2, 9, 11, 8, 9, 7, 6, 6, 5, 5, 5, 9, ~
## $ Blue   &lt;dbl&gt; 3, 19, 6, 3, 7, 6, 3, 4, 10, 3, 13, 6, 13, 7, 6, 9, 11, 6, 16, ~
## $ Orange &lt;dbl&gt; 3, 3, 8, 8, 9, 5, 6, 1, 6, 9, 0, 5, 2, 2, 4, 4, 12, 6, 12, 4, 1~
## $ Yellow &lt;dbl&gt; 9, 3, 19, 16, 22, 17, 26, 14, 18, 8, 7, 11, 6, 18, 21, 12, 11, ~
## $ Brown  &lt;dbl&gt; 19, 8, 4, 8, 4, 11, 10, 17, 18, 15, 18, 20, 13, 7, 13, 20, 16, ~
## $ Weight &lt;dbl&gt; 49.79, 48.98, 50.40, 49.16, 47.61, 49.80, 50.23, 51.68, 48.45, ~</code></pre>
<div class="info">
<p>
You could also have used the function <code>head()</code> to show the
first 6 rows of the dataframe or could have viewed the data by clicking
manually on <code>MM_data</code> in the
<code>Global Environment</code>.
</p>
<p>
Watch out, though!!! <code>head(</code>) can be a bit misleading in
that it creates a new tibble and the output reads
<code># A tibble: 6 x 7</code>. This does not mean that our
<code>MM_data</code> only has 6 rows of observations!!!
</p>
<p>
Viewing the data opens the data in a new tab in the
<code>Source pane</code> but it does not show you the data types of the
columns. You could, however, click on the wee blue arrow next to the
data name.
</p>
</div>
<p>Now that we have inspected the data, what does it actually tell us?</p>
<p><span style="font-size: 22px; font-weight: bold; color: hsl(24, 100%, 50%);">Question Time</span></p>
<p>How many rows (or observations) does <code>MM_data</code> have? <input class='webex-solveme nospaces' size='2' data-answer='["30"]'/> <br>
How many columns (or variables) does <code>MM_data</code> have? <input class='webex-solveme nospaces' size='1' data-answer='["7"]'/> <br>
What data type are all of the columns? <select class='webex-select'><option value='blank'></option><option value=''>character</option><option value='answer'>double</option><option value=''>integer</option><option value=''>logical</option></select></p>
<div class="danger">
<p>
Always use read_csv() from the tidyverse package for reading in the
data. There is a similar function called read.csv() from base R -
<strong>DO NOT USE read.csv()</strong>. These two functions have
differences in assigning datatypes to the columns and <strong>read_csv()
does a better job</strong>. This applies to the homework task as well.
You will not receive marks if you are using the wrong function. So
double check before submitting!!!
</p>
</div>
</div>
</div>
<div id="last-point-for-today" class="section level2 hasAnchor" number="2.6">
<h2 class="hasAnchor"><span class="header-section-number">2.6</span> Last point for today<a href="#last-point-for-today" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Restart R and clear your workspace. Knit your <code>L2_stub</code>. If it knits, it is an indication that all your code chunks are running. This is important for most of the graded assessments in the future. If it runs on your computer, it will run on ours.</p>
</div>
<div id="summative-homework" class="section level2 hasAnchor" number="2.7">
<h2 class="hasAnchor"><span class="header-section-number">2.7</span> Summative Homework<a href="#summative-homework" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The first summative assessment is compiled of 11 questions from Lectures 1 and 2. You can download the files from moodle. The folder you download is a zip folder that needs to be unzipped before you can work with it. It contains the homework submission file labelled <code>GUID_L1L2.Rmd</code> and a data file called <code>TraitJudgementData.csv</code>.</p>
<p>Good luck.</p>
<p>Check that your Rmd file knits into a html file before submitting. Upload your Rmd file (not the knitted html) to moodle.</p>
<!--chapter:end:02-data.Rmd-->
</div>
</div>
<div id="data-transformation-1-basic-one-table-verbs" class="section level1 hasAnchor" number="3">
<h1 class="hasAnchor"><span class="header-section-number">3</span> Data Transformation 1: Basic One Table Verbs<a href="#data-transformation-1-basic-one-table-verbs" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="intended-learning-outcomes-3" class="section level2 unnumbered hasAnchor">
<h2 class="unnumbered hasAnchor">Intended Learning Outcomes<a href="#intended-learning-outcomes-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Be able to use the following dplyr one-table verbs:</p>
<ul>
<li>select()</li>
<li>arrange()</li>
<li>filter()</li>
<li>mutate()</li>
<li>group_by()</li>
<li>summarise()</li>
</ul>
<p>This lesson is led by Johanna Werner.</p>
</div>
<div id="data-wrangling" class="section level2 hasAnchor" number="3.1">
<h2 class="hasAnchor"><span class="header-section-number">3.1</span> Data Wrangling<a href="#data-wrangling" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>It is estimated that data scientists spend between 50-80% of their time cleaning and preparing data. This so-called <strong>data wrangling</strong> is a crucial first step in organising data for subsequent analysis (NYTimes., 2014). The goal is generally to get the data into a “tidy” format whereby each variable is a column, each observation is a row and each value is a cell. The <code>tidyverse</code> package, developed by Hadley Wickham, is a collection of R packages built around this basic concept and intended to make data science fast, easy and fun. It contains six core packages: dplyr, tidyr, readr, purrr, ggplot2, and tibble.</p>
<p><code>dplyr</code> provides a useful selection of functions - each corresponding to a basic verb:</p>
<table>
<colgroup>
<col width="28%" />
<col width="71%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">dplyr function</th>
<th align="left">description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">select()</td>
<td align="left">Include or exclude certain variables (columns)</td>
</tr>
<tr class="even">
<td align="left">arrange()</td>
<td align="left">Reorder observations (rows)</td>
</tr>
<tr class="odd">
<td align="left">filter()</td>
<td align="left">Include or exclude certain observations (rows)</td>
</tr>
<tr class="even">
<td align="left">mutate()</td>
<td align="left">Create new variables (columns) and preserve existing ones</td>
</tr>
<tr class="odd">
<td align="left">group_by()</td>
<td align="left">Organise observations (rows) by variables (columns)</td>
</tr>
<tr class="even">
<td align="left">summarise()</td>
<td align="left">Compute summary statistics for selected variables (columns)</td>
</tr>
</tbody>
</table>
<p>These are termed <strong>one table verbs</strong> as they only operate on one table at a time. Today we will examine the Wickham Six; select(), arrange(), filter(), mutate(), group_by(), and summarise().</p>
</div>
<div id="pre-steps-1" class="section level2 hasAnchor" number="3.2">
<h2 class="hasAnchor"><span class="header-section-number">3.2</span> Pre-Steps<a href="#pre-steps-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Before we can talk about today’s data, let’s do some house-keeping first.</p>
<div id="downloading-materials-1" class="section level3 hasAnchor" number="3.2.1">
<h3 class="hasAnchor"><span class="header-section-number">3.2.1</span> Downloading materials<a href="#downloading-materials-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Download the materials we will be working with today from moodle. The zip folder that contains an Rmd file called <code>L3_stub</code>, and a data file called <code>CareerStats.csv</code>. Similar to last week, <code>L3_stub</code> contains all code chunks for today’s lesson, and is intended for you to add notes and comments.</p>
</div>
<div id="unzipping-the-zip-folder-1" class="section level3 hasAnchor" number="3.2.2">
<h3 class="hasAnchor"><span class="header-section-number">3.2.2</span> Unzipping the zip folder<a href="#unzipping-the-zip-folder-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Make sure you <strong>unzip the folder</strong> and check it contains the <code>L3_stub.Rmd</code> and <code>CareerStats.csv</code>.</p>
</div>
<div id="setting-the-working-directory-1" class="section level3 hasAnchor" number="3.2.3">
<h3 class="hasAnchor"><span class="header-section-number">3.2.3</span> Setting the working directory<a href="#setting-the-working-directory-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Set that folder as your working directory for today. The files in the folders should now be visible in the <code>Files pane</code>.</p>
</div>
<div id="loading-in-the-required-packages-into-the-library" class="section level3 hasAnchor" number="3.2.4">
<h3 class="hasAnchor"><span class="header-section-number">3.2.4</span> Loading in the required packages into the library<a href="#loading-in-the-required-packages-into-the-library" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As we will be using functions that are part of <code>tidyverse</code>, we need to load it into the library. You will also need to load in the new package <code>babynames</code>. You will need to have this package installed first before you can load it into the library, if you haven’t done that yet use the <code>install.packages()</code> function down in your console first.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(babynames)</span></code></pre></div>
</div>
<div id="read-in-the-data" class="section level3 hasAnchor" number="3.2.5">
<h3 class="hasAnchor"><span class="header-section-number">3.2.5</span> Read in the data<a href="#read-in-the-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now, today we will work with two different datasets, one fairly simple dataset, and another more messy complex dataset later one.</p>
<p>The first is a large dataset about babynames (big surprise!). The package you installed and loaded into the library is infact a readymade dataset, that can be read straight into the <code>Global Environment</code>. We will deal with the second dataset later.</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>Name_Data <span class="ot">&lt;-</span> babynames</span></code></pre></div>
</div>
<div id="view-the-data" class="section level3 hasAnchor" number="3.2.6">
<h3 class="hasAnchor"><span class="header-section-number">3.2.6</span> View the data<a href="#view-the-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Click on <code>Name_Data</code> in your <code>Global Environment</code> to open your data in a new tab on the <code>Source</code> pane or call the object in your <code>Console</code> (by typing the name of the object <code>Name_Data</code>) to check that the data was correctly imported into R.</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>Name_Data</span></code></pre></div>
<pre><code>## # A tibble: 1,924,665 x 5
##     year sex   name          n   prop
##    &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;     &lt;int&gt;  &lt;dbl&gt;
##  1  1880 F     Mary       7065 0.0724
##  2  1880 F     Anna       2604 0.0267
##  3  1880 F     Emma       2003 0.0205
##  4  1880 F     Elizabeth  1939 0.0199
##  5  1880 F     Minnie     1746 0.0179
##  6  1880 F     Margaret   1578 0.0162
##  7  1880 F     Ida        1472 0.0151
##  8  1880 F     Alice      1414 0.0145
##  9  1880 F     Bertha     1320 0.0135
## 10  1880 F     Sarah      1288 0.0132
## # ... with 1,924,655 more rows</code></pre>
<div class="funfact">
<p>
You could also view the data by using the function
<code>View()</code>. If you are more of a typer than a mouse-user you
can type <code>View(Name_Data)</code> into your <code>Console</code>.
This will open the data in a read-only, spreadsheet-like format in a new
tab on the <code>Source</code> pane.
</p>
</div>
<p>Remember from last week, we can also use <code>glimpse()</code> to view the columns and their datatypes.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(Name_Data)</span></code></pre></div>
<pre><code>## Rows: 1,924,665
## Columns: 5
## $ year &lt;dbl&gt; 1880, 1880, 1880, 1880, 1880, 1880, 1880, 1880, 1880, 1880, 1880,~
## $ sex  &lt;chr&gt; &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, ~
## $ name &lt;chr&gt; &quot;Mary&quot;, &quot;Anna&quot;, &quot;Emma&quot;, &quot;Elizabeth&quot;, &quot;Minnie&quot;, &quot;Margaret&quot;, &quot;Ida&quot;,~
## $ n    &lt;int&gt; 7065, 2604, 2003, 1939, 1746, 1578, 1472, 1414, 1320, 1288, 1258,~
## $ prop &lt;dbl&gt; 0.07238359, 0.02667896, 0.02052149, 0.01986579, 0.01788843, 0.016~</code></pre>
<p><code>head()</code> would be helpful in displaying only the first 6 rows of the dataset, but remember not to get “tricked” by the number of observations shown in the output.</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Name_Data)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 5
##    year sex   name          n   prop
##   &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;     &lt;int&gt;  &lt;dbl&gt;
## 1  1880 F     Mary       7065 0.0724
## 2  1880 F     Anna       2604 0.0267
## 3  1880 F     Emma       2003 0.0205
## 4  1880 F     Elizabeth  1939 0.0199
## 5  1880 F     Minnie     1746 0.0179
## 6  1880 F     Margaret   1578 0.0162</code></pre>
<p><span style="font-size: 22px; font-weight: bold; color: hsl(24, 100%, 50%);">Question Time</span></p>
<p>How many rows (or observations) does <code>Name_Data</code> have? <input class='webex-solveme nospaces' size='7' data-answer='["1924665"]'/> <br>
How many columns (or variables) does <code>Name_Data</code> have? <input class='webex-solveme nospaces' size='1' data-answer='["5"]'/> <br></p>
<div class="task">
<p>
Take some time to familiarise yourself with the variables in your
dataframe.
</p>
</div>
</div>
</div>
<div id="select" class="section level2 hasAnchor" number="3.3">
<h2 class="hasAnchor"><span class="header-section-number">3.3</span> select()<a href="#select" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You may not want to include every single variable in your analysis. In order to include or exclude certain variables (columns), use the <code>select()</code> function. The first argument to this function is the object you want to select variables from (i.e. our tibble called <code>Name_Data</code>), and the subsequent arguments are the variables to keep.</p>
<p>For example, if you wanted to keep all variables except from <code>prop</code>, you could type:</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(Name_Data, year, sex, name, n)</span></code></pre></div>
<pre><code>## # A tibble: 1,924,665 x 4
##     year sex   name          n
##    &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;     &lt;int&gt;
##  1  1880 F     Mary       7065
##  2  1880 F     Anna       2604
##  3  1880 F     Emma       2003
##  4  1880 F     Elizabeth  1939
##  5  1880 F     Minnie     1746
##  6  1880 F     Margaret   1578
##  7  1880 F     Ida        1472
##  8  1880 F     Alice      1414
##  9  1880 F     Bertha     1320
## 10  1880 F     Sarah      1288
## # ... with 1,924,655 more rows</code></pre>
<p>That works fine when you have realtively few variables like this dataset, however this menthod can become very time consuming if you have a lot of varibales in your dataset. There are two ways on how we could have done this easier and faster:</p>
<ol style="list-style-type: decimal">
<li>We could use the colon operator <code>:</code>. Similar to last week where we used the colon operator for numerical sequences, we can use it here for selecting a sequence of column names. Here, it reads as “take object <code>student_HM</code>, and select columns <code>year</code>, and every other column though to <code>n</code>”.</li>
</ol>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(Name_Data, year<span class="sc">:</span>n)</span></code></pre></div>
<pre><code>## # A tibble: 1,924,665 x 4
##     year sex   name          n
##    &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;     &lt;int&gt;
##  1  1880 F     Mary       7065
##  2  1880 F     Anna       2604
##  3  1880 F     Emma       2003
##  4  1880 F     Elizabeth  1939
##  5  1880 F     Minnie     1746
##  6  1880 F     Margaret   1578
##  7  1880 F     Ida        1472
##  8  1880 F     Alice      1414
##  9  1880 F     Bertha     1320
## 10  1880 F     Sarah      1288
## # ... with 1,924,655 more rows</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>We could use “negative selection”, i.e. select the variable we wanted to drop by adding a <code>minus</code> in front of it.</li>
</ol>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(Name_Data, <span class="sc">-</span>prop)</span></code></pre></div>
<pre><code>## # A tibble: 1,924,665 x 4
##     year sex   name          n
##    &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;     &lt;int&gt;
##  1  1880 F     Mary       7065
##  2  1880 F     Anna       2604
##  3  1880 F     Emma       2003
##  4  1880 F     Elizabeth  1939
##  5  1880 F     Minnie     1746
##  6  1880 F     Margaret   1578
##  7  1880 F     Ida        1472
##  8  1880 F     Alice      1414
##  9  1880 F     Bertha     1320
## 10  1880 F     Sarah      1288
## # ... with 1,924,655 more rows</code></pre>
<p>We also have the option of “de-selecting” more than one variable. By including the minus sign before each column we can remove as many as we want.</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(Name_Data, <span class="sc">-</span>prop, <span class="sc">-</span>sex)</span></code></pre></div>
<pre><code>## # A tibble: 1,924,665 x 3
##     year name          n
##    &lt;dbl&gt; &lt;chr&gt;     &lt;int&gt;
##  1  1880 Mary       7065
##  2  1880 Anna       2604
##  3  1880 Emma       2003
##  4  1880 Elizabeth  1939
##  5  1880 Minnie     1746
##  6  1880 Margaret   1578
##  7  1880 Ida        1472
##  8  1880 Alice      1414
##  9  1880 Bertha     1320
## 10  1880 Sarah      1288
## # ... with 1,924,655 more rows</code></pre>
<div class="funfact">
<p>
We can also use <code>select()</code> in combination with the
<code>c()</code> function. Remember, <code>c()</code>is “hugging things
together”. We would put a single <code>minus</code> in front of the c
rather than each of the column. This will read as exclude every column
listed within the brackets.
</p>
<p>
select(Name_Data, -c(sex, n, prop))
</p>
</div>
<p>Remember, if you don’t save this data to an object (e.g. the original dataframe <code>Name_Data</code> or under a new name), it won’t be saved. We have not saved any of the previous tasks to the <code>Global Environment</code>, so there should still be only one babynames related object, e.g. the tibble named <code>Name_Data</code>.</p>
<p><span style="font-size: 22px; font-weight: bold; color: hsl(24, 100%, 50%);">Question Time</span></p>
<div class="task">
<p>
<strong>Your turn</strong>
</p>
<p>
Create a tibble called <code>Name_Short</code> that keeps all
variables/columns from the data <code>Name_Data</code> except from
<code>sex</code> and <code>n</code>. Your new object
<code>Name_Short</code> should appear in your
<code>Global Environment</code>.
</p>
</div>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Jaimie&#39;s solution:</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>Name_Short <span class="ot">&lt;-</span> <span class="fu">select</span>(Name_Data, <span class="sc">-</span>sex, <span class="sc">-</span>n)</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a><span class="co"># OR</span></span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>Name_Short <span class="ot">&lt;-</span> <span class="fu">select</span>(Name_Data, <span class="sc">-</span><span class="fu">c</span>(sex, n))</span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a><span class="co"># OR</span></span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a>Name_Short <span class="ot">&lt;-</span> <span class="fu">select</span>(Name_Data, year, name, prop)</span></code></pre></div>
<div class="warning">
<p>
You could also reference the position of column, rather than the
actual name.
</p>
<ul>
<li>
select(Name_Data,1,3,5)
</li>
</ul>
<p>
While it works code-wise, and seems a much quicker approach, it is a
very bad idea in the name of reproducibility. If you send your code to a
fellow researcher, they would have no idea what the code does. Moreover,
if at some point, you need to add another column to your data, and/or
decide to reorder the sequence of your columns, your code would not run
anymore the way you expect it to.
</p>
</div>
</div>
</div>
<div id="arrange" class="section level2 hasAnchor" number="3.4">
<h2 class="hasAnchor"><span class="header-section-number">3.4</span> arrange()<a href="#arrange" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The <code>arrange()</code> function can reorder observations (rows) in ascending (default) or descending order. The first argument to this function is again an object (in this case the tibble <code>Name_Data</code>), and the subsequent arguments are the variables (columns) you want to sort by. For example, if you wanted to sort by <code>n</code> in <strong>ascending</strong> order (which is the default in <code>arrange()</code>) you would type:</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>Name_Arr <span class="ot">&lt;-</span> <span class="fu">arrange</span>(Name_Data, n)</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>Name_Arr</span></code></pre></div>
<pre><code>## # A tibble: 1,924,665 x 5
##     year sex   name          n      prop
##    &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;     &lt;int&gt;     &lt;dbl&gt;
##  1  1880 F     Adelle        5 0.0000512
##  2  1880 F     Adina         5 0.0000512
##  3  1880 F     Adrienne      5 0.0000512
##  4  1880 F     Albertine     5 0.0000512
##  5  1880 F     Alys          5 0.0000512
##  6  1880 F     Ana           5 0.0000512
##  7  1880 F     Araminta      5 0.0000512
##  8  1880 F     Arthur        5 0.0000512
##  9  1880 F     Birtha        5 0.0000512
## 10  1880 F     Bulah         5 0.0000512
## # ... with 1,924,655 more rows</code></pre>
<div class="warning">
<p>
If you were to assign this code to the same object as before
(i.e. Name_Data), the previous version of <code>Name_Data</code> would
be overwritten.
</p>
</div>
<p>Notice how the <code>n</code> column is now organised in alphabetical order i.e. smallest number to largest. Suppose you wanted to reverse this order, displaying largest, you would need to wrap the name of the variable in the <code>desc()</code> function (i.e. for <strong>descending</strong>).</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>Name_Arr2 <span class="ot">&lt;-</span> <span class="fu">arrange</span>(Name_Data, <span class="fu">desc</span>(n))</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>Name_Arr2</span></code></pre></div>
<pre><code>## # A tibble: 1,924,665 x 5
##     year sex   name        n   prop
##    &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;   &lt;int&gt;  &lt;dbl&gt;
##  1  1947 F     Linda   99686 0.0548
##  2  1948 F     Linda   96209 0.0552
##  3  1947 M     James   94756 0.0510
##  4  1957 M     Michael 92695 0.0424
##  5  1947 M     Robert  91642 0.0493
##  6  1949 F     Linda   91016 0.0518
##  7  1956 M     Michael 90620 0.0423
##  8  1958 M     Michael 90520 0.0420
##  9  1948 M     James   88588 0.0497
## 10  1954 M     Michael 88514 0.0428
## # ... with 1,924,655 more rows</code></pre>
<p>You can also sort by more than one column. For example, you could sort by <code>name</code> first, and then <code>n</code> second:</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>Name_Arr3 <span class="ot">&lt;-</span> <span class="fu">arrange</span>(Name_Data, name, n)</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>Name_Arr3</span></code></pre></div>
<pre><code>## # A tibble: 1,924,665 x 5
##     year sex   name      n       prop
##    &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;int&gt;      &lt;dbl&gt;
##  1  2007 M     Aaban     5 0.00000226
##  2  2009 M     Aaban     6 0.00000283
##  3  2010 M     Aaban     9 0.00000439
##  4  2016 M     Aaban     9 0.00000446
##  5  2011 M     Aaban    11 0.00000542
##  6  2012 M     Aaban    11 0.00000543
##  7  2017 M     Aaban    11 0.0000056 
##  8  2013 M     Aaban    14 0.00000694
##  9  2015 M     Aaban    15 0.00000736
## 10  2014 M     Aaban    16 0.00000783
## # ... with 1,924,655 more rows</code></pre>
<p>You can also arrange by multiple columns in desceding order too, or arrange by one column in ascending order and another in descending order if you wanted.</p>
</div>
<div id="filter" class="section level2 hasAnchor" number="3.5">
<h2 class="hasAnchor"><span class="header-section-number">3.5</span> filter()<a href="#filter" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="single-criterion" class="section level3 hasAnchor" number="3.5.1">
<h3 class="hasAnchor"><span class="header-section-number">3.5.1</span> Single criterion<a href="#single-criterion" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In order to include or exclude certain observations (rows), use the <code>filter()</code> function. The first argument to this function is an object (in this case the tibble <code>Name_Data</code>) and the subsequent argument is the criteria you wish to filter on. For example, if you want only those observations from the year of your birth:</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>Name_MyYear <span class="ot">&lt;-</span> <span class="fu">filter</span>(Name_Data, year <span class="sc">==</span> <span class="dv">1988</span>)</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(Name_MyYear)</span></code></pre></div>
<pre><code>## Rows: 22,364
## Columns: 5
## $ year &lt;dbl&gt; 1988, 1988, 1988, 1988, 1988, 1988, 1988, 1988, 1988, 1988, 1988,~
## $ sex  &lt;chr&gt; &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, ~
## $ name &lt;chr&gt; &quot;Jessica&quot;, &quot;Ashley&quot;, &quot;Amanda&quot;, &quot;Sarah&quot;, &quot;Jennifer&quot;, &quot;Brittany&quot;, &quot;~
## $ n    &lt;int&gt; 51538, 49961, 39455, 28366, 27887, 26815, 22836, 20699, 20310, 20~
## $ prop &lt;dbl&gt; 0.02680669, 0.02598643, 0.02052190, 0.01475413, 0.01450499, 0.013~</code></pre>
<p>or keep observations of only popular names:</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>Name_Pop <span class="ot">&lt;-</span> <span class="fu">filter</span>(Name_Data, prop <span class="sc">&gt;=</span> <span class="fl">0.07</span>)</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(Name_Pop)</span></code></pre></div>
<pre><code>## Rows: 19
## Columns: 5
## $ year &lt;dbl&gt; 1880, 1880, 1880, 1881, 1881, 1882, 1882, 1882, 1883, 1883, 1884,~
## $ sex  &lt;chr&gt; &quot;F&quot;, &quot;M&quot;, &quot;M&quot;, &quot;M&quot;, &quot;M&quot;, &quot;F&quot;, &quot;M&quot;, &quot;M&quot;, &quot;M&quot;, &quot;M&quot;, &quot;M&quot;, &quot;M&quot;, &quot;M&quot;, ~
## $ name &lt;chr&gt; &quot;Mary&quot;, &quot;John&quot;, &quot;William&quot;, &quot;John&quot;, &quot;William&quot;, &quot;Mary&quot;, &quot;John&quot;, &quot;Wi~
## $ n    &lt;int&gt; 7065, 9655, 9532, 8769, 8524, 8148, 9557, 9298, 8894, 8387, 9388,~
## $ prop &lt;dbl&gt; 0.07238359, 0.08154561, 0.08050676, 0.08098299, 0.07872038, 0.070~</code></pre>
<div class="question">
<ol style="list-style-type: decimal">
<li>
<p>
Notice how we saved the new data under a different object name
(<code>Name_MyYear</code>). When using <code>filter()</code>, you should
never replace/ overwrite your original data unless you know exactly what
you are doing. What could be the consequences?
</p>
</li>
<li>
<p>
By the way, what do symbols such <code>==</code> and
<code>&gt;=</code> remind you of??? (hint: something we covered last
week?)
</p>
</li>
</ol>
</div>
<div class="webex-solution">
<button>
Answers
</button>
<div class="solved">
<p>
Consequences: You could potentially lose some data. Nothing is ever
completely lost though (unless you are overwriting the original .csv
file) but it could result in more work for you to restore everything
from the beginning. Especially when your data scripts are very long and
analysis is complex (i.e. taking up a lot of computing power), that
could easily turn into a nightmare.
</p>
<p>
Remember the relational operators that returned logical values of
either <code>TRUE</code> or <code>FALSE</code>?
</p>
</div>
</div>
<p>Relational operators (such as <code>==</code>, <code>!=</code>, <code>&lt;</code>, <code>&lt;=</code>, <code>&gt;</code>, and <code>&gt;=</code>) compare two numerical expressions and return a Boolean variable: a variable whose value is either 0 (<code>FALSE</code>) or 1 (<code>TRUE</code>). So, essentially, <code>filter()</code> includes any observations (rows) for which the expression evaluates to <code>TRUE</code>, and excludes any for which it evaluates to <code>FALSE</code>. In the previous example, <code>filter()</code> sifted through 1924665 observations, keeping rows containing year that was equal to 1998.</p>
<p>This works as well for columns of the data type <code>character</code>. If you want only those observations for a specific name, you could use the equivalence operator <code>==</code>. Be aware that a single equals sign (<code>=</code>) is used to assign a value to a variable whereas a double equals sign (<code>==</code>) is used to check whether two values are equal.</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>Name_Me <span class="ot">&lt;-</span> <span class="fu">filter</span>(Name_Data, name <span class="sc">==</span> <span class="st">&quot;Jaimie&quot;</span>)</span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(Name_Me)</span></code></pre></div>
<pre><code>## Rows: 118
## Columns: 5
## $ year &lt;dbl&gt; 1946, 1948, 1951, 1952, 1953, 1954, 1955, 1956, 1957, 1958, 1958,~
## $ sex  &lt;chr&gt; &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;M&quot;, &quot;F&quot;, &quot;M&quot;, ~
## $ name &lt;chr&gt; &quot;Jaimie&quot;, &quot;Jaimie&quot;, &quot;Jaimie&quot;, &quot;Jaimie&quot;, &quot;Jaimie&quot;, &quot;Jaimie&quot;, &quot;Jaim~
## $ n    &lt;int&gt; 7, 5, 8, 8, 6, 8, 12, 16, 9, 28, 12, 30, 13, 19, 10, 20, 7, 23, 1~
## $ prop &lt;dbl&gt; 4.340e-06, 2.870e-06, 4.330e-06, 4.210e-06, 3.110e-06, 4.020e-06,~</code></pre>
<p>Here, the <code>filter()</code> function compares every single value in the column <code>name</code> of the data object <code>Name_Data</code> with the character string written on the right-hand side of the equation (“Jaimie”).</p>
<p>You can also use <code>filter()</code> to keep data from multiple options of the same variable using the <code>%in%</code> operator. In this case we want to filter several different names:</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>Name_J <span class="ot">&lt;-</span> <span class="fu">filter</span>(Name_Data, name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Jaimie&quot;</span>, <span class="st">&quot;Jamie&quot;</span>, <span class="st">&quot;Jaime&quot;</span>, <span class="st">&quot;James&quot;</span>, <span class="st">&quot;Jayme&quot;</span>))</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(Name_J)</span></code></pre></div>
<pre><code>## Rows: 963
## Columns: 5
## $ year &lt;dbl&gt; 1880, 1880, 1881, 1881, 1882, 1882, 1883, 1883, 1884, 1884, 1884,~
## $ sex  &lt;chr&gt; &quot;F&quot;, &quot;M&quot;, &quot;F&quot;, &quot;M&quot;, &quot;F&quot;, &quot;M&quot;, &quot;F&quot;, &quot;M&quot;, &quot;F&quot;, &quot;F&quot;, &quot;M&quot;, &quot;F&quot;, &quot;M&quot;, ~
## $ name &lt;chr&gt; &quot;James&quot;, &quot;James&quot;, &quot;James&quot;, &quot;James&quot;, &quot;James&quot;, &quot;James&quot;, &quot;James&quot;, &quot;J~
## $ n    &lt;int&gt; 22, 5927, 24, 5441, 18, 5892, 25, 5223, 33, 5, 5693, 26, 5175, 29~
## $ prop &lt;dbl&gt; 0.00022540, 0.05005912, 0.00024278, 0.05024843, 0.00015558, 0.048~</code></pre>
<p>Because <code>filter()</code> evalutes variables against your criteria and keeps observations that are <code>TRUE</code>, in essence the function defaults to “filter-in” certain observations. You can however also use it to “filter-out” specific observations, by using the ‘not equals’ operator <code>!=</code>. Here <code>filter()</code> keeps every row in which the value DOES NOT read what you have specificed.</p>
<p>Using <code>filter()</code> to exclude certain observations.</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>Name_J_Short <span class="ot">&lt;-</span> <span class="fu">filter</span>(Name_J, name <span class="sc">!=</span><span class="st">&quot;James&quot;</span>)</span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(Name_J_Short)</span></code></pre></div>
<pre><code>## Rows: 687
## Columns: 5
## $ year &lt;dbl&gt; 1884, 1887, 1888, 1890, 1891, 1892, 1893, 1894, 1895, 1896, 1896,~
## $ sex  &lt;chr&gt; &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;M&quot;, &quot;F&quot;, &quot;M&quot;, ~
## $ name &lt;chr&gt; &quot;Jamie&quot;, &quot;Jamie&quot;, &quot;Jamie&quot;, &quot;Jamie&quot;, &quot;Jamie&quot;, &quot;Jamie&quot;, &quot;Jamie&quot;, &quot;J~
## $ n    &lt;int&gt; 5, 5, 5, 12, 11, 10, 9, 9, 10, 8, 6, 9, 5, 11, 14, 20, 6, 20, 15,~
## $ prop &lt;dbl&gt; 3.634e-05, 3.217e-05, 2.639e-05, 5.951e-05, 5.596e-05, 4.446e-05,~</code></pre>
</div>
<div id="multiple-criteria" class="section level3 hasAnchor" number="3.5.2">
<h3 class="hasAnchor"><span class="header-section-number">3.5.2</span> Multiple criteria<a href="#multiple-criteria" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Often you will come across a situation where you will need to filter based on multiple criteria. For that you have the options of <code>AND</code> and <code>OR</code>. <code>AND</code>is used if you had two criteria and only wanted data returned when <strong>both</strong> criteria are met. <code>OR</code>is used if you had two criteria and wanted data returned for <strong>either</strong> criterion.</p>
<center>
<img src="images/AND_OR.png" height="150">
</center>
<p><strong>Simple Example:</strong> Just imagine, you have data of men and women who are either blond or dark-haired.</p>
<center>
<img src="images/avatars.png" height="150">
</center>
<p>If you wanted to filter everyone who has <em>blond</em> hair <strong>AND</strong> is a <em>man</em>, all your data looks like this:</p>
<center>
<img src="images/avatars_AND.png" height="150">
</center>
<p>Whereas, if you wanted to filter out everyone who has <strong>either</strong> <em>dark hair</em> <strong>OR</strong> is a <em>woman</em>, you would get:</p>
<center>
<img src="images/avatars_OR.png" height="150">
</center>
<p><br></p>
<p><strong>What does that mean for our babynames data?</strong></p>
<p>For example, to filter rows containing only your name, of one sex, since your year of birth, you would code:</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>Name_Specific <span class="ot">&lt;-</span> <span class="fu">filter</span>(Name_Data, name <span class="sc">==</span> <span class="st">&quot;Jaimie&quot;</span>, year <span class="sc">&gt;=</span> <span class="dv">1988</span>, sex <span class="sc">==</span> <span class="st">&quot;M&quot;</span>)</span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(Name_Specific)</span></code></pre></div>
<pre><code>## Rows: 19
## Columns: 5
## $ year &lt;dbl&gt; 1988, 1989, 1990, 1991, 1992, 1993, 1994, 1995, 1996, 1997, 1998,~
## $ sex  &lt;chr&gt; &quot;M&quot;, &quot;M&quot;, &quot;M&quot;, &quot;M&quot;, &quot;M&quot;, &quot;M&quot;, &quot;M&quot;, &quot;M&quot;, &quot;M&quot;, &quot;M&quot;, &quot;M&quot;, &quot;M&quot;, &quot;M&quot;, ~
## $ name &lt;chr&gt; &quot;Jaimie&quot;, &quot;Jaimie&quot;, &quot;Jaimie&quot;, &quot;Jaimie&quot;, &quot;Jaimie&quot;, &quot;Jaimie&quot;, &quot;Jaim~
## $ n    &lt;int&gt; 22, 15, 28, 21, 19, 14, 6, 9, 10, 10, 6, 11, 9, 12, 7, 6, 6, 5, 5
## $ prop &lt;dbl&gt; 1.099e-05, 7.160e-06, 1.302e-05, 9.910e-06, 9.050e-06, 6.780e-06,~</code></pre>
<div class="funfact">
<p>
You could have also used the logical operator <code>&amp;</code>
(AND) instead of the comma.
<code>filter(Name_Data, name == “Jaimie” &amp; year &gt;= 1988 &amp; sex == “M”)</code>
would have given you the same result as above.
</p>
</div>
<p>If we wanted to filter the data <code>Name_Data</code> for either names with a very high count <strong>OR</strong> names that account for a very low proportion, we could use the logical operator <code>|</code> (OR).</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>Data_Or <span class="ot">&lt;-</span> <span class="fu">filter</span>(Name_Data, n <span class="sc">&gt;</span> <span class="dv">90000</span> <span class="sc">|</span> prop <span class="sc">&lt;</span> <span class="fl">2.27e-06</span>)</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(Data_Or)</span></code></pre></div>
<pre><code>## Rows: 2,041
## Columns: 5
## $ year &lt;dbl&gt; 1947, 1947, 1947, 1948, 1949, 1956, 1957, 1958, 2007, 2007, 2007,~
## $ sex  &lt;chr&gt; &quot;F&quot;, &quot;M&quot;, &quot;M&quot;, &quot;F&quot;, &quot;F&quot;, &quot;M&quot;, &quot;M&quot;, &quot;M&quot;, &quot;M&quot;, &quot;M&quot;, &quot;M&quot;, &quot;M&quot;, &quot;M&quot;, ~
## $ name &lt;chr&gt; &quot;Linda&quot;, &quot;James&quot;, &quot;Robert&quot;, &quot;Linda&quot;, &quot;Linda&quot;, &quot;Michael&quot;, &quot;Michael~
## $ n    &lt;int&gt; 99686, 94756, 91642, 96209, 91016, 90620, 92695, 90520, 5, 5, 5, ~
## $ prop &lt;dbl&gt; 0.05483812, 0.05101589, 0.04933934, 0.05521079, 0.05184643, 0.042~</code></pre>
<p>As you will have noticed, <code>Data_Or</code> has now observations for names that either have a count over 90,000 in a year, or account for a very small proportion in a year. In this instance these are very distinct groups, and no observation would meet both criteria, check for yourself:</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>Data_Or2 <span class="ot">&lt;-</span> <span class="fu">filter</span>(Name_Data, n <span class="sc">&gt;</span> <span class="dv">90000</span> <span class="sc">&amp;</span> prop <span class="sc">&lt;</span> <span class="fl">2.27e-06</span>)</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(Data_Or2)</span></code></pre></div>
<pre><code>## Rows: 0
## Columns: 5
## $ year &lt;dbl&gt; 
## $ sex  &lt;chr&gt; 
## $ name &lt;chr&gt; 
## $ n    &lt;int&gt; 
## $ prop &lt;dbl&gt;</code></pre>
<p>Here we see <code>Data_Or2</code>, returns no observations. However sometimes, you might select multiple criteria, where some observations will only meet one, but other observations may meet both criteria (see below). So always keep in mind what exactly you want to find, and choose the best way to filter.</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>Data_Or3 <span class="ot">&lt;-</span> <span class="fu">filter</span>(Name_Data, n <span class="sc">&gt;</span> <span class="dv">90000</span> <span class="sc">|</span> prop <span class="sc">&gt;</span> <span class="fl">0.05</span>)</span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(Data_Or3)</span></code></pre></div>
<pre><code>## Rows: 172
## Columns: 5
## $ year &lt;dbl&gt; 1880, 1880, 1880, 1880, 1881, 1881, 1881, 1881, 1882, 1882, 1882,~
## $ sex  &lt;chr&gt; &quot;F&quot;, &quot;M&quot;, &quot;M&quot;, &quot;M&quot;, &quot;F&quot;, &quot;M&quot;, &quot;M&quot;, &quot;M&quot;, &quot;F&quot;, &quot;M&quot;, &quot;M&quot;, &quot;F&quot;, &quot;M&quot;, ~
## $ name &lt;chr&gt; &quot;Mary&quot;, &quot;John&quot;, &quot;William&quot;, &quot;James&quot;, &quot;Mary&quot;, &quot;John&quot;, &quot;William&quot;, &quot;J~
## $ n    &lt;int&gt; 7065, 9655, 9532, 5927, 6919, 8769, 8524, 5441, 8148, 9557, 9298,~
## $ prop &lt;dbl&gt; 0.07238359, 0.08154561, 0.08050676, 0.05005912, 0.06999140, 0.080~</code></pre>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>Data_Or4 <span class="ot">&lt;-</span> <span class="fu">filter</span>(Name_Data, n <span class="sc">&gt;</span> <span class="dv">90000</span> <span class="sc">&amp;</span> prop <span class="sc">&gt;</span> <span class="fl">0.05</span>)</span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(Data_Or4)</span></code></pre></div>
<pre><code>## Rows: 4
## Columns: 5
## $ year &lt;dbl&gt; 1947, 1947, 1948, 1949
## $ sex  &lt;chr&gt; &quot;F&quot;, &quot;M&quot;, &quot;F&quot;, &quot;F&quot;
## $ name &lt;chr&gt; &quot;Linda&quot;, &quot;James&quot;, &quot;Linda&quot;, &quot;Linda&quot;
## $ n    &lt;int&gt; 99686, 94756, 96209, 91016
## $ prop &lt;dbl&gt; 0.05483812, 0.05101589, 0.05521079, 0.05184643</code></pre>
<p><span style="font-size: 22px; font-weight: bold; color: hsl(24, 100%, 50%);">Question Time</span></p>
<p>How many rows (or observations) does the object <code>Data_Or3</code> contain? <input class='webex-solveme nospaces' size='3' data-answer='["172"]'/><br>
How many different female names are in <code>Data_Or4</code>? <input class='webex-solveme nospaces' size='1' data-answer='["1"]'/> <br></p>
<p><br></p>
<div class="task">
<p>
<strong>Your turn</strong>
</p>
<p>
Make a tibble called <code>Name_Beat</code> that only shows data from
<code>Name_Data</code> for the <code>names</code> John, Paul, George and
Ringo, and just for <code>sex</code> males.
</p>
</div>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a>Name_Beat <span class="ot">&lt;-</span> <span class="fu">filter</span>(Name_Data, name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;John&quot;</span>, <span class="st">&quot;Paul&quot;</span>, <span class="st">&quot;George&quot;</span>, <span class="st">&quot;Ringo&quot;</span>), sex <span class="sc">==</span> <span class="st">&quot;M&quot;</span>)</span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a><span class="co"># If you have done this correct you should be able to produce a nice simple plot with the code below, to show change in proportional representation of these names over time (don&#39;t worry about what this code means, you&#39;ll learn more about plots later in the course)</span></span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Name_Beat, <span class="fu">aes</span>(year, prop, <span class="at">colour=</span>name)) <span class="sc">+</span> <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="Intro-to-R-GU-Open-Studies-2021-2022_files/figure-html/unnamed-chunk-102-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="mutate" class="section level2 hasAnchor" number="3.6">
<h2 class="hasAnchor"><span class="header-section-number">3.6</span> mutate()<a href="#mutate" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The <code>mutate()</code> function creates new variables (columns) onto the existing object. The first argument to this function is an object from your <code>Global Environment</code> (for example <code>Name_Data</code>) and the subsequent argument is the new column name and what you want it to contain. The following image was downloaded from <a href="https://www.sharpsightlabs.com/blog/mutate-in-r/" class="uri">https://www.sharpsightlabs.com/blog/mutate-in-r/</a></p>
<center>
<img src="images/mutate.png" height= "350">
</center>
<p>Let’s apply this to this to our <code>Name_Data</code> data tibble. Say we wanted to create a new column <code>Decade</code> that shows us the relative decade each observation is taken from. Save this as a new object <code>Name_Ext</code> to the <code>Global Environment</code> rather than overwriting <code>Name_Data</code> so that we can compare <code>Name_Data</code> with the extended <code>Name_Ext</code> later on.</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>Name_Ext <span class="ot">&lt;-</span> <span class="fu">mutate</span>(Name_Data, <span class="at">Decade =</span> <span class="fu">floor</span>(year<span class="sc">/</span><span class="dv">10</span>)<span class="sc">*</span><span class="dv">10</span>)</span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(Name_Ext)</span></code></pre></div>
<pre><code>## Rows: 1,924,665
## Columns: 6
## $ year   &lt;dbl&gt; 1880, 1880, 1880, 1880, 1880, 1880, 1880, 1880, 1880, 1880, 188~
## $ sex    &lt;chr&gt; &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;~
## $ name   &lt;chr&gt; &quot;Mary&quot;, &quot;Anna&quot;, &quot;Emma&quot;, &quot;Elizabeth&quot;, &quot;Minnie&quot;, &quot;Margaret&quot;, &quot;Ida~
## $ n      &lt;int&gt; 7065, 2604, 2003, 1939, 1746, 1578, 1472, 1414, 1320, 1288, 125~
## $ prop   &lt;dbl&gt; 0.07238359, 0.02667896, 0.02052149, 0.01986579, 0.01788843, 0.0~
## $ Decade &lt;dbl&gt; 1880, 1880, 1880, 1880, 1880, 1880, 1880, 1880, 1880, 1880, 188~</code></pre>
<p>As we can see, <code>Name_Ext</code> has one column more than <code>Name_Data</code>. So <code>mutate()</code> took the value in the cells for each row of the variable <code>year</code>, devided it by 10, and using the <code>floor()</code> function, rounds that value down to the nearest whole number, before finally multiplying the result by 10, and adding it to a new column called <code>Decade</code>.</p>
<p>Importantly, new variables will overwrite existing variables if column headings are identical. So if we wanted to halve the values in column <code>Decade</code> and store them in a column <code>Decade</code>, the original <code>Decade</code> would be overwritten. To demonstrate we will try doing this and stroring the output in a new object called <code>Name_Ext2</code>and save that to our <code>Global Environment</code>.</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>Name_Ext2 <span class="ot">&lt;-</span> <span class="fu">mutate</span>(Name_Ext, <span class="at">Decade =</span> Decade<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(Name_Ext2)</span></code></pre></div>
<pre><code>## Rows: 1,924,665
## Columns: 6
## $ year   &lt;dbl&gt; 1880, 1880, 1880, 1880, 1880, 1880, 1880, 1880, 1880, 1880, 188~
## $ sex    &lt;chr&gt; &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;~
## $ name   &lt;chr&gt; &quot;Mary&quot;, &quot;Anna&quot;, &quot;Emma&quot;, &quot;Elizabeth&quot;, &quot;Minnie&quot;, &quot;Margaret&quot;, &quot;Ida~
## $ n      &lt;int&gt; 7065, 2604, 2003, 1939, 1746, 1578, 1472, 1414, 1320, 1288, 125~
## $ prop   &lt;dbl&gt; 0.07238359, 0.02667896, 0.02052149, 0.01986579, 0.01788843, 0.0~
## $ Decade &lt;dbl&gt; 940, 940, 940, 940, 940, 940, 940, 940, 940, 940, 940, 940, 940~</code></pre>
<p>So now, <code>Name_Ext2</code> did not gain a column (it still contains 6 variables), and <code>Decade</code> now has (unhelpfully) half the numeric value of the decade. (As an aside you could prevent yourself from accidentally doing something like this by converting <code>Decade</code> from numeric double type data to character type data, if you had no intention of carrying out any calculations on that variable)</p>
<div class="info">
<p>
The main take-away message here is to always check your data after
manipulation if the outcome is really what you would expected. If you
don’t inspect and accidentally overwrite columns, you would not notice
any difference.
</p>
</div>
<p>You can also use <code>mutate()</code> to drop columns you no longer need, as an alternative to the <code>select()</code> function. This would mean that <code>Name_Ext2</code> is now identical to <code>Name_Data</code>.</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>Name_Ext2 <span class="ot">&lt;-</span> <span class="fu">mutate</span>(Name_Ext2, <span class="at">Decade =</span> <span class="cn">NULL</span>)</span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(Name_Ext2)</span></code></pre></div>
<pre><code>## Rows: 1,924,665
## Columns: 5
## $ year &lt;dbl&gt; 1880, 1880, 1880, 1880, 1880, 1880, 1880, 1880, 1880, 1880, 1880,~
## $ sex  &lt;chr&gt; &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, ~
## $ name &lt;chr&gt; &quot;Mary&quot;, &quot;Anna&quot;, &quot;Emma&quot;, &quot;Elizabeth&quot;, &quot;Minnie&quot;, &quot;Margaret&quot;, &quot;Ida&quot;,~
## $ n    &lt;int&gt; 7065, 2604, 2003, 1939, 1746, 1578, 1472, 1414, 1320, 1288, 1258,~
## $ prop &lt;dbl&gt; 0.07238359, 0.02667896, 0.02052149, 0.01986579, 0.01788843, 0.016~</code></pre>
<p>If you want to add more than 2 columns, you can do that in a single <code>mutate()</code> statement. You can also add variables that are not numerical values, such as <code>character</code> or <code>logical</code>.</p>
<p>Add two columns to <code>Name_Ext</code> and call it <code>Name_Ext3</code>.</p>
<ul>
<li>Column 1 is called <code>MinName</code> and is of datatype <code>logical</code>. It contains a comparison of the value in <code>n</code> with the cut off count of 5 that allows inclusion in the dataset. Values of 5 should read <code>TRUE</code>, all other values <code>FALSE</code>.</li>
<li>Column 2 is called <code>"20thCent"</code> and is of datatype <code>logical</code>. It contains a comparison of the value in <code>years</code> ensuring the value is between 1900 and 1999. Values inside this range should read <code>TRUE</code>, all other values <code>FALSE</code>.</li>
</ul>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a>Name_Ext3 <span class="ot">&lt;-</span> <span class="fu">mutate</span>(Name_Ext, <span class="at">MinName =</span> n <span class="sc">==</span> <span class="dv">5</span>, <span class="st">&quot;20thCent&quot;</span> <span class="ot">=</span> year <span class="sc">&gt;=</span> <span class="dv">1900</span> <span class="sc">&amp;</span> year <span class="sc">&lt;=</span> <span class="dv">1999</span>)</span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(Name_Ext3)</span></code></pre></div>
<pre><code>## Rows: 1,924,665
## Columns: 8
## $ year       &lt;dbl&gt; 1880, 1880, 1880, 1880, 1880, 1880, 1880, 1880, 1880, 1880,~
## $ sex        &lt;chr&gt; &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;,~
## $ name       &lt;chr&gt; &quot;Mary&quot;, &quot;Anna&quot;, &quot;Emma&quot;, &quot;Elizabeth&quot;, &quot;Minnie&quot;, &quot;Margaret&quot;, ~
## $ n          &lt;int&gt; 7065, 2604, 2003, 1939, 1746, 1578, 1472, 1414, 1320, 1288,~
## $ prop       &lt;dbl&gt; 0.07238359, 0.02667896, 0.02052149, 0.01986579, 0.01788843,~
## $ Decade     &lt;dbl&gt; 1880, 1880, 1880, 1880, 1880, 1880, 1880, 1880, 1880, 1880,~
## $ MinName    &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FAL~
## $ `20thCent` &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FAL~</code></pre>
<div class="solved">
<p>
You may have noticed we needed to put the name of our new column
<code>“20thCent”</code> inside quotation marks. This is because that
name would begin with numeric values which R will interpret as numeric
values to be evaluated as code by default, which will then break our
code. By placeing the name within quotation marks this tells R to treat
this as a standard character string instead. It is always best to avoid
creating variables with names that start with a number for this reason,
but if it is necessary this is how you can work around it.
</p>
</div>
<div class="task">
<p>
<strong>Your turn</strong>
</p>
<ul>
<li>
Add a new column to <code>Name_Ext3</code> that is called
<code>Prcnt</code> that gives the percentage each name accounts for of
total names that year. *Hint: <code>prop</code> is that same stat
represented as a proportion.
</li>
</ul>
</div>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a>Name_Ext4 <span class="ot">&lt;-</span> <span class="fu">mutate</span>(Name_Ext3, <span class="at">Prcnt =</span> prop <span class="sc">*</span> <span class="dv">100</span>)</span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(Name_Ext4)</span></code></pre></div>
<pre><code>## Rows: 1,924,665
## Columns: 9
## $ year       &lt;dbl&gt; 1880, 1880, 1880, 1880, 1880, 1880, 1880, 1880, 1880, 1880,~
## $ sex        &lt;chr&gt; &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;, &quot;F&quot;,~
## $ name       &lt;chr&gt; &quot;Mary&quot;, &quot;Anna&quot;, &quot;Emma&quot;, &quot;Elizabeth&quot;, &quot;Minnie&quot;, &quot;Margaret&quot;, ~
## $ n          &lt;int&gt; 7065, 2604, 2003, 1939, 1746, 1578, 1472, 1414, 1320, 1288,~
## $ prop       &lt;dbl&gt; 0.07238359, 0.02667896, 0.02052149, 0.01986579, 0.01788843,~
## $ Decade     &lt;dbl&gt; 1880, 1880, 1880, 1880, 1880, 1880, 1880, 1880, 1880, 1880,~
## $ MinName    &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FAL~
## $ `20thCent` &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FAL~
## $ Prcnt      &lt;dbl&gt; 7.238359, 2.667896, 2.052149, 1.986579, 1.788843, 1.616720,~</code></pre>
</div>
<div id="read-in-second-dataset" class="section level3 hasAnchor" number="3.6.1">
<h3 class="hasAnchor"><span class="header-section-number">3.6.1</span> Read in second dataset<a href="#read-in-second-dataset" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>At this point we are reaching the end of the usefulness of the Babynames dataset (there is only so much you can do with 5 basic variables), and this is a good time to bring in the second dataset we mentioned.</p>
<p>The second dataset, is a set of career and performance statistics of MMA athletes. You need to read the file <code>CareerStats.csv</code> containing your data into your <code>Global Environment</code> using the function <code>read_csv()</code>. Remember to store your data in an appropriately named object (e.g. <code>MMA_Data</code>).</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>MMA_Data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;CareerStats.csv&quot;</span>)</span></code></pre></div>
<pre><code>## Rows: 199 Columns: 32
## -- Column specification --------------------------------------------------------
## Delimiter: &quot;,&quot;
## chr  (5): ID, HeightClass, ReachClass, Stance, WeightClass
## dbl (27): Age, Height, Weight, BMI, Reach, T_Wins, T_Losses, T_Fights, Succe...
## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="info">
<p>
As you can see this dataset has a lot more variables, which should
make for more interesting ways of manipulating the data.
</p>
</div>
</div>
</div>
<div id="summarise" class="section level2 hasAnchor" number="3.7">
<h2 class="hasAnchor"><span class="header-section-number">3.7</span> summarise()<a href="#summarise" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In order to compute summary statistics such as mean, median and standard deviation, use the <code>summarise()</code> function. This function creates a new tibble of your desired summary statistics. The first argument to this function is the data you are interested in summarising; in this case the object <code>MMA_Data</code>, and the subsequent argument is the new column name and what mathematical operation you want it to contain. You can add as many summary statistics in one <code>summarise()</code> function as you want; just separate them by a comma.</p>
<div class="info">
<p>
You can use the help function to find out more about the kind of
summary stats you can extract.
</p>
<p>
Some of the most useful however are: <code>sum()</code> - sum total
<code>n()</code> - count of observations <code>n_distinct()</code> -
count of distinct (unique) observations <code>mean()</code> - measure of
central tendency; mean <code>median()</code> - measure of central
tendency; median <code>sd()</code> - standard deviation
<code>IQR()</code> - interquartile range <code>min()</code> - the
maximum available value in observations <code>max()</code> - the minimum
available value in observations
</p>
</div>
<p>Lets start generating some summary stats. For example, say you want to work out the average number of total fights (<code>T_Fights</code>) among the athletes and accompanying standard deviation for the entire sample:</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summarise</span>(MMA_Data, <span class="at">Avg_Mean =</span> <span class="fu">mean</span>(T_Fights), <span class="at">SD =</span> <span class="fu">sd</span>(T_Fights))</span></code></pre></div>
<pre><code>## # A tibble: 1 x 2
##   Avg_Mean    SD
##      &lt;dbl&gt; &lt;dbl&gt;
## 1     23.0  9.80</code></pre>
<p>Therefore, the average number of total fights for all the athletes in our sample is 22.98, with a standard deviation of 9.8.</p>
<p>Let’s try another. what is the maximum and minimum hights for the entire sample?</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summarise</span>(MMA_Data, <span class="at">Minimum =</span> <span class="fu">min</span>(Height), <span class="at">Maximum =</span> <span class="fu">max</span>(Height))</span></code></pre></div>
<pre><code>## # A tibble: 1 x 2
##   Minimum Maximum
##     &lt;dbl&gt;   &lt;dbl&gt;
## 1      63      83</code></pre>
<p>Or maybe we want to know how many different (distinct) weightclasses are there in our dataset?</p>
<p>How would we check that?</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summarise</span>(MMA_Data, <span class="at">WeightClasses =</span> <span class="fu">n_distinct</span>(WeightClass))</span></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##   WeightClasses
##           &lt;int&gt;
## 1             8</code></pre>
</div>
<div id="adding-group_by" class="section level2 hasAnchor" number="3.8">
<h2 class="hasAnchor"><span class="header-section-number">3.8</span> Adding group_by()<a href="#adding-group_by" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now that’s all well and good, but in research we are most often interested in drawing comparisons and analysing differences (Between different groups of people, between different treatment types, between different countries etc.).</p>
<p>This is where the <code>group_by()</code> function comes in handy. It can organise observations (rows) by variables (columns), thereby spliting the data up into subsets that can be analysed independently. The first argument to this function is the data you wish to organise, in this case <code>MMA_Data</code> and the subsequent argument is your chosen grouping variable you want to organise by (e.g. group by). Here we are grouping by weightclass, and saving this as a new object <code>MMA_G_Weight</code>;</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a>MMA_G_Weight <span class="ot">&lt;-</span> <span class="fu">group_by</span>(MMA_Data, WeightClass)</span></code></pre></div>
<p>If you view the object <code>MMA_G_Class</code>, it will not look any different to the original dataset (<code>MMA_Data</code>). However, be aware that the underlying structure has changed. In fact, you could use <code>glimpse()</code> to double check this.</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(MMA_G_Weight)</span></code></pre></div>
<pre><code>## Rows: 199
## Columns: 32
## Groups: WeightClass [8]
## $ ID            &lt;chr&gt; &quot;056c493bbd76a918&quot;, &quot;b102c26727306ab6&quot;, &quot;80eacd4da0617c5~
## $ Age           &lt;dbl&gt; 31.88, 33.70, 34.41, 25.39, 31.02, 34.77, 33.97, 28.70, ~
## $ Height        &lt;dbl&gt; 64, 65, 64, 64, 65, 66, 64, 65, 65, 66, 67, 65, 68, 65, ~
## $ HeightClass   &lt;chr&gt; &quot;Short&quot;, &quot;Short&quot;, &quot;Short&quot;, &quot;Short&quot;, &quot;Short&quot;, &quot;Average&quot;, ~
## $ Weight        &lt;dbl&gt; 125, 125, 125, 125, 125, 125, 125, 125, 125, 125, 135, 1~
## $ BMI           &lt;dbl&gt; 21.454, 20.799, 21.454, 21.454, 20.799, 20.173, 21.454, ~
## $ Reach         &lt;dbl&gt; 64, 67, 65, 63, 68, 66, 65, 67, 65, 65, 66, 65, 70, 68, ~
## $ ReachClass    &lt;chr&gt; &quot;Below&quot;, &quot;Below&quot;, &quot;Below&quot;, &quot;Below&quot;, &quot;Below&quot;, &quot;Below&quot;, &quot;B~
## $ Stance        &lt;chr&gt; &quot;Orthodox&quot;, &quot;Orthodox&quot;, &quot;Southpaw&quot;, &quot;Orthodox&quot;, &quot;Orthodo~
## $ WeightClass   &lt;chr&gt; &quot;Flywieght&quot;, &quot;Flywieght&quot;, &quot;Flywieght&quot;, &quot;Flywieght&quot;, &quot;Fly~
## $ T_Wins        &lt;dbl&gt; 13, 22, 26, 11, 15, 19, 23, 20, 19, 21, 15, 14, 12, 10, ~
## $ T_Losses      &lt;dbl&gt; 2, 5, 5, 3, 0, 7, 9, 3, 7, 5, 8, 1, 1, 5, 5, 4, 5, 2, 2,~
## $ T_Fights      &lt;dbl&gt; 15, 27, 31, 14, 15, 26, 32, 23, 26, 26, 24, 15, 13, 15, ~
## $ Success       &lt;dbl&gt; 0.867, 0.815, 0.839, 0.786, 1.000, 0.731, 0.719, 0.870, ~
## $ W_by_Decision &lt;dbl&gt; 8, 12, 10, 4, 2, 8, 13, 6, 7, 11, 6, 7, 7, 1, 5, 3, 3, 5~
## $ `W_by_KO/TKO` &lt;dbl&gt; 5, 10, 7, 1, 8, 8, 0, 6, 8, 4, 3, 2, 2, 8, 2, 2, 1, 4, 2~
## $ W_by_Sub      &lt;dbl&gt; 0, 0, 9, 6, 5, 3, 10, 8, 4, 6, 6, 5, 3, 1, 5, 6, 10, 4, ~
## $ L_by_Decision &lt;dbl&gt; 1, 3, 4, 2, 0, 4, 5, 3, 6, 1, 4, 0, 1, 3, 5, 1, 5, 0, 1,~
## $ `L_by_KO/TKO` &lt;dbl&gt; 1, 2, 1, 0, 0, 2, 3, 0, 0, 1, 1, 1, 0, 0, 0, 2, 0, 2, 1,~
## $ L_by_Sub      &lt;dbl&gt; 0, 0, 0, 1, 0, 1, 1, 0, 1, 3, 3, 0, 0, 2, 0, 1, 0, 0, 0,~
## $ PWDec         &lt;dbl&gt; 0.533, 0.444, 0.323, 0.286, 0.133, 0.308, 0.406, 0.261, ~
## $ PWTko         &lt;dbl&gt; 0.333, 0.370, 0.226, 0.071, 0.533, 0.308, 0.000, 0.261, ~
## $ PWSub         &lt;dbl&gt; 0.000, 0.000, 0.290, 0.429, 0.333, 0.115, 0.312, 0.348, ~
## $ PLDec         &lt;dbl&gt; 0.067, 0.111, 0.129, 0.143, 0.000, 0.154, 0.156, 0.130, ~
## $ PLTko         &lt;dbl&gt; 0.067, 0.074, 0.032, 0.000, 0.000, 0.077, 0.094, 0.000, ~
## $ PLSub         &lt;dbl&gt; 0.000, 0.000, 0.000, 0.071, 0.000, 0.038, 0.031, 0.000, ~
## $ Available     &lt;dbl&gt; 9, 12, 24, 8, 4, 14, 12, 5, 15, 4, 10, 2, 1, 6, 5, 4, 5,~
## $ TTime         &lt;dbl&gt; 123.234, 137.034, 278.699, 113.466, 42.700, 168.316, 145~
## $ Time_Avg      &lt;dbl&gt; 13.693, 11.419, 11.612, 14.183, 10.675, 12.023, 12.127, ~
## $ TLpM          &lt;dbl&gt; 5.461, 3.196, 4.410, 2.732, 3.115, 3.624, 3.828, 5.851, ~
## $ AbpM          &lt;dbl&gt; 2.605, 2.167, 2.515, 1.921, 1.616, 2.549, 2.948, 3.377, ~
## $ SubAtt_Avg    &lt;dbl&gt; 0.122, 0.657, 0.700, 1.454, 3.864, 1.069, 0.618, 1.755, ~</code></pre>
<p>You can now feed this grouped dataset (<code>MMA_G_Weight</code>) into the previous code line to obtain summary statistics by <code>WeightClass</code>, the code for finding summary statistics of average number of total fights, has been provided.:</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>Sum_Fights <span class="ot">&lt;-</span> <span class="fu">summarise</span>(MMA_G_Weight, <span class="at">Avg_Mean =</span> <span class="fu">mean</span>(T_Fights), <span class="at">SD =</span> <span class="fu">sd</span>(T_Fights))</span></code></pre></div>
<p><span style="font-size: 22px; font-weight: bold; color: hsl(24, 100%, 50%);">Question Time</span></p>
<p>Which weightclass has the highest maximum height? <input class='webex-solveme nospaces' size='11' data-answer='["Heavyweight"]'/></p>
<div class="task">
<p>
<strong>Your turn</strong>
</p>
<ul>
<li>
Try to fill out the code for finding summary stats of minimum and
maximum height by <code>WeightClass</code>:
</li>
</ul>
</div>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a>Sum_Height <span class="ot">&lt;-</span> <span class="fu">summarise</span>(MMA_G_Weight, <span class="at">Minimum =</span> <span class="fu">min</span>(Height), <span class="at">Maximum =</span> <span class="fu">max</span>(Height))</span></code></pre></div>
</div>
<div class="info">
<p>
You can technically group by any variable! For example, there is
nothing stopping you from grouping by a continuous variable like age or
height. R will allow you to group by a numerical variable that is type
double, the code will run.
</p>
<p>
However you probably want to be more careful in choosing a
categorical variable as grouping criteria. These will usually be
character, or interger or even logical data types. However interger data
type might also actually represent a continuous variable (but might have
only been recorded in whole numbers), and a variable that is character
type may not represent a useful category (like idividual ID’s for
example).
</p>
<p>
The point is R does not know what your dataset is actually about, and
what your variables are meant to represent… R has no idea if your
variable <em>should</em> be categorical or not. So it’s up to you to
know what are sensible variables to use in the <code>group_by()</code>
function.
</p>
</div>
<p>You might also want to calculate and display the number of individuals from your dataset that are in different groups. This can be achieved by adding the summary function <code>n()</code> once you have grouped your data. the function <code>n()</code>, simply counts the number of observations and takes no arguments. Here we will group by <code>Stance</code> and count the number of athelets in each category:</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a>MMA_G_Stance <span class="ot">&lt;-</span> <span class="fu">group_by</span>(MMA_Data, Stance)</span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true" tabindex="-1"></a>Stance_Ns <span class="ot">&lt;-</span> <span class="fu">summarise</span>(MMA_G_Stance, <span class="at">N =</span> <span class="fu">n</span>())</span>
<span id="cb175-4"><a href="#cb175-4" aria-hidden="true" tabindex="-1"></a>Stance_Ns</span></code></pre></div>
<pre><code>## # A tibble: 3 x 2
##   Stance       N
##   &lt;chr&gt;    &lt;int&gt;
## 1 Orthodox   140
## 2 Southpaw    45
## 3 Switch      14</code></pre>
<p><span style="font-size: 22px; font-weight: bold; color: hsl(24, 100%, 50%);">Question Time</span></p>
<p>How many athletes in the dataset have a Southpaw stance? <input class='webex-solveme nospaces' size='2' data-answer='["45"]'/> <br>
How many athletes in the dataset have an Orthodox stance? <input class='webex-solveme nospaces' size='3' data-answer='["140"]'/></p>
<p>Finally, it is possible to add multiple grouping variables. For example, the following code groups <code>MMA_Data</code> by <code>ReachClass</code> and <code>Stance</code> and then calculates the mean and standard deviation of average number of strikes landed per minute (<code>TLpM</code>) for each group (6 groups).</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a>MMA_G_RS <span class="ot">&lt;-</span> <span class="fu">group_by</span>(MMA_Data, ReachClass, Stance)</span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a>MMA_LpM <span class="ot">&lt;-</span> <span class="fu">summarise</span>(MMA_G_RS, <span class="at">Mean =</span> <span class="fu">mean</span>(TLpM), <span class="at">SD =</span> <span class="fu">sd</span>(TLpM))</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;ReachClass&#39;. You can override using the
## `.groups` argument.</code></pre>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a>MMA_LpM</span></code></pre></div>
<pre><code>## # A tibble: 6 x 4
## # Groups:   ReachClass [2]
##   ReachClass Stance    Mean    SD
##   &lt;chr&gt;      &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt;
## 1 Above      Orthodox  5.44  1.66
## 2 Above      Southpaw  4.68  1.16
## 3 Above      Switch    5.92  1.29
## 4 Below      Orthodox  5.33  1.60
## 5 Below      Southpaw  5.02  1.47
## 6 Below      Switch    5.95  3.63</code></pre>
<p>So far we have not had to calculate any summary statistics with any missing values, denoted by <code>NA</code> in R. Missing values are always a bit of a hassle to deal with. Any computation you do that involves <code>NA</code> returns an <code>NA</code> - which translates as “you will not get a numeric result when your column contains missing values”. Missing values can be removed by adding the argument <code>na.rm = TRUE</code> to calculation functions like <code>mean()</code>, <code>median()</code> or <code>sd()</code>. For example, lets try to calulate a mean where we have some missing values:</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a>Weight_Reach <span class="ot">&lt;-</span> <span class="fu">summarise</span>(MMA_G_Weight, <span class="at">Avg_Reach =</span> <span class="fu">mean</span>(Reach))</span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a>Weight_Reach</span></code></pre></div>
<pre><code>## # A tibble: 8 x 2
##   WeightClass      Avg_Reach
##   &lt;chr&gt;                &lt;dbl&gt;
## 1 Bantamweight          67.8
## 2 Fetherweight          71.0
## 3 Flywieght             66.9
## 4 Heavyweight           NA  
## 5 LightHeavyweight      76.9
## 6 Lightweight           72.6
## 7 Middleweight          NA  
## 8 Welterweight          74</code></pre>
<p>The code runs without error, however you will notice we have a few stats missing (<code>NA</code>). Now lets tell R to remove any missing values when making its calculation.</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a>Weight_Reach <span class="ot">&lt;-</span> <span class="fu">summarise</span>(MMA_G_Weight, <span class="at">Avg_Reach =</span> <span class="fu">mean</span>(Reach, <span class="at">na.rm =</span> T))</span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a>Weight_Reach</span></code></pre></div>
<pre><code>## # A tibble: 8 x 2
##   WeightClass      Avg_Reach
##   &lt;chr&gt;                &lt;dbl&gt;
## 1 Bantamweight          67.8
## 2 Fetherweight          71.0
## 3 Flywieght             66.9
## 4 Heavyweight           78.0
## 5 LightHeavyweight      76.9
## 6 Lightweight           72.6
## 7 Middleweight          75.4
## 8 Welterweight          74</code></pre>
<div class="info">
<p>
Finally… If you need to return the data to a non-grouped form, use
the <code>ungroup()</code> function.
</p>
</div>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a>MMA_Data <span class="ot">&lt;-</span> <span class="fu">group_by</span>(MMA_Data, BMI)</span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(MMA_Data)</span></code></pre></div>
<pre><code>## Rows: 199
## Columns: 32
## Groups: BMI [70]
## $ ID            &lt;chr&gt; &quot;056c493bbd76a918&quot;, &quot;b102c26727306ab6&quot;, &quot;80eacd4da0617c5~
## $ Age           &lt;dbl&gt; 31.88, 33.70, 34.41, 25.39, 31.02, 34.77, 33.97, 28.70, ~
## $ Height        &lt;dbl&gt; 64, 65, 64, 64, 65, 66, 64, 65, 65, 66, 67, 65, 68, 65, ~
## $ HeightClass   &lt;chr&gt; &quot;Short&quot;, &quot;Short&quot;, &quot;Short&quot;, &quot;Short&quot;, &quot;Short&quot;, &quot;Average&quot;, ~
## $ Weight        &lt;dbl&gt; 125, 125, 125, 125, 125, 125, 125, 125, 125, 125, 135, 1~
## $ BMI           &lt;dbl&gt; 21.454, 20.799, 21.454, 21.454, 20.799, 20.173, 21.454, ~
## $ Reach         &lt;dbl&gt; 64, 67, 65, 63, 68, 66, 65, 67, 65, 65, 66, 65, 70, 68, ~
## $ ReachClass    &lt;chr&gt; &quot;Below&quot;, &quot;Below&quot;, &quot;Below&quot;, &quot;Below&quot;, &quot;Below&quot;, &quot;Below&quot;, &quot;B~
## $ Stance        &lt;chr&gt; &quot;Orthodox&quot;, &quot;Orthodox&quot;, &quot;Southpaw&quot;, &quot;Orthodox&quot;, &quot;Orthodo~
## $ WeightClass   &lt;chr&gt; &quot;Flywieght&quot;, &quot;Flywieght&quot;, &quot;Flywieght&quot;, &quot;Flywieght&quot;, &quot;Fly~
## $ T_Wins        &lt;dbl&gt; 13, 22, 26, 11, 15, 19, 23, 20, 19, 21, 15, 14, 12, 10, ~
## $ T_Losses      &lt;dbl&gt; 2, 5, 5, 3, 0, 7, 9, 3, 7, 5, 8, 1, 1, 5, 5, 4, 5, 2, 2,~
## $ T_Fights      &lt;dbl&gt; 15, 27, 31, 14, 15, 26, 32, 23, 26, 26, 24, 15, 13, 15, ~
## $ Success       &lt;dbl&gt; 0.867, 0.815, 0.839, 0.786, 1.000, 0.731, 0.719, 0.870, ~
## $ W_by_Decision &lt;dbl&gt; 8, 12, 10, 4, 2, 8, 13, 6, 7, 11, 6, 7, 7, 1, 5, 3, 3, 5~
## $ `W_by_KO/TKO` &lt;dbl&gt; 5, 10, 7, 1, 8, 8, 0, 6, 8, 4, 3, 2, 2, 8, 2, 2, 1, 4, 2~
## $ W_by_Sub      &lt;dbl&gt; 0, 0, 9, 6, 5, 3, 10, 8, 4, 6, 6, 5, 3, 1, 5, 6, 10, 4, ~
## $ L_by_Decision &lt;dbl&gt; 1, 3, 4, 2, 0, 4, 5, 3, 6, 1, 4, 0, 1, 3, 5, 1, 5, 0, 1,~
## $ `L_by_KO/TKO` &lt;dbl&gt; 1, 2, 1, 0, 0, 2, 3, 0, 0, 1, 1, 1, 0, 0, 0, 2, 0, 2, 1,~
## $ L_by_Sub      &lt;dbl&gt; 0, 0, 0, 1, 0, 1, 1, 0, 1, 3, 3, 0, 0, 2, 0, 1, 0, 0, 0,~
## $ PWDec         &lt;dbl&gt; 0.533, 0.444, 0.323, 0.286, 0.133, 0.308, 0.406, 0.261, ~
## $ PWTko         &lt;dbl&gt; 0.333, 0.370, 0.226, 0.071, 0.533, 0.308, 0.000, 0.261, ~
## $ PWSub         &lt;dbl&gt; 0.000, 0.000, 0.290, 0.429, 0.333, 0.115, 0.312, 0.348, ~
## $ PLDec         &lt;dbl&gt; 0.067, 0.111, 0.129, 0.143, 0.000, 0.154, 0.156, 0.130, ~
## $ PLTko         &lt;dbl&gt; 0.067, 0.074, 0.032, 0.000, 0.000, 0.077, 0.094, 0.000, ~
## $ PLSub         &lt;dbl&gt; 0.000, 0.000, 0.000, 0.071, 0.000, 0.038, 0.031, 0.000, ~
## $ Available     &lt;dbl&gt; 9, 12, 24, 8, 4, 14, 12, 5, 15, 4, 10, 2, 1, 6, 5, 4, 5,~
## $ TTime         &lt;dbl&gt; 123.234, 137.034, 278.699, 113.466, 42.700, 168.316, 145~
## $ Time_Avg      &lt;dbl&gt; 13.693, 11.419, 11.612, 14.183, 10.675, 12.023, 12.127, ~
## $ TLpM          &lt;dbl&gt; 5.461, 3.196, 4.410, 2.732, 3.115, 3.624, 3.828, 5.851, ~
## $ AbpM          &lt;dbl&gt; 2.605, 2.167, 2.515, 1.921, 1.616, 2.549, 2.948, 3.377, ~
## $ SubAtt_Avg    &lt;dbl&gt; 0.122, 0.657, 0.700, 1.454, 3.864, 1.069, 0.618, 1.755, ~</code></pre>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a>MMA_Data <span class="ot">&lt;-</span> <span class="fu">ungroup</span>(MMA_Data)</span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(MMA_Data)</span></code></pre></div>
<pre><code>## Rows: 199
## Columns: 32
## $ ID            &lt;chr&gt; &quot;056c493bbd76a918&quot;, &quot;b102c26727306ab6&quot;, &quot;80eacd4da0617c5~
## $ Age           &lt;dbl&gt; 31.88, 33.70, 34.41, 25.39, 31.02, 34.77, 33.97, 28.70, ~
## $ Height        &lt;dbl&gt; 64, 65, 64, 64, 65, 66, 64, 65, 65, 66, 67, 65, 68, 65, ~
## $ HeightClass   &lt;chr&gt; &quot;Short&quot;, &quot;Short&quot;, &quot;Short&quot;, &quot;Short&quot;, &quot;Short&quot;, &quot;Average&quot;, ~
## $ Weight        &lt;dbl&gt; 125, 125, 125, 125, 125, 125, 125, 125, 125, 125, 135, 1~
## $ BMI           &lt;dbl&gt; 21.454, 20.799, 21.454, 21.454, 20.799, 20.173, 21.454, ~
## $ Reach         &lt;dbl&gt; 64, 67, 65, 63, 68, 66, 65, 67, 65, 65, 66, 65, 70, 68, ~
## $ ReachClass    &lt;chr&gt; &quot;Below&quot;, &quot;Below&quot;, &quot;Below&quot;, &quot;Below&quot;, &quot;Below&quot;, &quot;Below&quot;, &quot;B~
## $ Stance        &lt;chr&gt; &quot;Orthodox&quot;, &quot;Orthodox&quot;, &quot;Southpaw&quot;, &quot;Orthodox&quot;, &quot;Orthodo~
## $ WeightClass   &lt;chr&gt; &quot;Flywieght&quot;, &quot;Flywieght&quot;, &quot;Flywieght&quot;, &quot;Flywieght&quot;, &quot;Fly~
## $ T_Wins        &lt;dbl&gt; 13, 22, 26, 11, 15, 19, 23, 20, 19, 21, 15, 14, 12, 10, ~
## $ T_Losses      &lt;dbl&gt; 2, 5, 5, 3, 0, 7, 9, 3, 7, 5, 8, 1, 1, 5, 5, 4, 5, 2, 2,~
## $ T_Fights      &lt;dbl&gt; 15, 27, 31, 14, 15, 26, 32, 23, 26, 26, 24, 15, 13, 15, ~
## $ Success       &lt;dbl&gt; 0.867, 0.815, 0.839, 0.786, 1.000, 0.731, 0.719, 0.870, ~
## $ W_by_Decision &lt;dbl&gt; 8, 12, 10, 4, 2, 8, 13, 6, 7, 11, 6, 7, 7, 1, 5, 3, 3, 5~
## $ `W_by_KO/TKO` &lt;dbl&gt; 5, 10, 7, 1, 8, 8, 0, 6, 8, 4, 3, 2, 2, 8, 2, 2, 1, 4, 2~
## $ W_by_Sub      &lt;dbl&gt; 0, 0, 9, 6, 5, 3, 10, 8, 4, 6, 6, 5, 3, 1, 5, 6, 10, 4, ~
## $ L_by_Decision &lt;dbl&gt; 1, 3, 4, 2, 0, 4, 5, 3, 6, 1, 4, 0, 1, 3, 5, 1, 5, 0, 1,~
## $ `L_by_KO/TKO` &lt;dbl&gt; 1, 2, 1, 0, 0, 2, 3, 0, 0, 1, 1, 1, 0, 0, 0, 2, 0, 2, 1,~
## $ L_by_Sub      &lt;dbl&gt; 0, 0, 0, 1, 0, 1, 1, 0, 1, 3, 3, 0, 0, 2, 0, 1, 0, 0, 0,~
## $ PWDec         &lt;dbl&gt; 0.533, 0.444, 0.323, 0.286, 0.133, 0.308, 0.406, 0.261, ~
## $ PWTko         &lt;dbl&gt; 0.333, 0.370, 0.226, 0.071, 0.533, 0.308, 0.000, 0.261, ~
## $ PWSub         &lt;dbl&gt; 0.000, 0.000, 0.290, 0.429, 0.333, 0.115, 0.312, 0.348, ~
## $ PLDec         &lt;dbl&gt; 0.067, 0.111, 0.129, 0.143, 0.000, 0.154, 0.156, 0.130, ~
## $ PLTko         &lt;dbl&gt; 0.067, 0.074, 0.032, 0.000, 0.000, 0.077, 0.094, 0.000, ~
## $ PLSub         &lt;dbl&gt; 0.000, 0.000, 0.000, 0.071, 0.000, 0.038, 0.031, 0.000, ~
## $ Available     &lt;dbl&gt; 9, 12, 24, 8, 4, 14, 12, 5, 15, 4, 10, 2, 1, 6, 5, 4, 5,~
## $ TTime         &lt;dbl&gt; 123.234, 137.034, 278.699, 113.466, 42.700, 168.316, 145~
## $ Time_Avg      &lt;dbl&gt; 13.693, 11.419, 11.612, 14.183, 10.675, 12.023, 12.127, ~
## $ TLpM          &lt;dbl&gt; 5.461, 3.196, 4.410, 2.732, 3.115, 3.624, 3.828, 5.851, ~
## $ AbpM          &lt;dbl&gt; 2.605, 2.167, 2.515, 1.921, 1.616, 2.549, 2.948, 3.377, ~
## $ SubAtt_Avg    &lt;dbl&gt; 0.122, 0.657, 0.700, 1.454, 3.864, 1.069, 0.618, 1.755, ~</code></pre>
</div>
<div id="formative-homework-1" class="section level2 hasAnchor" number="3.9">
<h2 class="hasAnchor"><span class="header-section-number">3.9</span> Formative Homework<a href="#formative-homework-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The folder for the formative assessment can now be downloaded from moodle.</p>
<ol style="list-style-type: decimal">
<li>Load <code>tidyverse</code> into the library.</li>
<li>Read the data from <code>TraitJudgementData.csv</code> into your <code>Global Environment</code> as an object called <code>traits_data</code>.</li>
<li>Look at the data. Familiarise yourself with the data (see next section, and the paper in the folder), as well as the datatypes of each column.</li>
</ol>
<div id="brief-introduction-to-the-homework-data" class="section level3 hasAnchor" number="3.9.1">
<h3 class="hasAnchor"><span class="header-section-number">3.9.1</span> Brief introduction to the homework data<a href="#brief-introduction-to-the-homework-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For the homework assignments each week, we will be using an open access dataset into how personality is determined from voices. A full version of the paper can be found <a href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0204991" class="uri">https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0204991</a>. All data and sounds are available on OSF (osf.io/s3cxy).</p>
<p>However, for your assignment this week, all files necessary are compiled in a folder to download from moodle.</p>
<p>The data in the <code>TraitJudgementData.csv</code> has ratings on 3 different personality traits (Trustworthiness, Dominance, and Attractiveness) for 30 male and 30 female voice stimuli. In total, 181 participants rated either male <em>OR</em> female speakers on <em>ONE</em> personality trait (e.g. Trustworthiness) only. The speakers were judged after saying a socially relevant word (“Hello”), a socially ambiguous word (“Colors”), a socially relevant sentence (“I urge you to submit your essay by the end of the week”), and a socially ambiguous sentence (“Some have accepted it as a miracle without physical explanation”). Socially relevant stimuli were meant to address the listener, whereas socially ambiguous stimuli were intended to not be directed towards the listener. Each participant rated all the voice stimuli twice in all four conditions (socially relevant words (RW), socially relevant sentences (RS), socially ambiguous words (AW), and socially ambiguous sentences (AS)). The experiment was conducted online.</p>
<p>Here is a brief summary overview of the columns in the <code>TraitJudgementData.csv</code>.</p>
<table>
<colgroup>
<col width="18%" />
<col width="81%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">column name</th>
<th align="left">description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">PP_ID</td>
<td align="left">Participant’s ID</td>
</tr>
<tr class="even">
<td align="left">PP_Age</td>
<td align="left">Participant’s Age</td>
</tr>
<tr class="odd">
<td align="left">PP_Sex</td>
<td align="left">Participant’s Sex (“female”, “male”)</td>
</tr>
<tr class="even">
<td align="left">Nationality</td>
<td align="left">Participant’s Nationality</td>
</tr>
<tr class="odd">
<td align="left">Trait</td>
<td align="left">Personality Trait participant judged the vocal stimuli on (“Trustworthiness”, “Dominance”, “Attractiveness”)</td>
</tr>
<tr class="even">
<td align="left">Voice</td>
<td align="left">Speaker’s ID</td>
</tr>
<tr class="odd">
<td align="left">Voice_Sex</td>
<td align="left">Speaker’s Sex (“Female”, “Male”)</td>
</tr>
<tr class="even">
<td align="left">Condition</td>
<td align="left">Speaker’s recording of socially relevant words (“RW”), socially relevant sentences (“RS”), socially ambiguous words (“AW”), and socially ambiguous sentences (“AS”)</td>
</tr>
<tr class="odd">
<td align="left">Rating</td>
<td align="left">Participants rated each <code>Voice</code> in each <code>Condition</code> twice (“Rating1”, “Rating2”)</td>
</tr>
<tr class="even">
<td align="left">Response</td>
<td align="left">Participant’s <code>Trait</code> judgements on a scale from 1 - 500</td>
</tr>
<tr class="odd">
<td align="left">Reaction</td>
<td align="left">Participant’s Reaction Time</td>
</tr>
</tbody>
</table>
<!--chapter:end:03-dplyr_1.Rmd-->
</div>
</div>
</div>
<div id="data-transformation-2-more-one-and-two-table-verbs" class="section level1 hasAnchor" number="4">
<h1 class="hasAnchor"><span class="header-section-number">4</span> Data Transformation 2: More One and Two Table Verbs<a href="#data-transformation-2-more-one-and-two-table-verbs" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="intended-learning-outcomes-4" class="section level2 unnumbered hasAnchor">
<h2 class="unnumbered hasAnchor">Intended Learning Outcomes<a href="#intended-learning-outcomes-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li>Become comfortable with the Wickham Six dplyr one-table verbs:</li>
</ol>
<ul>
<li><code>select()</code></li>
<li><code>arrange()</code></li>
<li><code>filter()</code></li>
<li><code>mutate()</code></li>
<li><code>group_by()</code></li>
<li><code>summarise()</code></li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li><p>Be able to chain functions together using the pipe operator (<code>%&gt;%</code>)</p></li>
<li><p>Be able to use the following dplyr two-table verbs:</p></li>
</ol>
<ul>
<li>Mutating joins: <code>left_join()</code>, <code>right_join()</code>, <code>full_join()</code>, <code>inner_join()</code></li>
<li>Binding joins: <code>bind_rows()</code>, <code>bind_cols()</code></li>
</ul>
<p>This lesson is led by Johanna Werner.</p>
</div>
<div id="pre-steps-2" class="section level2 hasAnchor" number="4.1">
<h2 class="hasAnchor"><span class="header-section-number">4.1</span> Pre-Steps<a href="#pre-steps-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li>Make sure to download todays materials and save them to your desired working directory. Make sure you have all the correct files including the <code>L4_Stub</code> file, and the data files; <code>CareerStats2.csv</code>, <code>wos_seasonal_sun.csv</code>, <code>wos_seasonal_rain.csv</code>, <code>wos_monthly_sun.csv</code> and <code>wos_monthly_rain.csv</code>.</li>
<li>Open the <code>L4_stub</code> file.</li>
<li>Load <code>tidyverse</code> into the library.</li>
<li>Read the data from <code>CareerStats2.csv</code> into your <code>Global Environment</code> as <code>MMA_Data</code>.</li>
</ol>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a>MMA_Data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;CareerStats2.csv&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="practicing-the-wikham-six" class="section level2 hasAnchor" number="4.2">
<h2 class="hasAnchor"><span class="header-section-number">4.2</span> Practicing the Wikham Six<a href="#practicing-the-wikham-six" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The first part of todays class will be practicing the Wickham Six some more, as was mentioned before, the vast majority of your “data time” will be wrangling your data, and most of that can be done with these six functions, so it’s good to practice with them. First you’ll see an example of each function to refresh your memory. Then you will be asked to try for yourself, these will be a little more involved than last week to really test you. If you are stuggling you can check the solutions, but try yourself first, and answer the questions too, this will help you check your code is correct.</p>
<div id="select-1" class="section level3 hasAnchor" number="4.2.1">
<h3 class="hasAnchor"><span class="header-section-number">4.2.1</span> select()<a href="#select-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>First up lets try to narrow down this big data set, by taking <code>MMA_Data</code>, and selecting only the variables; <code>ID</code>, <code>Height</code>, <code>Weight</code>, <code>BMI</code>, <code>Reach</code> and <code>Stance</code>. We will store this in <code>Example_1</code>.</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a>Example_1 <span class="ot">&lt;-</span> <span class="fu">select</span>(MMA_Data, ID, Height, Weight<span class="sc">:</span>Reach, Stance)</span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a>Example_1</span></code></pre></div>
<pre><code>## # A tibble: 199 x 6
##    ID               Height Weight   BMI Reach Stance  
##    &lt;chr&gt;             &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;   
##  1 056c493bbd76a918     64    125  21.5    64 Orthodox
##  2 b102c26727306ab6     65    125  20.8    67 Orthodox
##  3 80eacd4da0617c57     64    125  21.5    65 Southpaw
##  4 a4de54ea806fb525     64    125  21.5    63 Orthodox
##  5 aa72b0f831d0bfe5     65    125  20.8    68 Orthodox
##  6 92437c6775b3f7d1     66    125  20.2    66 Orthodox
##  7 5aedf14771ca82d2     64    125  21.5    65 Southpaw
##  8 a0f0004aadf10b71     65    125  20.8    67 Orthodox
##  9 f53c1f4ceeed8c08     65    125  20.8    65 Orthodox
## 10 ab2b4ff41d6ebe0f     66    125  20.2    65 Orthodox
## # ... with 189 more rows</code></pre>
<div class="info">
<p>
Notice, this could also have been written as follows;
<code>Example_1 &lt;- select(MMA_Data, ID, Height, Weight, BMI, Reach, Stance)</code>
</p>
<p>
We can use the <code>:</code> operator to sequence together columns
that are next to each other in the original dataframe, this can save
time but it is not necessary.
</p>
</div>
<p><span style="font-size: 22px; font-weight: bold; color: hsl(24, 100%, 50%);">Question Time</span></p>
<div class="task">
<p>
<strong>Your turn</strong>
</p>
<p>
Using <code>select()</code> keep everything from
<code>Example_1</code> but except <code>Reach</code>, and store this in
an object names <code>Q1</code>.
</p>
</div>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Jaimie&#39;s solutions</span></span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a>Q1 <span class="ot">&lt;-</span> <span class="fu">select</span>(Example_1, <span class="sc">-</span>Reach)</span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a><span class="co">#OR</span></span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true" tabindex="-1"></a>Q1 <span class="ot">&lt;-</span> <span class="fu">select</span>(Example_1, ID, Height, Weight, BMI, Stance)</span></code></pre></div>
</div>
</div>
<div id="arrange-1" class="section level3 hasAnchor" number="4.2.2">
<h3 class="hasAnchor"><span class="header-section-number">4.2.2</span> arrange()<a href="#arrange-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Lets move on to <code>arrange()</code>; lets take the table <code>Example_1</code>, and arrange it first by <code>Weight</code>, then by <code>BMI</code>, we’ll store this in <code>Example_2</code>.</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a>Example_2 <span class="ot">&lt;-</span> <span class="fu">arrange</span>(Example_1, Weight, BMI)</span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a>Example_2</span></code></pre></div>
<pre><code>## # A tibble: 199 x 6
##    ID               Height Weight   BMI Reach Stance  
##    &lt;chr&gt;             &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;   
##  1 199eb7cf6ae90294     69    125  18.5    71 Orthodox
##  2 0fd5f4b838e890cc     68    125  19.0    70 Orthodox
##  3 67c1d46f4ed16f9e     68    125  19.0    70 Orthodox
##  4 792be9a24df82ed6     67    125  19.6    70 Orthodox
##  5 92437c6775b3f7d1     66    125  20.2    66 Orthodox
##  6 ab2b4ff41d6ebe0f     66    125  20.2    65 Orthodox
##  7 a0c64f272b65d441     66    125  20.2    68 Orthodox
##  8 1a31ef98efce7a79     66    125  20.2    66 Switch  
##  9 2fe9032955c2e013     66    125  20.2    69 Switch  
## 10 b102c26727306ab6     65    125  20.8    67 Orthodox
## # ... with 189 more rows</code></pre>
<p><span style="font-size: 22px; font-weight: bold; color: hsl(24, 100%, 50%);">Question Time</span></p>
<p>What is the height of the top entry in <code>Example_2</code>? <input class='webex-solveme nospaces' size='2' data-answer='["69"]'/></p>
<div class="task">
<p>
<strong>Your turn</strong>
</p>
<p>
Using <code>arrange()</code>, take the table <code>Example_1</code>
and arrange it first by <code>Reach</code> in <em>desceding</em> order,
then by <code>Height</code> in <em>ascending</em> order. Store the
result in <code>Q2</code>.
</p>
</div>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Jaimie&#39;s solution</span></span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a>Q2 <span class="ot">&lt;-</span> <span class="fu">arrange</span>(Example_1, <span class="fu">desc</span>(Reach), <span class="fu">desc</span>(Height))</span></code></pre></div>
</div>
<p>What is the <code>BMI</code> of the top entry in <code>Q2</code>? <input class='webex-solveme nospaces' size='6' data-answer='["27.042"]'/></p>
</div>
<div id="filter-1" class="section level3 hasAnchor" number="4.2.3">
<h3 class="hasAnchor"><span class="header-section-number">4.2.3</span> filter()<a href="#filter-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now onto <code>filter()</code> which has so many uses! Lets filter out all the athletes who are <em>over</em> 31 years of age</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a>Example_3 <span class="ot">&lt;-</span> <span class="fu">filter</span>(MMA_Data, Age <span class="sc">&lt;=</span><span class="dv">31</span>)</span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a>Example_3</span></code></pre></div>
<pre><code>## # A tibble: 97 x 32
##    ID                Age Height HeightClass Weight   BMI Reach ReachClass Stance
##    &lt;chr&gt;           &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt; 
##  1 a4de54ea806fb5~  25.4     64 Short          125  21.5    63 Below      Ortho~
##  2 a0f0004aadf10b~  28.7     65 Short          125  20.8    67 Below      Ortho~
##  3 f53c1f4ceeed8c~  30       65 Short          125  20.8    65 Below      Ortho~
##  4 ab2b4ff41d6ebe~  26.8     66 Average        125  20.2    65 Below      Ortho~
##  5 87f19d19f4cb73~  30.4     65 Short          125  20.8    65 Below      Ortho~
##  6 0fd5f4b838e890~  26.7     68 Average        125  19.0    70 Below      Ortho~
##  7 20999e27ddd94b~  29.3     65 Short          125  20.8    68 Below      Ortho~
##  8 a0c64f272b65d4~  27.9     66 Average        125  20.2    68 Below      Ortho~
##  9 67c1d46f4ed16f~  29.0     68 Average        125  19.0    70 Below      Ortho~
## 10 792be9a24df82e~  25.0     67 Average        125  19.6    70 Below      Ortho~
## # ... with 87 more rows, and 23 more variables: WeightClass &lt;chr&gt;,
## #   T_Wins &lt;dbl&gt;, T_Losses &lt;dbl&gt;, T_Fights &lt;dbl&gt;, Success &lt;dbl&gt;,
## #   W_by_Decision &lt;dbl&gt;, `W_by_KO/TKO` &lt;dbl&gt;, W_by_Sub &lt;dbl&gt;,
## #   L_by_Decision &lt;dbl&gt;, `L_by_KO/TKO` &lt;dbl&gt;, L_by_Sub &lt;dbl&gt;, PWDec &lt;dbl&gt;,
## #   PWTko &lt;dbl&gt;, PWSub &lt;dbl&gt;, PLDec &lt;dbl&gt;, PLTko &lt;dbl&gt;, PLSub &lt;dbl&gt;,
## #   Available &lt;dbl&gt;, TTime &lt;dbl&gt;, Time_Avg &lt;dbl&gt;, TLpM &lt;dbl&gt;, AbpM &lt;dbl&gt;,
## #   SubAtt_Avg &lt;dbl&gt;</code></pre>
<p><span style="font-size: 22px; font-weight: bold; color: hsl(24, 100%, 50%);">Question Time</span></p>
<p>How many athletes (observations) are left in <code>Example_3</code>? <input class='webex-solveme nospaces' size='2' data-answer='["97"]'/></p>
<div class="task">
<p>
<strong>Your turn</strong>
</p>
<p>
Using <code>filter()</code>, take the original table
<code>MMA_Data</code> and keep only those athletes in the ‘Flyweight’
and ‘Lightweight’ <code>WeightClasses</code> Store the result in
<code>Q3</code>.
</p>
</div>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Jaimie&#39;s solution</span></span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a>Q3 <span class="ot">&lt;-</span> <span class="fu">filter</span>(MMA_Data, WeightClass <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Flyweight&quot;</span>, <span class="st">&quot;Lightweight&quot;</span>))</span></code></pre></div>
</div>
<p>How many athletes (observations) are left in <code>Q3</code>? <input class='webex-solveme nospaces' size='2' data-answer='["50"]'/></p>
<div class="task">
<p>
<strong>Your turn</strong>
</p>
<p>
Now try taking the original table <code>MMA_Data</code> and keep only
those athletes from the “Welterweight” <code>WeightClass</code>, who are
over 72 inches in <code>Height</code>. Store the result in
<code>Q4</code>. - Hint - remember they will need to match <em>both</em>
conditions
</p>
</div>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Jaimie&#39;s solution</span></span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a>Q4 <span class="ot">&lt;-</span> <span class="fu">filter</span>(MMA_Data, WeightClass <span class="sc">==</span> <span class="st">&quot;Welterweight&quot;</span>, Height <span class="sc">&lt;=</span> <span class="dv">72</span>)</span></code></pre></div>
</div>
<p>How many athletes (observations) are left in <code>Q4</code>? <input class='webex-solveme nospaces' size='2' data-answer='["18"]'/></p>
<div class="task">
<p>
<strong>Your turn</strong>
</p>
<p>
Now try taking the original table <code>MMA_Data</code> and keep only
those athletes who have the “Orthodox” <code>Stance</code> <em>AND</em>
have 27 or more total fights (<code>T_Fights</code>) <em>OR</em> 15 or
more wins by submission (<code>W_by_Sub</code>). Store the result in
<code>Q5</code>. - Hint - No matter what they need to have the
<code>Orthodox</code> stance, regardless of the other conditions
</p>
</div>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Jaimie&#39;s solution</span></span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a>Q5 <span class="ot">&lt;-</span> <span class="fu">filter</span>(MMA_Data, Stance <span class="sc">==</span> <span class="st">&quot;Orthodox&quot;</span> <span class="sc">&amp;</span> (T_Fights <span class="sc">&gt;=</span> <span class="dv">27</span> <span class="sc">|</span> W_by_Sub <span class="sc">&gt;=</span> <span class="dv">15</span>))</span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a><span class="co">#OR</span></span>
<span id="cb200-4"><a href="#cb200-4" aria-hidden="true" tabindex="-1"></a>Q5 <span class="ot">&lt;-</span> <span class="fu">filter</span>(MMA_Data, Stance <span class="sc">==</span> <span class="st">&quot;Orthodox&quot;</span>, (T_Fights <span class="sc">&gt;=</span> <span class="dv">27</span> <span class="sc">|</span> W_by_Sub <span class="sc">&gt;=</span> <span class="dv">15</span>))</span></code></pre></div>
</div>
<div class="webex-solution">
<button>
Explain This Answer
</button>
<div class="solved">
<p>
There is essentially 2 parts to this question; the first criteria is
to find athletes who have the “orthodox” stance… that’s the first
requirement… then <em>if</em> they matched that criteria, we want to
check, if they have <em>EITHER</em> 27 or more total fights <em>OR</em>
15 or more wins by submission, which is why we need to put the second
“either/or” criteria in brackets, so R knows to treat them together.
</p>
<p>
If you take the brackets out, it will treat the first two criteria as
a joint criteria and the <code>|</code> “Or” operator creates the break.
Meaning R thinks you are asking for; Athletes with the orthodox stance
and 27 or more total fights… <em>OR</em> athletes with 15 or more wins
by submission. Try running the code without the brackets and seeing what
happens
</p>
<p>
<code>Q5Alt &lt;- filter(MMA_Data, Stance == “Orthodox” &amp; T_Fights &gt;= 27 | W_by_Sub &gt;= 15)</code>
</p>
<p>
Hopefully now you can understand the difference.
</p>
</div>
</div>
<p>How many athletes (observations) are left in <code>Q5</code>? <input class='webex-solveme nospaces' size='2' data-answer='["44"]'/></p>
</div>
<div id="mutate-1" class="section level3 hasAnchor" number="4.2.4">
<h3 class="hasAnchor"><span class="header-section-number">4.2.4</span> mutate()<a href="#mutate-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Moving on to mutate() now.</p>
<p>Lets add a new column onto the table <code>Example_1</code>, that shows <code>Reach</code> but in meters rather than inches, and we’ll call it <code>ReachM</code>. We can make this column with <code>mutate()</code> by converting the inches value in the original <code>Reach</code> column into centimeters, by multiplying (<code>*</code>) the value by <code>2.54</code> and then dividing (<code>/</code>) the result by <code>100</code>.</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a>Example_4 <span class="ot">&lt;-</span> <span class="fu">mutate</span>(Example_1, <span class="at">ReachM =</span> (Reach<span class="sc">*</span><span class="fl">2.54</span>)<span class="sc">/</span><span class="dv">100</span>)</span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a>Example_4</span></code></pre></div>
<pre><code>## # A tibble: 199 x 7
##    ID               Height Weight   BMI Reach Stance   ReachM
##    &lt;chr&gt;             &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt;
##  1 056c493bbd76a918     64    125  21.5    64 Orthodox   1.63
##  2 b102c26727306ab6     65    125  20.8    67 Orthodox   1.70
##  3 80eacd4da0617c57     64    125  21.5    65 Southpaw   1.65
##  4 a4de54ea806fb525     64    125  21.5    63 Orthodox   1.60
##  5 aa72b0f831d0bfe5     65    125  20.8    68 Orthodox   1.73
##  6 92437c6775b3f7d1     66    125  20.2    66 Orthodox   1.68
##  7 5aedf14771ca82d2     64    125  21.5    65 Southpaw   1.65
##  8 a0f0004aadf10b71     65    125  20.8    67 Orthodox   1.70
##  9 f53c1f4ceeed8c08     65    125  20.8    65 Orthodox   1.65
## 10 ab2b4ff41d6ebe0f     66    125  20.2    65 Orthodox   1.65
## # ... with 189 more rows</code></pre>
<p><span style="font-size: 22px; font-weight: bold; color: hsl(24, 100%, 50%);">Question Time</span></p>
<div class="task">
<p>
<strong>Your turn</strong>
</p>
<p>
Take the table <code>Example_1</code> and mutate a new column onto it
called <code>BMI_Alt</code>, this time attempting to recalculate BMI
using the Weight and Height variables. The calculation for BMI is;
weight in kilograms devided by height in meters squared. Lets break down
the steps, you will need to; - multiply <code>Weight</code> by 0.453 (to
convert lbs to kgs) - divide that by… - <code>Height</code> multiplied
2.54 (to convert inches to cm), which you divide by 100 (to convert to
m), which you then square Store the result in <code>Q5</code>.
</p>
<ul>
<li>
Hint - the <code>^</code> symbol is for calculating “to the power
of”
</li>
</ul>
</div>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Jaimie&#39;s solution</span></span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a>Q6 <span class="ot">&lt;-</span> <span class="fu">mutate</span>(Example_1, <span class="at">BMI_Alt =</span> (Weight<span class="sc">*</span><span class="fl">0.453</span>)<span class="sc">/</span>(((Height<span class="sc">*</span><span class="fl">2.54</span>)<span class="sc">/</span><span class="dv">100</span>)<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
</div>
<div class="info">
<p>
Don’t be worried if your new column is different by a few decimals
(the original BMI was created with a slightly different calculation with
different rounding). If they look approximately similar you have done it
correctly.
</p>
</div>
</div>
<div id="group_by-and-summarise" class="section level3 hasAnchor" number="4.2.5">
<h3 class="hasAnchor"><span class="header-section-number">4.2.5</span> group_by() and summarise()<a href="#group_by-and-summarise" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now let’s brush up on group_by and summarise().</p>
<p>Here we will take the original table <code>MMA_Data</code> and group that data by <code>WeightClass</code>.
Then we will create <code>mean()</code> summary stats for:
Number of hits landed per minute (<code>TLpM</code>) and we’ll call that column <code>MeanHit</code>,
Number of hits absorbed per minute (<code>AbpM</code>) and we’ll call that column <code>MeanAbsorb</code>,
And average fight length (<code>Time_Avg</code>) and we’ll call that column <code>MeanTime</code>.</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a>Example_5a <span class="ot">&lt;-</span> <span class="fu">group_by</span>(MMA_Data, WeightClass)</span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a>Example_5b <span class="ot">&lt;-</span> <span class="fu">summarise</span>(Example_5a, <span class="at">MeanHit =</span> <span class="fu">mean</span>(TLpM), <span class="at">MeanAbsorb =</span> <span class="fu">mean</span>(AbpM), <span class="at">MeanTime =</span> <span class="fu">mean</span>(Time_Avg))</span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true" tabindex="-1"></a>Example_5b</span></code></pre></div>
<pre><code>## # A tibble: 8 x 4
##   WeightClass      MeanHit MeanAbsorb MeanTime
##   &lt;chr&gt;              &lt;dbl&gt;      &lt;dbl&gt;    &lt;dbl&gt;
## 1 Bantamweight        5.46       3.38    11.3 
## 2 Featherweight       5.43       3.46    11.8 
## 3 Flyweight           4.78       2.64    11.9 
## 4 Heavyweight         5.28       3.14    10.1 
## 5 LightHeavyweight    6.05       2.97     9.12
## 6 Lightweight         5.19       3.25     9.93
## 7 Middleweight        5.11       2.78    10.2 
## 8 Welterweight        5.09       2.94    11.7</code></pre>
<p><span style="font-size: 22px; font-weight: bold; color: hsl(24, 100%, 50%);">Question Time</span></p>
<p>Which weightclass has the highest Hit average? <input class='webex-solveme nospaces' size='16' data-answer='["LightHeavyweight"]'/> <br>
Which weightclass has the lowest Absorbtion average? <input class='webex-solveme nospaces' size='9' data-answer='["Flyweight"]'/> <br>
Which weightclass has the highest average time? <input class='webex-solveme nospaces' size='9' data-answer='["Flyweight"]'/> <br></p>
<div class="task">
<p>
<strong>Your turn</strong>
</p>
<p>
Take the original table <code>MMA_Data</code> and group that data by
<code>Stance</code> and <code>HeightClass</code> and store that in
<code>Q7a</code>. Then create summary stats for success rate
(<code>Success</code>), you should have columns called;
<code>MedSuccess</code> that shows the median success rate
<code>MaxSuccess</code> that shows the maximum success rate
<code>MinSuccess</code> that shows the minimum success rate
<code>SDSuccess</code> that shows the standard deviation of success rate
The resulting table should be stored in <code>Q7b</code>.
</p>
</div>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Jaimie&#39;s solution</span></span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a>Q7a <span class="ot">&lt;-</span> <span class="fu">group_by</span>(MMA_Data, Stance, HeightClass)</span>
<span id="cb206-3"><a href="#cb206-3" aria-hidden="true" tabindex="-1"></a>Q7b <span class="ot">&lt;-</span> <span class="fu">summarise</span>(Q7a, <span class="at">MedSuccess =</span> <span class="fu">median</span>(Success), <span class="at">MaxSuccess =</span> <span class="fu">max</span>(Success), <span class="at">MinSuccess =</span> <span class="fu">min</span>(Success), <span class="at">SDSuccess =</span> <span class="fu">sd</span>(Success))</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;Stance&#39;. You can override using the
## `.groups` argument.</code></pre>
</div>
<p>Which Stance/HeightClass combo has the highest median success rate? (enter your answers in the format Stance/HeightClass) <input class='webex-solveme nospaces' size='11' data-answer='["Swithc/Tall"]'/> <br>
What is the minimum success rate of tall athletes with an orthodox stance? <input class='webex-solveme nospaces' size='5' data-answer='["0.415"]'/> <br>
What is the standard deviation in success rate for short athletes with a southpaw stance? (write your answer to 3 decimal places) <input class='webex-solveme nospaces' size='5' data-answer='["0.062"]'/> <br></p>
</div>
<div id="bringing-it-all-together" class="section level3 hasAnchor" number="4.2.6">
<h3 class="hasAnchor"><span class="header-section-number">4.2.6</span> Bringing it all together<a href="#bringing-it-all-together" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span style="font-size: 22px; font-weight: bold; color: hsl(24, 100%, 50%);">Question Time</span></p>
<div class="task">
<p>
<strong>Your turn</strong> This is another multi-part question…
</p>
<ul>
<li>
Take the original table <code>MMA_Data</code>, and select just
<code>ID</code>, <code>WeightClass</code>, <code>Stance</code>,
<code>T_Wins</code>, <code>W_by_Decision</code>,
<code>W_by_KO/TKO</code> and <code>W_by_Sub</code>. Store the result in
<code>Q8a</code>.
</li>
<li>
Take <code>Q8a</code> and filter out all the athletes with the
“Southpaw” <code>Stance</code>. Store the result in Q8b.
</li>
<li>
Take <code>Q8b</code> and mutate on a new column called
<code>Perc_W_by_Dec</code> that shows the percentage of total wins
(<code>T_Wins</code>) that are accounted for by decisions
(<code>W_by_Decision</code>). Store the result in <code>Q8c</code>.
</li>
<li>
Take <code>Q8c</code> and group that data by
<code>WeightClass</code>. Store the result in <code>Q8d</code>.
</li>
<li>
Take <code>Q8d</code> and create summary stats that show the mean of
<code>Perc_W_by_Dec</code>. Store the result in <code>Q8e</code>.
</li>
</ul>
</div>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Jaimie&#39;s solution</span></span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a>Q8a <span class="ot">&lt;-</span> <span class="fu">select</span>(MMA_Data, ID, WeightClass, Stance, T_Wins, W_by_Decision, <span class="st">&quot;W_by_KO/TKO&quot;</span>, W_by_Sub)</span>
<span id="cb208-3"><a href="#cb208-3" aria-hidden="true" tabindex="-1"></a>Q8b <span class="ot">&lt;-</span> <span class="fu">filter</span>(Q8a, Stance <span class="sc">!=</span> <span class="st">&quot;Southpaw&quot;</span>)</span>
<span id="cb208-4"><a href="#cb208-4" aria-hidden="true" tabindex="-1"></a>Q8c <span class="ot">&lt;-</span> <span class="fu">mutate</span>(Q8b, <span class="at">Perc_W_by_Dec =</span> (W_by_Decision<span class="sc">/</span>T_Wins)<span class="sc">*</span><span class="dv">100</span>)</span>
<span id="cb208-5"><a href="#cb208-5" aria-hidden="true" tabindex="-1"></a>Q8d <span class="ot">&lt;-</span> <span class="fu">group_by</span>(Q8c, WeightClass)</span>
<span id="cb208-6"><a href="#cb208-6" aria-hidden="true" tabindex="-1"></a>Q8e <span class="ot">&lt;-</span> <span class="fu">summarise</span>(Q8d, <span class="at">AvgPercDec =</span> <span class="fu">mean</span>(Perc_W_by_Dec))</span></code></pre></div>
</div>
<p>Which weightclass has the lowest average percentage of wins by decision? <input class='webex-solveme nospaces' size='11' data-answer='["Heavyweight"]'/></p>
</div>
</div>
<div id="pipes" class="section level2 hasAnchor" number="4.3">
<h2 class="hasAnchor"><span class="header-section-number">4.3</span> The pipe operator (%&gt;%)<a href="#pipes" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As you may have noticed, your environment pane has become increasingly cluttered. Indeed, every time you introduced a new line of code, you created a uniquely-named object (unless your original object is overwritten). This can become confusing and time-consuming. One solution is the pipe operator (<code>%&gt;%</code>) which aims to increase efficiency and improve the readability of your code. The pipe operator (<code>%&gt;%</code>) read as <strong>“and then”</strong> allows you to chain functions together, eliminating the need to create intermediary objects. This creates a “pipeline”, allowing the “flow” of data between lines of code, as the output of one function “flows” into the next function. There is no limit as to how many functions you can chain together in a single pipeline.</p>
<p>For example, in order to <code>filter()</code>, <code>group_by()</code> and <code>summarise()</code> the data, you would have used the following code lines:</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a>Example_6a <span class="ot">&lt;-</span> <span class="fu">filter</span>(MMA_Data, ReachClass <span class="sc">==</span> <span class="st">&quot;Above&quot;</span>)</span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a>Example_6b <span class="ot">&lt;-</span> <span class="fu">group_by</span>(Example_6a, WeightClass)</span>
<span id="cb209-3"><a href="#cb209-3" aria-hidden="true" tabindex="-1"></a>Example_6c <span class="ot">&lt;-</span> <span class="fu">summarise</span>(Example_6b, <span class="at">MeanSub =</span> <span class="fu">mean</span>(SubAtt_Avg))</span>
<span id="cb209-4"><a href="#cb209-4" aria-hidden="true" tabindex="-1"></a>Example_6c</span></code></pre></div>
<pre><code>## # A tibble: 6 x 2
##   WeightClass      MeanSub
##   &lt;chr&gt;              &lt;dbl&gt;
## 1 Featherweight      0.395
## 2 Heavyweight        0.521
## 3 LightHeavyweight   0.613
## 4 Lightweight        0.757
## 5 Middleweight       0.498
## 6 Welterweight       0.520</code></pre>
<p>However, utilisation of the pipe operator (<code>%&gt;%</code>) can simplify this process and create only one object (<code>Example_7</code>) as shown:</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a>Example_7 <span class="ot">&lt;-</span> MMA_Data <span class="sc">%&gt;%</span></span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ReachClass <span class="sc">==</span> <span class="st">&quot;Above&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb211-3"><a href="#cb211-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(WeightClass) <span class="sc">%&gt;%</span></span>
<span id="cb211-4"><a href="#cb211-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MeanSub =</span> <span class="fu">mean</span>(SubAtt_Avg))</span>
<span id="cb211-5"><a href="#cb211-5" aria-hidden="true" tabindex="-1"></a>Example_7</span></code></pre></div>
<pre><code>## # A tibble: 6 x 2
##   WeightClass      MeanSub
##   &lt;chr&gt;              &lt;dbl&gt;
## 1 Featherweight      0.395
## 2 Heavyweight        0.521
## 3 LightHeavyweight   0.613
## 4 Lightweight        0.757
## 5 Middleweight       0.498
## 6 Welterweight       0.520</code></pre>
<p>As you can see, <code>Example_7</code> produces the same output as <code>Example_6c</code>. So, pipes automatically take the output from one function and feed it directly to the next function. Without pipes, you needed to insert your chosen dataset as the first argument to every function. With pipes, you are only required to specify the original dataset (i.e <code>MMA_Data</code>) once at the beginning of the pipeline, and removes the need to create unnecessary intermediary objects. You now no longer need the first argument of each of the subsequent functions anymore, because the pipe will know to look at the output from the previous step in the pipeline.</p>
<div class="task">
<p>
<strong>Your turn</strong>
</p>
<p>
Amend all of your code from Question8 and turn it into a single
pipeline Save this as an object called <code>Q9</code> to your
<code>Global Environment</code>.
</p>
</div>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Jaimie&#39;s solution</span></span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a>Q9 <span class="ot">&lt;-</span> MMA_Data <span class="sc">%&gt;%</span></span>
<span id="cb213-3"><a href="#cb213-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ID, WeightClass, Stance, T_Wins, W_by_Decision, <span class="st">&quot;W_by_KO/TKO&quot;</span>, W_by_Sub) <span class="sc">%&gt;%</span></span>
<span id="cb213-4"><a href="#cb213-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Stance <span class="sc">!=</span> <span class="st">&quot;Southpaw&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb213-5"><a href="#cb213-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Perc_W_by_Dec =</span> (W_by_Decision<span class="sc">/</span>T_Wins)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb213-6"><a href="#cb213-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(WeightClass) <span class="sc">%&gt;%</span></span>
<span id="cb213-7"><a href="#cb213-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">AvgPercDec =</span> <span class="fu">mean</span>(Perc_W_by_Dec))</span>
<span id="cb213-8"><a href="#cb213-8" aria-hidden="true" tabindex="-1"></a>Q9</span></code></pre></div>
<pre><code>## # A tibble: 8 x 2
##   WeightClass      AvgPercDec
##   &lt;chr&gt;                 &lt;dbl&gt;
## 1 Bantamweight           37.5
## 2 Featherweight          35.8
## 3 Flyweight              36.7
## 4 Heavyweight            19.4
## 5 LightHeavyweight       25.3
## 6 Lightweight            28.7
## 7 Middleweight           27.8
## 8 Welterweight           33.3</code></pre>
</div>
<p>If done correct <code>Q9</code> should look identical to <code>Q8e</code></p>
<div class="funfact">
<p>
Note that in the above code chunk, the data object has been on its
own line in the code followed immediately by <code>%&gt;%</code> before
starting with the “functions”.
</p>
<p>
The other option would have been to put the data object as the first
argument within the first function.
</p>
<p>
The benefit of having the data on its own is that you can reorder
functions easily or squeeze another one in (for example if you
summarised something but forgot to group beforehand) without the need to
“move” the data object into the new first argument of the pipeline.
</p>
</div>
</div>
<div id="two-table-verbs" class="section level2 hasAnchor" number="4.4">
<h2 class="hasAnchor"><span class="header-section-number">4.4</span> Two-Table Verbs<a href="#two-table-verbs" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>More often than not you will find yourself with data across multiple tables. In order to effectively combine multiple tables, <code>dplyr</code> provides a selection of <strong>two-table verbs</strong>. Today we will focus on two categories of two-table verbs - mutating join verbs and binding join verbs.</p>
<div id="bringing-in-new-data" class="section level3 hasAnchor" number="4.4.1">
<h3 class="hasAnchor"><span class="header-section-number">4.4.1</span> Bringing in new data<a href="#bringing-in-new-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>First of all lets bring in some new data to look at these new functions.</p>
<div id="whats-the-data" class="section level4 hasAnchor" number="4.4.1.1">
<h4 class="hasAnchor"><span class="header-section-number">4.4.1.1</span> What’s the data<a href="#whats-the-data" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Source: Met Office National Climate Information Centre
<a href="https://www.metoffice.gov.uk/research/climate/maps-and-data/uk-and-regional-series" class="uri">https://www.metoffice.gov.uk/research/climate/maps-and-data/uk-and-regional-series</a></p>
<p>wos_seasonal_sun: Seasonal total duration of bright sunshine for Scotland W; Areal series, starting in 1919</p>
<p>wos_monthly_sun: Monthly and annual total duration of bright sunshine for Scotland W; Areal series, starting in 1919</p>
<p>wos_seasonal_rain: Seasonal total precipitation amount for Scotland W; Areal series, starting in 1862</p>
<p>wos_monthly_rain: Monthly and annual total precipitation amount for Scotland W; Areal series, starting in 1862</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a>wos_seasonal_sun <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;wos_seasonal_sun.csv&quot;</span>)</span></code></pre></div>
<pre><code>## Rows: 102 Columns: 5
## -- Column specification --------------------------------------------------------
## Delimiter: &quot;,&quot;
## dbl (5): year, win, spr, sum, aut
## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a>wos_monthly_sun <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;wos_monthly_sun.csv&quot;</span>)</span></code></pre></div>
<pre><code>## Rows: 102 Columns: 14
## -- Column specification --------------------------------------------------------
## Delimiter: &quot;,&quot;
## dbl (14): year, jan, feb, mar, apr, may, jun, jul, aug, sep, oct, nov, dec, ann
## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a>wos_seasonal_rain <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;wos_seasonal_rain.csv&quot;</span>)</span></code></pre></div>
<pre><code>## Rows: 154 Columns: 5
## -- Column specification --------------------------------------------------------
## Delimiter: &quot;,&quot;
## dbl (5): year, win, spr, sum, aut
## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a>wos_monthly_rain <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;wos_monthly_rain.csv&quot;</span>)</span></code></pre></div>
<pre><code>## Rows: 154 Columns: 14
## -- Column specification --------------------------------------------------------
## Delimiter: &quot;,&quot;
## dbl (14): year, jan, feb, mar, apr, may, jun, jul, aug, sep, oct, nov, dec, ann
## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<div id="mutating-join-verbs" class="section level3 hasAnchor" number="4.4.2">
<h3 class="hasAnchor"><span class="header-section-number">4.4.2</span> Mutating Join Verbs<a href="#mutating-join-verbs" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Mutating join verbs combine the variables (columns) of two tables so that matching rows are together. There are 4 different types of mutating joins, namely <code>inner_join()</code>, <code>left_join()</code>, <code>right_join()</code>, and <code>full_join()</code>.</p>
<p>Mutating joins have the following basic syntax:</p>
<center>
<img src="images/join.PNG">
</center>
<p>To help you visualise what these joining functions are doing, we will use some simple diagrams, like the one below. Here <code>data1</code> (shown below in blue) represents our “left” dataframe (or table) and <code>data2</code> (shown below in green) represents our “right” dataframe.</p>
<center>
<img src="images/join_tables.png" height="200">
</center>
<p>To make things nice and clear to see, lets simplify our data a litte.</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a>Summer_Rain <span class="ot">&lt;-</span> wos_seasonal_rain <span class="sc">%&gt;%</span> </span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(year, sum)</span>
<span id="cb223-3"><a href="#cb223-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-4"><a href="#cb223-4" aria-hidden="true" tabindex="-1"></a>Summer_Sun <span class="ot">&lt;-</span> wos_seasonal_sun <span class="sc">%&gt;%</span> </span>
<span id="cb223-5"><a href="#cb223-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(year, sum)</span>
<span id="cb223-6"><a href="#cb223-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-7"><a href="#cb223-7" aria-hidden="true" tabindex="-1"></a>Summer_Rain</span></code></pre></div>
<pre><code>## # A tibble: 154 x 2
##     year   sum
##    &lt;dbl&gt; &lt;dbl&gt;
##  1  1862  426.
##  2  1863  299.
##  3  1864  255.
##  4  1865  274.
##  5  1866  345.
##  6  1867  340.
##  7  1868  295.
##  8  1869  183.
##  9  1870  205.
## 10  1871  349.
## # ... with 144 more rows</code></pre>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a>Summer_Sun</span></code></pre></div>
<pre><code>## # A tibble: 102 x 2
##     year   sum
##    &lt;dbl&gt; &lt;dbl&gt;
##  1  1919  524.
##  2  1920  411.
##  3  1921  509 
##  4  1922  385.
##  5  1923  327.
##  6  1924  329.
##  7  1925  529.
##  8  1926  512.
##  9  1927  446 
## 10  1928  408.
## # ... with 92 more rows</code></pre>
<div class="info">
<p>
Now we have; * rain data for the summer months from 1862 to 2015
(<code>Summer_Rain</code>) * sunshine data for the summer months from
1919 to 2020 (<code>Summer_Sun</code>) Notice they have data from some
of the same years, but also have data from years unique to each
table
</p>
</div>
<div id="inner_join" class="section level4 hasAnchor" number="4.4.2.1">
<h4 class="hasAnchor"><span class="header-section-number">4.4.2.1</span> inner_join()<a href="#inner_join" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><code>inner_join()</code> returns all rows from both tables for which the values in column specified in the <code>"by = "</code> statement overlap.</p>
<center>
<img src="images/inner_join1.png">
</center>
<p>Here we merge <code>Summer_Sun</code> and <code>Summer_Rain</code> with <code>inner_join()</code> specifying we want to “join by” the variable <code>year</code>. Becuase the remaining variable has the same name in both tables, R needs to distiguish them from each other, for that we use the <code>suffix =</code> arguement, which allows us to specify what suffix to add to each column of the resulting table. If we do not spcify this, R will add a <code>.x</code> and <code>.y</code> suffix for us to the x (left) and y (right) table variables respectively.</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a>inner <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(Summer_Sun, Summer_Rain, <span class="at">by=</span><span class="st">&quot;year&quot;</span>, <span class="at">suffix =</span> <span class="fu">c</span>(<span class="st">&quot;_sun&quot;</span>, <span class="st">&quot;_rain&quot;</span>))</span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a>inner</span></code></pre></div>
<pre><code>## # A tibble: 97 x 3
##     year sum_sun sum_rain
##    &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
##  1  1919    524.     298 
##  2  1920    411.     358.
##  3  1921    509      354.
##  4  1922    385.     334.
##  5  1923    327.     444.
##  6  1924    329.     395.
##  7  1925    529.     228.
##  8  1926    512.     367 
##  9  1927    446      433.
## 10  1928    408.     440.
## # ... with 87 more rows</code></pre>
<p>Using an inner join returns only 97 (1919 to 2015) rows of observations because these are the only years in <code>year</code> that are present in both the Sun (1919 to 2020) and the Rain (1862 to 2015) data tables. However, we are still merging both tibbles together, meaning that all columns from <code>Summer_Sun</code> and <code>Summer_Rain</code> are kept (in our case <code>sum</code>, with a suffix added to each to tell them appart). In this example, the years 1862 to 1918, are dropped becuase they are not present in the Sun data, and the years 2016 to 2020 are dropped becuase they are not present in the Rain data.</p>
<div class="funfact">
<p>
If you don’t specify which variable to “join by”, and omit the by
statement, the R will joing by all columns in common…
</p>
<p>
Try it for yourself in the <code>Console</code> and see what
happens
</p>
</div>
<p><span style="font-size: 22px; font-weight: bold; color: hsl(24, 100%, 50%);">Question Time</span></p>
<p>How many rows (or observations) does <code>inner</code> have? <input class='webex-solveme nospaces' size='2' data-answer='["97"]'/> <br>
How many columns (or variables) does <code>inner</code> have? <input class='webex-solveme nospaces' size='1' data-answer='["3"]'/> <br></p>
</div>
<div id="left_join" class="section level4 hasAnchor" number="4.4.2.2">
<h4 class="hasAnchor"><span class="header-section-number">4.4.2.2</span> left_join()<a href="#left_join" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><code>left_join()</code> retains the complete first (left) table and adds values from the second (right) table that have matching values in the column specified in the <code>"by ="</code> statement. Rows in the left table with no match in the right table will have missing values (<code>NA</code>) in the new columns.</p>
<center>
<img src="images/left_join1.png">
</center>
<p>Let’s try this <code>left_join()</code> function for our simple example of <code>Summer_Sun</code> and <code>Summer_Rain</code> in R.</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a>left <span class="ot">&lt;-</span> <span class="fu">left_join</span>(Summer_Sun, Summer_Rain, <span class="at">by=</span><span class="st">&quot;year&quot;</span>, <span class="at">suffix =</span> <span class="fu">c</span>(<span class="st">&quot;_sun&quot;</span>, <span class="st">&quot;_rain&quot;</span>))</span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a>left</span></code></pre></div>
<pre><code>## # A tibble: 102 x 3
##     year sum_sun sum_rain
##    &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
##  1  1919    524.     298 
##  2  1920    411.     358.
##  3  1921    509      354.
##  4  1922    385.     334.
##  5  1923    327.     444.
##  6  1924    329.     395.
##  7  1925    529.     228.
##  8  1926    512.     367 
##  9  1927    446      433.
## 10  1928    408.     440.
## # ... with 92 more rows</code></pre>
<p>Here <code>Summer_Sun</code> is returned in full, and for every matching <code>year</code> in <code>Summer_Rain</code> the value is added. However, <code>Summer_Rain</code> does not have any value for the years 2016 to 2020, hence <code>NA</code> is added here to the column <code>sum_rain</code>.</p>
<p><span style="font-size: 22px; font-weight: bold; color: hsl(24, 100%, 50%);">Question Time</span></p>
<p>How many rows (or observations) does <code>left</code> have? <input class='webex-solveme nospaces' size='3' data-answer='["102"]'/> <br>
How many columns (or variables) does <code>left</code> have? <input class='webex-solveme nospaces' size='1' data-answer='["3"]'/> <br></p>
</div>
<div id="right_join" class="section level4 hasAnchor" number="4.4.2.3">
<h4 class="hasAnchor"><span class="header-section-number">4.4.2.3</span> right_join()<a href="#right_join" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><code>right_join()</code> retains the complete second (right) table and adds values from the first (left) table that have matching values in the column specified in the by statement. Rows in the right table with no match in the left table will have missing values (<code>NA</code>) in the new columns.</p>
<center>
<img src="images/right_join1.png">
</center>
<p>However, code-wise, you would still enter x as the first, and y as the second argument within <code>right_join()</code>.</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a>right <span class="ot">&lt;-</span> <span class="fu">right_join</span>(Summer_Sun, Summer_Rain, <span class="at">by=</span><span class="st">&quot;year&quot;</span>, <span class="at">suffix =</span> <span class="fu">c</span>(<span class="st">&quot;_sun&quot;</span>, <span class="st">&quot;_rain&quot;</span>))</span>
<span id="cb231-2"><a href="#cb231-2" aria-hidden="true" tabindex="-1"></a>right</span></code></pre></div>
<pre><code>## # A tibble: 154 x 3
##     year sum_sun sum_rain
##    &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
##  1  1919    524.     298 
##  2  1920    411.     358.
##  3  1921    509      354.
##  4  1922    385.     334.
##  5  1923    327.     444.
##  6  1924    329.     395.
##  7  1925    529.     228.
##  8  1926    512.     367 
##  9  1927    446      433.
## 10  1928    408.     440.
## # ... with 144 more rows</code></pre>
<p>Here <code>Summer_Rain</code> is returned in full, and for every matching <code>year</code> in <code>Summer_Sun</code> the value is added, for any row of <code>Summer_Rain</code> that does not have a mating value in <code>Summer_Sun</code>, <code>NA</code> is added. Notice the order of the rows, though!!! All the years of <code>Summer_Sun</code> come first before the extra rows from <code>Summer_Rain</code> are added at the bottom. That is due to the order of how they are entered into the <code>right_join()</code> function. The “left” data (first table) is still prioritised in terms of ordering observations!</p>
<p><span style="font-size: 22px; font-weight: bold; color: hsl(24, 100%, 50%);">Question Time</span></p>
<p>How many rows (or observations) does <code>right</code> have? <input class='webex-solveme nospaces' size='3' data-answer='["154"]'/> <br></p>
</div>
<div id="full_join" class="section level4 hasAnchor" number="4.4.2.4">
<h4 class="hasAnchor"><span class="header-section-number">4.4.2.4</span> full_join()<a href="#full_join" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><code>full_join()</code> returns all rows and all columns from both dataframes. <code>NA</code> values fill unmatched rows.</p>
<center>
<img src="images/full_join1.png">
</center>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a>full <span class="ot">&lt;-</span> <span class="fu">full_join</span>(Summer_Sun, Summer_Rain, <span class="at">by=</span><span class="st">&quot;year&quot;</span>, <span class="at">suffix =</span> <span class="fu">c</span>(<span class="st">&quot;_sun&quot;</span>, <span class="st">&quot;_rain&quot;</span>))</span>
<span id="cb233-2"><a href="#cb233-2" aria-hidden="true" tabindex="-1"></a>full</span></code></pre></div>
<pre><code>## # A tibble: 159 x 3
##     year sum_sun sum_rain
##    &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
##  1  1919    524.     298 
##  2  1920    411.     358.
##  3  1921    509      354.
##  4  1922    385.     334.
##  5  1923    327.     444.
##  6  1924    329.     395.
##  7  1925    529.     228.
##  8  1926    512.     367 
##  9  1927    446      433.
## 10  1928    408.     440.
## # ... with 149 more rows</code></pre>
<p>As you can see, all years from both tables are kept, and <code>NA</code> is used to fill the missing years (1862 to 1918 for <code>sum_sun</code>, and 2016 to 2020 for <code>sum_rain</code>). Again you can see the prioritization of the left (first) table in the arrangement of the years.</p>
<p><span style="font-size: 22px; font-weight: bold; color: hsl(24, 100%, 50%);">Question Time</span></p>
<p>How many rows (or observations) does <code>full</code> have? <input class='webex-solveme nospaces' size='3' data-answer='["159"]'/> <br></p>
</div>
</div>
<div id="mutating-join-summary" class="section level3 hasAnchor" number="4.4.3">
<h3 class="hasAnchor"><span class="header-section-number">4.4.3</span> Mutating Join Summary<a href="#mutating-join-summary" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<table>
<colgroup>
<col width="28%" />
<col width="71%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">join function</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">inner_join()</td>
<td align="left">Includes all rows that are PRESENT IN BOTH the left and the right table</td>
</tr>
<tr class="even">
<td align="left">left_join()</td>
<td align="left">Includes all rows from the left table (first data entered)</td>
</tr>
<tr class="odd">
<td align="left">left_join()</td>
<td align="left">Includes all rows from the right table (second data entered)</td>
</tr>
<tr class="even">
<td align="left">full_join()</td>
<td align="left">Includes all rows from both left and right tables</td>
</tr>
</tbody>
</table>
<p><span style="font-size: 22px; font-weight: bold; color: hsl(24, 100%, 50%);">Question Time</span></p>
<div class="task">
<p>
<strong>Your turn</strong>
</p>
<p>
Join together <code>wos_seasonal_rain</code> and
<code>wos_seasonal_sun</code> so that we keep all the rows from the
<code>wos_seasonal_sun</code> table, add a useful suffix so you can
differentiate between columns with the same name. Store the result in
<code>Q10</code>.
</p>
</div>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Jaimie&#39;s solution</span></span>
<span id="cb235-2"><a href="#cb235-2" aria-hidden="true" tabindex="-1"></a>Q10 <span class="ot">&lt;-</span> <span class="fu">left_join</span>(wos_seasonal_sun, wos_seasonal_rain, <span class="at">by =</span> <span class="st">&quot;year&quot;</span>, <span class="at">suffix =</span> <span class="fu">c</span>(<span class="st">&quot;_sun&quot;</span>, <span class="st">&quot;_rain&quot;</span>))</span>
<span id="cb235-3"><a href="#cb235-3" aria-hidden="true" tabindex="-1"></a><span class="co">#OR </span></span>
<span id="cb235-4"><a href="#cb235-4" aria-hidden="true" tabindex="-1"></a>Q10 <span class="ot">&lt;-</span> <span class="fu">right_join</span>(wos_seasonal_rain, wos_seasonal_sun, <span class="at">by =</span> <span class="st">&quot;year&quot;</span>, <span class="at">suffix =</span> <span class="fu">c</span>(<span class="st">&quot;_rain&quot;</span>, <span class="st">&quot;_sun&quot;</span>))</span>
<span id="cb235-5"><a href="#cb235-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb235-6"><a href="#cb235-6" aria-hidden="true" tabindex="-1"></a>Q10</span></code></pre></div>
<pre><code>## # A tibble: 102 x 9
##     year win_rain spr_rain sum_rain aut_rain win_sun spr_sun sum_sun aut_sun
##    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
##  1  1919     389.     260.     298      339.    NA      414.    524.    257.
##  2  1920     704.     428.     358.     374.   111.     328.    411.    219.
##  3  1921     489.     390.     354.     340.   104.     404.    509     222.
##  4  1922     620      309.     334.     290.   102.     457.    385.    252.
##  5  1923     531.     266.     444.     649.    77.2    430.    327.    245.
##  6  1924     406.     262.     395.     447.   117.     356     329.    221.
##  7  1925     575.     462.     228.     329.    87.5    353.    529.    252.
##  8  1926     547.     308.     367      547.    91.1    366.    512.    241.
##  9  1927     445.     345.     433.     574.   104.     423.    446     240.
## 10  1928     567.     272.     440.     612.   131.     384.    408.    253.
## # ... with 92 more rows</code></pre>
</div>
</div>
<div id="binding-join-verbs" class="section level3 hasAnchor" number="4.4.4">
<h3 class="hasAnchor"><span class="header-section-number">4.4.4</span> Binding Join Verbs<a href="#binding-join-verbs" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In contrast to mutating join verbs, binding join verbs simply combine tables without any need for matching. Dplyr provides <code>bind_rows()</code> and <code>bind_cols()</code> for combining tables by row and column respectively. When row binding, missing columns are replaced by <code>NA</code> values. When column binding, if the tables do not match by appropriate dimensions, an error will result.</p>
<div id="bind_rows" class="section level4 hasAnchor" number="4.4.4.1">
<h4 class="hasAnchor"><span class="header-section-number">4.4.4.1</span> bind_rows()<a href="#bind_rows" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><code>bind_rows()</code> is ideal when you have more entries of the same kind of data, i.e. new observations of the same variables. (For example; you have a new batch of participants answering the same questionnaire; or you have new air pollution data from a different geographic region… same variables - different observations)</p>
<p>Lets split some data</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a>Sun_Season_1 <span class="ot">&lt;-</span> wos_seasonal_sun <span class="sc">%&gt;%</span></span>
<span id="cb237-2"><a href="#cb237-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">&gt;=</span> <span class="dv">1970</span>)</span>
<span id="cb237-3"><a href="#cb237-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4"><a href="#cb237-4" aria-hidden="true" tabindex="-1"></a>Sun_Season_2 <span class="ot">&lt;-</span> wos_seasonal_sun <span class="sc">%&gt;%</span></span>
<span id="cb237-5"><a href="#cb237-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">&lt;</span> <span class="dv">1970</span>)</span></code></pre></div>
<p>Now we have 2 indetical tables for seasonal sunshine in the west of Scotland, but for different sets of years. All the same variables, but totally different observations.</p>
<p>We can easily join these together with <code>bind_rows</code> to create a complete history.</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a>Bind_1 <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(Sun_Season_1, Sun_Season_2)</span>
<span id="cb238-2"><a href="#cb238-2" aria-hidden="true" tabindex="-1"></a>Bind_1</span></code></pre></div>
<pre><code>## # A tibble: 102 x 5
##     year   win   spr   sum   aut
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1  1970  158.  385.  474.  202.
##  2  1971  115.  424.  475.  269 
##  3  1972  113.  380.  480.  282.
##  4  1973  116.  418.  444.  250 
##  5  1974  110.  471.  480.  244 
##  6  1975  130.  517.  561.  218.
##  7  1976  110.  343.  588.  213 
##  8  1977  156.  431.  599.  226.
##  9  1978  159.  394.  412.  192.
## 10  1979  155.  383.  403.  223.
## # ... with 92 more rows</code></pre>
<p><code>bind_rows()</code> takes the second table <code>Sun_Season_2</code> and puts it <em>directly underneath</em> the first table <code>Sun_Season_1</code>.</p>
<p>What happens if we attempt to bind tables with different dimensions</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a>Bind_2 <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(Sun_Season_1, inner)</span>
<span id="cb240-2"><a href="#cb240-2" aria-hidden="true" tabindex="-1"></a>Bind_2</span></code></pre></div>
<pre><code>## # A tibble: 148 x 7
##     year   win   spr   sum   aut sum_sun sum_rain
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
##  1  1970  158.  385.  474.  202.      NA       NA
##  2  1971  115.  424.  475.  269       NA       NA
##  3  1972  113.  380.  480.  282.      NA       NA
##  4  1973  116.  418.  444.  250       NA       NA
##  5  1974  110.  471.  480.  244       NA       NA
##  6  1975  130.  517.  561.  218.      NA       NA
##  7  1976  110.  343.  588.  213       NA       NA
##  8  1977  156.  431.  599.  226.      NA       NA
##  9  1978  159.  394.  412.  192.      NA       NA
## 10  1979  155.  383.  403.  223.      NA       NA
## # ... with 138 more rows</code></pre>
<p>Notice that the <code>bind_rows()</code> does not “care” if it duplicates rows, here we have repeat years. Also <code>bind_rows()</code> does not “care” that there are columns that do not match between the tables, here <code>NA</code> is added fill the missing space.</p>
</div>
<div id="bind_cols" class="section level4 hasAnchor" number="4.4.4.2">
<h4 class="hasAnchor"><span class="header-section-number">4.4.4.2</span> bind_cols()<a href="#bind_cols" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><code>bind_cols()</code> is similar to our mutating join verbs in that it creates a new table by joining columns (or variables) together. However, note that <code>bind_cols()</code> does not perform any kind of row-wise matching when joining tables.</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a>Bind_3 <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(wos_monthly_sun, wos_seasonal_sun)</span></code></pre></div>
<pre><code>## New names:
## * year -&gt; year...1
## * year -&gt; year...15</code></pre>
<p><code>bind_cols()</code>takes <code>wos_seasonal_sun</code> and puts it <em>right next</em> to <code>wos_monthly_sun</code>. Since the column name <code>year</code> is in both tables they get called <code>year..1</code> and <code>year...15</code> after their respective column number to differentiate them.</p>
<p>What happens if we attempt to bind tables with different dimensions</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a>Bind_4 <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(Summer_Sun, Summer_Rain)</span></code></pre></div>
<pre><code>## Error in `bind_cols()`:
## ! Can&#39;t recycle `..1` (size 102) to match `..2` (size 154).</code></pre>
<p>You simply get an error</p>
<div class="funfact">
<p>
By the way, you can merge as many data objects as you like with the
binding functions, whereas in the join functions, you are limited to
two. However, you could use a pipe to combine the merged dataframe with
a third.
</p>
<p>
example 1: bind_rows(data1, data2, data3) <br> example 2:
full_join(data1, data2) %&gt;% full_join(data3)
</p>
</div>
<p>Just to further clarify the differences between <code>bind_cols()</code> and the mutating joing verbs, lets look at how they would deal with the same challenge</p>
<p>First lets create a new table for winter sun data, but lets arrange it by “win”, so that rather than being in order of <code>year</code>, it is in order of most sunshine. This will have the same dimensions as the Summer_Sun table but a totally different order</p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a>Winter_Sun <span class="ot">&lt;-</span> wos_seasonal_sun <span class="sc">%&gt;%</span> </span>
<span id="cb246-2"><a href="#cb246-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(year, win) <span class="sc">%&gt;%</span></span>
<span id="cb246-3"><a href="#cb246-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(win))</span>
<span id="cb246-4"><a href="#cb246-4" aria-hidden="true" tabindex="-1"></a>Winter_Sun</span></code></pre></div>
<pre><code>## # A tibble: 102 x 2
##     year   win
##    &lt;dbl&gt; &lt;dbl&gt;
##  1  1963  204.
##  2  2018  170.
##  3  2003  169.
##  4  2001  166 
##  5  1965  165 
##  6  2004  163.
##  7  1978  159.
##  8  1968  159.
##  9  1970  158.
## 10  1996  156.
## # ... with 92 more rows</code></pre>
<p>Now lets try joining Winter_Sun and Summer_Sun using the two different methods</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a>Comparison_1 <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(Summer_Sun, Winter_Sun)</span></code></pre></div>
<pre><code>## New names:
## * year -&gt; year...1
## * year -&gt; year...3</code></pre>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a>Comparison_2 <span class="ot">&lt;-</span> <span class="fu">left_join</span>(Summer_Sun, Winter_Sun, <span class="st">&quot;year&quot;</span>)</span>
<span id="cb250-2"><a href="#cb250-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb250-3"><a href="#cb250-3" aria-hidden="true" tabindex="-1"></a>Comparison_1</span></code></pre></div>
<pre><code>## # A tibble: 102 x 4
##    year...1   sum year...3   win
##       &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;
##  1     1919  524.     1963  204.
##  2     1920  411.     2018  170.
##  3     1921  509      2003  169.
##  4     1922  385.     2001  166 
##  5     1923  327.     1965  165 
##  6     1924  329.     2004  163.
##  7     1925  529.     1978  159.
##  8     1926  512.     1968  159.
##  9     1927  446      1970  158.
## 10     1928  408.     1996  156.
## # ... with 92 more rows</code></pre>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a>Comparison_2</span></code></pre></div>
<pre><code>## # A tibble: 102 x 3
##     year   sum   win
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1  1919  524.  NA  
##  2  1920  411. 111. 
##  3  1921  509  104. 
##  4  1922  385. 102. 
##  5  1923  327.  77.2
##  6  1924  329. 117. 
##  7  1925  529.  87.5
##  8  1926  512.  91.1
##  9  1927  446  104. 
## 10  1928  408. 131. 
## # ... with 92 more rows</code></pre>
<div class="info">
<p>
Using bind_cols() simply “copy and pasted” the two tables together,
the fact that the rows were in different orders did not matter. On the
other hand, using left_join() meant that R compared the content of
“year” and matched them up, ignoring the fact that Winter_Sun was in a
different arrangement.
</p>
</div>
</div>
</div>
</div>
<div id="additional-information" class="section level2 hasAnchor" number="4.5">
<h2 class="hasAnchor"><span class="header-section-number">4.5</span> Additional information<a href="#additional-information" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Garrick Aden-Buie created some amazing gganimation gif to illustrate how the joins work. Check it out! <a href="https://www.garrickadenbuie.com/project/tidyexplain/" class="uri">https://www.garrickadenbuie.com/project/tidyexplain/</a></p>
</div>
<div id="summative-homework-1" class="section level2 hasAnchor" number="4.6">
<h2 class="hasAnchor"><span class="header-section-number">4.6</span> Summative Homework<a href="#summative-homework-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The second summative assignment is available on moodle now.</p>
<p>Good luck.</p>
<p>Check that your Rmd file knits into a html file before submitting. Upload your Rmd file (not the knitted html) to moodle.</p>
<!--chapter:end:04-dplyr_2.Rmd-->
</div>
</div>
<div id="data-transformation-3-tidy-data" class="section level1 hasAnchor" number="5">
<h1 class="hasAnchor"><span class="header-section-number">5</span> Data Transformation 3: Tidy Data<a href="#data-transformation-3-tidy-data" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="intended-learning-outcomes-5" class="section level2 unnumbered hasAnchor">
<h2 class="unnumbered hasAnchor">Intended Learning Outcomes<a href="#intended-learning-outcomes-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The whole purpose of the next two lecture is to tidy up dataframe and expose you to a bunch of useful functions that would make your daily life easier when dealing with your own data. By the end of today, you will know</p>
<ol style="list-style-type: decimal">
<li>How to rearrange data from long format into to wide format and vice versa</li>
<li>How to combine and separate columns</li>
</ol>
<p>This lesson is led by Johanna Werner</p>
</div>
<div id="pre-steps-3" class="section level2 hasAnchor" number="5.1">
<h2 class="hasAnchor"><span class="header-section-number">5.1</span> Pre-steps<a href="#pre-steps-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>All the functions for tidying data are within <code>tidyverse</code> so we need to make sure to load it into the library. Today’s lecture will make use of built-in dataframes but for practice examples, we may want to load in the West of Scotland seasonal sunshine and rain data you encountered last week.</p>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb254-2"><a href="#cb254-2" aria-hidden="true" tabindex="-1"></a>sun <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;wos_seasonal_sun.csv&quot;</span>)</span>
<span id="cb254-3"><a href="#cb254-3" aria-hidden="true" tabindex="-1"></a>rain <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;wos_seasonal_rain.csv&quot;</span>)</span></code></pre></div>
</div>
<div id="tidy-data" class="section level2 hasAnchor" number="5.2">
<h2 class="hasAnchor"><span class="header-section-number">5.2</span> Tidy data<a href="#tidy-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><em>“Happy families are all alike; every unhappy family is unhappy in its own way.”</em> – Leo Tolstoy</p>
<p><em>“Tidy datasets are all alike, but every messy dataset is messy in its own way.”</em> – Hadley Wickham</p>
<p>In this chapter, you will learn a consistent way to organise your data in R. Hadley Wickham and Garrett Grolemund call this <strong>tidy data</strong>. In most cases, data does not come in a tidy format. Researchers spend most of their time getting the data into the shape it needs to be for a particular analysis. The tools we introduce you to this week and next should form the basics for data wrangling. The idea is that tidy datasets are easier to work with in the long run.</p>
<p>There are three interrelated rules which make a dataset tidy:</p>
<ol style="list-style-type: decimal">
<li>Each variable must have its own column.</li>
<li>Each observation must have its own row.</li>
<li>Each value must have its own cell.</li>
</ol>
<p>If you want to know more about tidy data, Hadley Wickham’s paper can be found on <a href="https://vita.had.co.nz/papers/tidy-data.pdf" class="uri">https://vita.had.co.nz/papers/tidy-data.pdf</a> or check out chapter 12 in the book R for Data Science (<a href="https://r4ds.had.co.nz/tidy-data.html" class="uri">https://r4ds.had.co.nz/tidy-data.html</a>).</p>
<p>We will see today how <code>pivot_longer()</code>, <code>pivot_wider()</code>, <code>separate()</code>, and <code>unite()</code> can help us to get our data into a tidy format.</p>
</div>
<div id="pivot_longer-and-pivot_wider" class="section level2 hasAnchor" number="5.3">
<h2 class="hasAnchor"><span class="header-section-number">5.3</span> pivot_longer() and pivot_wider()<a href="#pivot_longer-and-pivot_wider" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><code>pivot_longer()</code> and <code>pivot_wider()</code> are part of <code>tidyr</code> (also part of the tidyverse package) and help you to rearrange the shape of your data. To get your data into long format, you would use <code>pivot_longer()</code>; if you wanted to get your data from long to wide format, you would need <code>pivot_wider()</code>. Here is a representation of data in wide format and in long format.</p>
<center>
<img src="images/original-dfs-tidy.png" >
</center>
<p>We cannot say “wide format is tidy” or “the data should always be in long format”; how your data needs to be formatted depends on your data (and the meaning). If x, y, and z are separate variables, then the data is tidy in the wide format as shown above; if x, y, and z are levels of a variable (<code>key</code> in the image above), you want to shape your data into long format.</p>
<p>The gif animation by Garrick Aden-Buie (<a href="https://www.garrickadenbuie.com/project/tidyexplain/#pivot-wider-and-longer" class="uri">https://www.garrickadenbuie.com/project/tidyexplain/#pivot-wider-and-longer</a>) shows you how <code>pivot_longer()</code> and <code>pivot_wider()</code> work by rearranging your data from wide to long format and vice versa.</p>
<center>
&lt;<a href="https://raw.githubusercontent.com/gadenbuie/tidyexplain/main/images/tidyr-pivoting.gif" class="uri">https://raw.githubusercontent.com/gadenbuie/tidyexplain/main/images/tidyr-pivoting.gif</a> &gt;
</center>
<div id="pivot_longer" class="section level3 hasAnchor" number="5.3.1">
<h3 class="hasAnchor"><span class="header-section-number">5.3.1</span> pivot_longer()<a href="#pivot_longer" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can start this lecture by looking at a practical example in the build-in datasets <code>table1</code> to <code>table5</code>. They show the number of Tuberculosis cases documented by the World Health Organization in Afghanistan, Brazil, and China between 1999 and 2000 (the full dataset is called <code>who</code>). The data is part of the <code>tidyverse</code> package, so as long as we have <code>tidyverse</code> loaded into the library, there should not be an issue in accessing this dataset.</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="#cb255-1" aria-hidden="true" tabindex="-1"></a>table1</span></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   country      year  cases population
##   &lt;chr&gt;       &lt;int&gt;  &lt;int&gt;      &lt;int&gt;
## 1 Afghanistan  1999    745   19987071
## 2 Afghanistan  2000   2666   20595360
## 3 Brazil       1999  37737  172006362
## 4 Brazil       2000  80488  174504898
## 5 China        1999 212258 1272915272
## 6 China        2000 213766 1280428583</code></pre>
<p><code>table1</code> has a very tidy structure as it follows the three principles above - each variable is its own column, each observation is its own row, and each value is its own cell.</p>
<center>
<img src="images/tidy_1.png" >
</center>
<p>You can see the data contains values associated with four variables (<code>country</code>, <code>year</code>, <code>cases</code>, and <code>population</code>). <code>table4a</code> however, looks a touch not right.</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="#cb257-1" aria-hidden="true" tabindex="-1"></a>table4a</span></code></pre></div>
<pre><code>## # A tibble: 3 x 3
##   country     `1999` `2000`
## * &lt;chr&gt;        &lt;int&gt;  &lt;int&gt;
## 1 Afghanistan    745   2666
## 2 Brazil       37737  80488
## 3 China       212258 213766</code></pre>
<center>
<img src="images/tidy_4a_1.png" >
</center>
<p>Somehow the values for the columns <code>year</code> and <code>cases</code> are missing and instead we find two separate columns for <code>1999</code> and <code>2000</code> that have all <code>cases</code> values listed. This is a problem as <code>1999</code> and <code>2000</code> are actual values and not variables. What we want to do, is pivot_longer <code>1999</code> and <code>2000</code> in one column <code>year</code> and respective values into a second column called <code>cases</code>.</p>
<center>
<img src="images/tidy_4a.png" >
</center>
<p>Currently the data is in what is called a <code>wide format</code>. The function <code>pivot_longer()</code> comes in handy when we want to get the data into the shape of a <code>long format</code> like in <code>table1</code>. <code>pivot_longer()</code> is structured like:</p>
<p><br></p>
<center>
<img src="images/gather.PNG" >
</center>
<p><br></p>
<p>Let’s apply this formula to <code>table4a</code></p>
<ul>
<li>We need a dataframe that we want to modify -&gt; <code>table4a</code></li>
<li>We need to come up with the name of a new column in which the values of 1999 and 2000 will be stored -&gt; <code>year</code></li>
<li>We need to come up with the name of a new column in which all the case values will be stored -&gt; <code>cases</code></li>
<li>And finally, we need to tell R which columns in <code>table4a</code> we want to turn into long format (i.e. the columns of the 7 subscales) -&gt; 1999 and 2000 (Note that “1999” and “2000” are non-syntactic names as they don’t start with a letter. The solution is to surround them in backticks.)Make sure to surround the new column names with quotation marks.</li>
</ul>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="#cb259-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pivot_longer</span>(table4a, <span class="at">cols =</span> <span class="st">`</span><span class="at">1999</span><span class="st">`</span><span class="sc">:</span><span class="st">`</span><span class="at">2000</span><span class="st">`</span> , <span class="at">names_to =</span> <span class="st">&quot;year&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;cases&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 3
##   country     year   cases
##   &lt;chr&gt;       &lt;chr&gt;  &lt;int&gt;
## 1 Afghanistan 1999     745
## 2 Afghanistan 2000    2666
## 3 Brazil      1999   37737
## 4 Brazil      2000   80488
## 5 China       1999  212258
## 6 China       2000  213766</code></pre>
<div class="task">
<p>
<strong>Your turn</strong>
</p>
<p>
Look at <code>table4b</code>. There are two separate columns
<code>1999</code> and <code>2000</code> with population values for
Afghanistan, Brazil, and China. Use the <code>pivot_longer()</code>
function on <code>table4b</code> to reshape it from wide format into
long format.
</p>
</div>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="#cb261-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pivot_longer</span>(table4b, <span class="at">cols=</span><span class="st">`</span><span class="at">1999</span><span class="st">`</span><span class="sc">:</span><span class="st">`</span><span class="at">2000</span><span class="st">`</span>,  <span class="at">names_to =</span><span class="st">&quot;year&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;population&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 3
##   country     year  population
##   &lt;chr&gt;       &lt;chr&gt;      &lt;int&gt;
## 1 Afghanistan 1999    19987071
## 2 Afghanistan 2000    20595360
## 3 Brazil      1999   172006362
## 4 Brazil      2000   174504898
## 5 China       1999  1272915272
## 6 China       2000  1280428583</code></pre>
</div>
<div class="task">
<p>
<strong>Your turn - Second example</strong>
</p>
<p>
Remember the sunshine and rain data from last week? Let’s have a look
at one of the datasets (your choice whether to look at <code>sun</code>
or <code>rain</code>). The data for <code>year</code>is in a tidy
format, but the seasonal data is spread over 4 columns
(<code>win</code>, <code>spr</code>, <code>sum</code>, and
<code>aut</code>) which is not tidy. Use <code>pivot_longer()</code> to
reshape the data into a tidier format. Store the output in the
<code>Global Environment</code> as an object called
<code>sun_tidy</code> or <code>rain_tidy</code>.
</p>
</div>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true" tabindex="-1"></a>sun_tidy <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(sun, <span class="at">cols=</span> win<span class="sc">:</span>aut, <span class="at">names_to =</span> <span class="st">&quot;season&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;sun&quot;</span>)</span>
<span id="cb263-2"><a href="#cb263-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sun_tidy)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 3
##    year season   sun
##   &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt;
## 1  1919 win      NA 
## 2  1919 spr     414.
## 3  1919 sum     524.
## 4  1919 aut     257.
## 5  1920 win     111.
## 6  1920 spr     328.</code></pre>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="#cb265-1" aria-hidden="true" tabindex="-1"></a>rain_tidy <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(rain, <span class="at">cols=</span> win<span class="sc">:</span>aut, <span class="at">names_to =</span> <span class="st">&quot;season&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;rain&quot;</span>)</span>
<span id="cb265-2"><a href="#cb265-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(rain_tidy)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 3
##    year season  rain
##   &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt;
## 1  1862 win      NA 
## 2  1862 spr     388.
## 3  1862 sum     426.
## 4  1862 aut     456.
## 5  1863 win     640.
## 6  1863 spr     292.</code></pre>
</div>
</div>
<div id="pivot_wider" class="section level3 hasAnchor" number="5.3.2">
<h3 class="hasAnchor"><span class="header-section-number">5.3.2</span> pivot_wider()<a href="#pivot_wider" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now onto the reverse. <code>pivot_wider()</code> will spread the data from <code>long</code> into <code>wide format</code>. When you have observations that are scattered across multiple rows, you can use <code>pivot_wider()</code> to split those rows up into separate variables. Let’s take a look at <code>table2</code>.</p>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="#cb267-1" aria-hidden="true" tabindex="-1"></a>table2</span></code></pre></div>
<pre><code>## # A tibble: 12 x 4
##    country      year type            count
##    &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;           &lt;int&gt;
##  1 Afghanistan  1999 cases             745
##  2 Afghanistan  1999 population   19987071
##  3 Afghanistan  2000 cases            2666
##  4 Afghanistan  2000 population   20595360
##  5 Brazil       1999 cases           37737
##  6 Brazil       1999 population  172006362
##  7 Brazil       2000 cases           80488
##  8 Brazil       2000 population  174504898
##  9 China        1999 cases          212258
## 10 China        1999 population 1272915272
## 11 China        2000 cases          213766
## 12 China        2000 population 1280428583</code></pre>
<center>
<img src="images/tidy_2_1.png" >
</center>
<p><code>table2</code> has the variables <code>cases</code> and <code>population</code> stored in one column <code>type</code> and their respective values in <code>count</code>. However, <code>cases</code> and <code>population</code> are separate variables rather than values of <code>type</code>. So best to get them spread out into their own columns as shown in the image below.</p>
<center>
<img src="images/tidy_2.png" >
</center>
<p>Take a look how <code>pivot_wider()</code> achieves that.</p>
<p><br></p>
<center>
<img src="images/spread.PNG" >
</center>
<p><br></p>
<p>Let’s apply the formula above to <code>table2</code>:</p>
<ul>
<li>We need a dataframe that we want to modify -&gt; <code>table2</code></li>
<li>We need to decide which of the columns in <code>table2</code> will become the new column headers -&gt; <code>type</code></li>
<li>We need to decide which of the columns in <code>table2</code> has all the data in it that will become the new cell values -&gt; <code>count</code></li>
</ul>
<p>When using <code>pivot_wider()</code>, make sure you do not surround the <code>names_from</code> and <code>values_from</code> arguments with quotation marks. They refer to existing columns rather than column names we have to create when using <code>pivot_longer()</code></p>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="#cb269-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pivot_wider</span>(table2, <span class="at">names_from =</span> type, <span class="at">values_from =</span> count)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   country      year  cases population
##   &lt;chr&gt;       &lt;int&gt;  &lt;int&gt;      &lt;int&gt;
## 1 Afghanistan  1999    745   19987071
## 2 Afghanistan  2000   2666   20595360
## 3 Brazil       1999  37737  172006362
## 4 Brazil       2000  80488  174504898
## 5 China        1999 212258 1272915272
## 6 China        2000 213766 1280428583</code></pre>
<p>Voila, <code>cases</code> and <code>population</code> are in their own columns.</p>
<p>Let me modify <code>table1</code> a tiny bit.</p>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="#cb271-1" aria-hidden="true" tabindex="-1"></a>table1_mod <span class="ot">&lt;-</span> table1 <span class="sc">%&gt;%</span> </span>
<span id="cb271-2"><a href="#cb271-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percent =</span> cases<span class="sc">/</span> population <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb271-3"><a href="#cb271-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span> cases<span class="sc">:</span>percent, <span class="at">names_to=</span> <span class="st">&quot;variable&quot;</span>, <span class="at">values_to=</span> <span class="st">&quot;values&quot;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">country</th>
<th align="right">year</th>
<th align="left">variable</th>
<th align="right">values</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Afghanistan</td>
<td align="right">1999</td>
<td align="left">cases</td>
<td align="right">7.450000e+02</td>
</tr>
<tr class="even">
<td align="left">Afghanistan</td>
<td align="right">1999</td>
<td align="left">population</td>
<td align="right">1.998707e+07</td>
</tr>
<tr class="odd">
<td align="left">Afghanistan</td>
<td align="right">1999</td>
<td align="left">percent</td>
<td align="right">3.727400e-03</td>
</tr>
<tr class="even">
<td align="left">Afghanistan</td>
<td align="right">2000</td>
<td align="left">cases</td>
<td align="right">2.666000e+03</td>
</tr>
<tr class="odd">
<td align="left">Afghanistan</td>
<td align="right">2000</td>
<td align="left">population</td>
<td align="right">2.059536e+07</td>
</tr>
<tr class="even">
<td align="left">Afghanistan</td>
<td align="right">2000</td>
<td align="left">percent</td>
<td align="right">1.294470e-02</td>
</tr>
<tr class="odd">
<td align="left">Brazil</td>
<td align="right">1999</td>
<td align="left">cases</td>
<td align="right">3.773700e+04</td>
</tr>
<tr class="even">
<td align="left">Brazil</td>
<td align="right">1999</td>
<td align="left">population</td>
<td align="right">1.720064e+08</td>
</tr>
<tr class="odd">
<td align="left">Brazil</td>
<td align="right">1999</td>
<td align="left">percent</td>
<td align="right">2.193930e-02</td>
</tr>
<tr class="even">
<td align="left">Brazil</td>
<td align="right">2000</td>
<td align="left">cases</td>
<td align="right">8.048800e+04</td>
</tr>
<tr class="odd">
<td align="left">Brazil</td>
<td align="right">2000</td>
<td align="left">population</td>
<td align="right">1.745049e+08</td>
</tr>
<tr class="even">
<td align="left">Brazil</td>
<td align="right">2000</td>
<td align="left">percent</td>
<td align="right">4.612360e-02</td>
</tr>
<tr class="odd">
<td align="left">China</td>
<td align="right">1999</td>
<td align="left">cases</td>
<td align="right">2.122580e+05</td>
</tr>
<tr class="even">
<td align="left">China</td>
<td align="right">1999</td>
<td align="left">population</td>
<td align="right">1.272915e+09</td>
</tr>
<tr class="odd">
<td align="left">China</td>
<td align="right">1999</td>
<td align="left">percent</td>
<td align="right">1.667500e-02</td>
</tr>
<tr class="even">
<td align="left">China</td>
<td align="right">2000</td>
<td align="left">cases</td>
<td align="right">2.137660e+05</td>
</tr>
<tr class="odd">
<td align="left">China</td>
<td align="right">2000</td>
<td align="left">population</td>
<td align="right">1.280429e+09</td>
</tr>
<tr class="even">
<td align="left">China</td>
<td align="right">2000</td>
<td align="left">percent</td>
<td align="right">1.669490e-02</td>
</tr>
</tbody>
</table>
<p>The output in <code>values</code> looks a bit strange now. This is just because the column <code>values</code> holds very large and very small numbers.</p>
<div class="task">
<p>
<strong>Your turn</strong>
</p>
<p>
In the modified table above <code>table1_mod</code>, we added a
<code>percent</code> column to see how much percentage of the population
had Tuberculosis in 1999 and 2000 in each of the countries Afghanistan,
Brazil, and China. But somehow, all numerical information has ended up
in 1 column (values).
</p>
<p>
Your task is to <code>pivot_wider</code> the data back out, so that
cases, population, and percentage values are in their own columns,
titled as <code>cases</code>, <code>population</code>, and
<code>percent</code> respectively. Store the new object in the
<code>Global Environment</code> as <code>table1_mod_corrected</code>.
When you are done, <code>table1_mod_corrected</code> should look like
this…
</p>
</div>
<table>
<thead>
<tr class="header">
<th align="left">country</th>
<th align="right">year</th>
<th align="right">cases</th>
<th align="right">population</th>
<th align="right">percent</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Afghanistan</td>
<td align="right">1999</td>
<td align="right">745</td>
<td align="right">19987071</td>
<td align="right">0.0037274</td>
</tr>
<tr class="even">
<td align="left">Afghanistan</td>
<td align="right">2000</td>
<td align="right">2666</td>
<td align="right">20595360</td>
<td align="right">0.0129447</td>
</tr>
<tr class="odd">
<td align="left">Brazil</td>
<td align="right">1999</td>
<td align="right">37737</td>
<td align="right">172006362</td>
<td align="right">0.0219393</td>
</tr>
<tr class="even">
<td align="left">Brazil</td>
<td align="right">2000</td>
<td align="right">80488</td>
<td align="right">174504898</td>
<td align="right">0.0461236</td>
</tr>
<tr class="odd">
<td align="left">China</td>
<td align="right">1999</td>
<td align="right">212258</td>
<td align="right">1272915272</td>
<td align="right">0.0166750</td>
</tr>
<tr class="even">
<td align="left">China</td>
<td align="right">2000</td>
<td align="right">213766</td>
<td align="right">1280428583</td>
<td align="right">0.0166949</td>
</tr>
</tbody>
</table>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="#cb272-1" aria-hidden="true" tabindex="-1"></a>table1_mod_corrected <span class="ot">&lt;-</span> <span class="fu">pivot_wider</span>(table1_mod, <span class="at">names_from =</span> variable, <span class="at">values_from =</span> values)</span></code></pre></div>
</div>
<div class="task">
<p>
<strong>Your turn - Second example</strong>
</p>
<center>
<img src="images/sneaky_fox_untidy.png" >
</center>
<p>
A sneaky fox came to your house and messed up all your tidy data.
Undo the works of the sneaky fox by reshaping the data in
<code>sun_fail</code> and <code>rain_fail</code> into a tidier format.
Store the tidier data in your <code>Global Environment</code> as
<code>sun_outfoxed</code> and <code>rain_outfoxed</code>.
</p>
<p>
Your final datasets should have the columns <code>year</code>,
<code>season</code>, and <code>sun</code> or <code>year</code>,
<code>season</code>, and <code>rain</code> in exactly that order.
</p>
</div>
<p>This is what the fox did:</p>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="#cb273-1" aria-hidden="true" tabindex="-1"></a>sun_fail <span class="ot">&lt;-</span> sun_tidy <span class="sc">%&gt;%</span> </span>
<span id="cb273-2"><a href="#cb273-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">408</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb273-3"><a href="#cb273-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="fu">c</span>(year, sun), <span class="at">names_to =</span> <span class="st">&quot;col_names&quot;</span>, <span class="at">values_to=</span><span class="st">&quot;values&quot;</span> )</span>
<span id="cb273-4"><a href="#cb273-4" aria-hidden="true" tabindex="-1"></a>rain_fail <span class="ot">&lt;-</span> rain_tidy <span class="sc">%&gt;%</span> </span>
<span id="cb273-5"><a href="#cb273-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">616</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb273-6"><a href="#cb273-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="fu">c</span>(year, rain), <span class="at">names_to =</span> <span class="st">&quot;col_names&quot;</span>, <span class="at">values_to=</span><span class="st">&quot;values&quot;</span>)</span></code></pre></div>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="#cb274-1" aria-hidden="true" tabindex="-1"></a>sun_outfoxed <span class="ot">&lt;-</span> <span class="fu">pivot_wider</span>(sun_fail, <span class="at">names_from =</span> col_names, <span class="at">values_from =</span> values) <span class="sc">%&gt;%</span> </span>
<span id="cb274-2"><a href="#cb274-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(year, season, sun)</span>
<span id="cb274-3"><a href="#cb274-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sun_outfoxed)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 3
##    year season   sun
##   &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt;
## 1  1919 win      NA 
## 2  1919 spr     414.
## 3  1919 sum     524.
## 4  1919 aut     257.
## 5  1920 win     111.
## 6  1920 spr     328.</code></pre>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="#cb276-1" aria-hidden="true" tabindex="-1"></a>rain_outfoxed <span class="ot">&lt;-</span> <span class="fu">pivot_wider</span>(rain_fail, <span class="at">names_from =</span> col_names, <span class="at">values_from =</span> values) <span class="sc">%&gt;%</span> </span>
<span id="cb276-2"><a href="#cb276-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(year, season, rain)</span>
<span id="cb276-3"><a href="#cb276-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(rain_outfoxed)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 3
##    year season  rain
##   &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt;
## 1  1862 win      NA 
## 2  1862 spr     388.
## 3  1862 sum     426.
## 4  1862 aut     456.
## 5  1863 win     640.
## 6  1863 spr     292.</code></pre>
</div>
</div>
</div>
<div id="separate-and-unite" class="section level2 hasAnchor" number="5.4">
<h2 class="hasAnchor"><span class="header-section-number">5.4</span> separate() and unite()<a href="#separate-and-unite" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><code>separate()</code> turns a single character column into multiple columns, whereas <code>unite()</code> combines the values of multiple columns into one column.</p>
<div id="separate" class="section level3 hasAnchor" number="5.4.1">
<h3 class="hasAnchor"><span class="header-section-number">5.4.1</span> separate()<a href="#separate" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Take a look at <code>table3</code>.</p>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="#cb278-1" aria-hidden="true" tabindex="-1"></a>table3</span></code></pre></div>
<pre><code>## # A tibble: 6 x 3
##   country      year rate             
## * &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;            
## 1 Afghanistan  1999 745/19987071     
## 2 Afghanistan  2000 2666/20595360    
## 3 Brazil       1999 37737/172006362  
## 4 Brazil       2000 80488/174504898  
## 5 China        1999 212258/1272915272
## 6 China        2000 213766/1280428583</code></pre>
<p>In <code>table3</code>, two out of three principles of tidy data are violated. There are multiple values stored in column <code>rate</code> (rule 3) but these multiple values also belong to two different variables - <code>cases</code> and <code>population</code> respectively (rule 1).</p>
<center>
<img src="images/tidy_3_1.png" >
</center>
<p>Here, we would use <code>separate()</code> to split the column <code>rate</code> into two columns <code>cases</code> and <code>population</code>.</p>
<center>
<img src="images/tidy_3.png" >
</center>
<p>The function <code>separate()</code> is structured like this:</p>
<p><br></p>
<center>
<img src="images/separate.PNG" >
</center>
<p><br></p>
<p>We would need</p>
<ul>
<li>the data in which the column to separate is located -&gt; <code>table3</code>,</li>
<li>the actual column we want to separate -&gt; <code>rate</code>,</li>
<li>the into argument asking into how many columns we want to separate the old column and what we want to call these new columns -&gt; <code>c("cases", "population")</code>, and</li>
<li>a separator argument -&gt; <code>"/"</code>.</li>
</ul>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="#cb280-1" aria-hidden="true" tabindex="-1"></a><span class="fu">separate</span>(table3, rate, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;cases&quot;</span>, <span class="st">&quot;population&quot;</span>), <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   country      year cases  population
##   &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;  &lt;chr&gt;     
## 1 Afghanistan  1999 745    19987071  
## 2 Afghanistan  2000 2666   20595360  
## 3 Brazil       1999 37737  172006362 
## 4 Brazil       2000 80488  174504898 
## 5 China        1999 212258 1272915272
## 6 China        2000 213766 1280428583</code></pre>
<p>R has put all cell information before the <code>/</code> into a column we named <code>cases</code>, and everything after the <code>/</code> into the column we decided to call <code>population</code>. <code>/</code> will not appear in either column <code>cases</code> or <code>population</code>. The data is now in a tidy format.</p>
<div class="info">
<p>
By the way, the separator argument <code>sep =</code> can be any
non-alphanumeric character, for example:
</p>
<ul>
<li>
underscore (“_“),
</li>
<li>
comma (“,”),
</li>
<li>
semi-colon (“;”),
</li>
<li>
colon (“:”),
</li>
<li>
forward-slash (“/”),
</li>
<li>
space (” “) or
</li>
<li>
nothing (““).
</li>
</ul>
<p>
But watch out! When the separator is a <code>full stop</code>, you
would need to add a double backward slash in front of it
(<code>sep = “\\.”</code>).
</p>
</div>
</div>
<div id="additional-arguments-for-separate" class="section level3 hasAnchor" number="5.4.2">
<h3 class="hasAnchor"><span class="header-section-number">5.4.2</span> additional arguments for separate()<a href="#additional-arguments-for-separate" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="retaining-the-original-column" class="section level4 hasAnchor" number="5.4.2.1">
<h4 class="hasAnchor"><span class="header-section-number">5.4.2.1</span> Retaining the original column<a href="#retaining-the-original-column" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>If for some reason, you wanted to keep the original column, you can set an additional argument <code>remove</code> to <code>FALSE</code>.</p>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="#cb282-1" aria-hidden="true" tabindex="-1"></a><span class="fu">separate</span>(table3, rate, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;cases&quot;</span>, <span class="st">&quot;population&quot;</span>), <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 5
##   country      year rate              cases  population
##   &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;             &lt;chr&gt;  &lt;chr&gt;     
## 1 Afghanistan  1999 745/19987071      745    19987071  
## 2 Afghanistan  2000 2666/20595360     2666   20595360  
## 3 Brazil       1999 37737/172006362   37737  172006362 
## 4 Brazil       2000 80488/174504898   80488  174504898 
## 5 China        1999 212258/1272915272 212258 1272915272
## 6 China        2000 213766/1280428583 213766 1280428583</code></pre>
</div>
<div id="dropping-parts-of-the-original-column" class="section level4 hasAnchor" number="5.4.2.2">
<h4 class="hasAnchor"><span class="header-section-number">5.4.2.2</span> Dropping parts of the original column<a href="#dropping-parts-of-the-original-column" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>What if we were just interested retaining part of the data in the cell, for example keeping the column <code>cases</code> but not <code>population</code>. The solution would be to work with an <code>NA</code> argument. Defining the new columns as <code>cases</code> and <code>NA</code> will keep everything before the separator in the column <code>cases</code>, and drops everything after the separator.</p>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="#cb284-1" aria-hidden="true" tabindex="-1"></a><span class="fu">separate</span>(table3, rate, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;cases&quot;</span>, <span class="cn">NA</span>), <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 3
##   country      year cases 
##   &lt;chr&gt;       &lt;int&gt; &lt;chr&gt; 
## 1 Afghanistan  1999 745   
## 2 Afghanistan  2000 2666  
## 3 Brazil       1999 37737 
## 4 Brazil       2000 80488 
## 5 China        1999 212258
## 6 China        2000 213766</code></pre>
<div class="task">
<p>
<strong>Your turn</strong>
</p>
<p>
Separate the column <code>rate</code> in <code>table3</code> to keep
only the values after the separator in a column called
<code>population</code>. Drop the values in front of the separator.
Retain the column <code>rate</code> as well.
</p>
</div>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="#cb286-1" aria-hidden="true" tabindex="-1"></a><span class="fu">separate</span>(table3, rate, <span class="at">into =</span> <span class="fu">c</span>(<span class="cn">NA</span>, <span class="st">&quot;population&quot;</span>), <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   country      year rate              population
##   &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;             &lt;chr&gt;     
## 1 Afghanistan  1999 745/19987071      19987071  
## 2 Afghanistan  2000 2666/20595360     20595360  
## 3 Brazil       1999 37737/172006362   172006362 
## 4 Brazil       2000 80488/174504898   174504898 
## 5 China        1999 212258/1272915272 1272915272
## 6 China        2000 213766/1280428583 1280428583</code></pre>
</div>
</div>
<div id="separating-by-position" class="section level4 hasAnchor" number="5.4.2.3">
<h4 class="hasAnchor"><span class="header-section-number">5.4.2.3</span> Separating by position<a href="#separating-by-position" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>It is also possible to separate by position. <code>sep = 2</code> would split the column between the second and third character/ number etc.</p>
<p>Let’s try that the separation by position. We will keep 4 letters from each <code>country</code> name rather than the whole word, and drop the rest.</p>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="#cb288-1" aria-hidden="true" tabindex="-1"></a><span class="fu">separate</span>(table3, country, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;country&quot;</span>, <span class="cn">NA</span>), <span class="at">sep =</span> <span class="dv">4</span>)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 3
##   country  year rate             
##   &lt;chr&gt;   &lt;int&gt; &lt;chr&gt;            
## 1 Afgh     1999 745/19987071     
## 2 Afgh     2000 2666/20595360    
## 3 Braz     1999 37737/172006362  
## 4 Braz     2000 80488/174504898  
## 5 Chin     1999 212258/1272915272
## 6 Chin     2000 213766/1280428583</code></pre>
</div>
<div id="separating-into-more-than-2-columns" class="section level4 hasAnchor" number="5.4.2.4">
<h4 class="hasAnchor"><span class="header-section-number">5.4.2.4</span> Separating into more than 2 columns<a href="#separating-into-more-than-2-columns" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Special case. Let’s modify <code>table3</code> a little bit by adding a new column with a value of 200 and unite that column with column <code>rate</code>.</p>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="#cb290-1" aria-hidden="true" tabindex="-1"></a>table3_mod <span class="ot">&lt;-</span> table3 <span class="sc">%&gt;%</span> </span>
<span id="cb290-2"><a href="#cb290-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">new =</span> <span class="dv">200</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb290-3"><a href="#cb290-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(rate, rate, new, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>)</span></code></pre></div>
<p>Now column <code>rate</code> has 3 sets of numbers, separated by two <code>/</code>. If we define we want to split the data into 2 columns, the first 2 sets of numbers are kept, and the third one is dropped with a warning. The code is still executed but the warning indicates that it might not have gone as planned. Hence, it is always good to check that the data object in the <code>Global Environment</code> looks exactly as what you have intended.</p>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="#cb291-1" aria-hidden="true" tabindex="-1"></a><span class="fu">separate</span>(table3_mod, rate, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;cases&quot;</span>, <span class="st">&quot;population&quot;</span>), <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Expected 2 pieces. Additional pieces discarded in 6 rows [1, 2, 3, 4,
## 5, 6].</code></pre>
<pre><code>## # A tibble: 6 x 4
##   country      year cases  population
##   &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;  &lt;chr&gt;     
## 1 Afghanistan  1999 745    19987071  
## 2 Afghanistan  2000 2666   20595360  
## 3 Brazil       1999 37737  172006362 
## 4 Brazil       2000 80488  174504898 
## 5 China        1999 212258 1272915272
## 6 China        2000 213766 1280428583</code></pre>
<p>If we are separating the columns and wanted to keep all sets of numbers, one in each column, we would use an into argument that includes 3 new columns.</p>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="#cb294-1" aria-hidden="true" tabindex="-1"></a><span class="fu">separate</span>(table3_mod, rate, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;cases&quot;</span>, <span class="st">&quot;population&quot;</span>, <span class="st">&quot;200&quot;</span>), <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 5
##   country      year cases  population `200`
##   &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;  &lt;chr&gt;      &lt;chr&gt;
## 1 Afghanistan  1999 745    19987071   200  
## 2 Afghanistan  2000 2666   20595360   200  
## 3 Brazil       1999 37737  172006362  200  
## 4 Brazil       2000 80488  174504898  200  
## 5 China        1999 212258 1272915272 200  
## 6 China        2000 213766 1280428583 200</code></pre>
<div class="funfact">
<p>
Technically, you would not need a separator argument in the case
above, as <code>separate()</code> splits the data whenever it detects a
non-alphanumeric character (i.e. a character that isn’t a number or
letter). Saying that, the separator argument is needed when your column
contains non-alphanumeric characters as part of your cell values.
</p>
</div>
<p>If the values in <code>population</code> and <code>200</code> (separated by a <code>/</code>) were some sort of <code>ID_code</code>, <strong>AND</strong> we wanted to split the data into 2 columns, after the first <code>/</code> only, we would have to include an <code>extra</code> argument, and set it to <code>"merge"</code>.</p>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="#cb296-1" aria-hidden="true" tabindex="-1"></a><span class="fu">separate</span>(table3_mod, rate, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;cases&quot;</span>, <span class="st">&quot;ID_code&quot;</span>), <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>, <span class="at">extra =</span> <span class="st">&quot;merge&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   country      year cases  ID_code       
##   &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;  &lt;chr&gt;         
## 1 Afghanistan  1999 745    19987071/200  
## 2 Afghanistan  2000 2666   20595360/200  
## 3 Brazil       1999 37737  172006362/200 
## 4 Brazil       2000 80488  174504898/200 
## 5 China        1999 212258 1272915272/200
## 6 China        2000 213766 1280428583/200</code></pre>
<div class="question">
<p>
There is still a tiny bit off in data above. Can you spot what it is?
* Hint: Think about if you wanted to sum up all the TB cases occurred in
the 3 countries within the years 1999, and 2000.
</p>
</div>
<div class="webex-solution">
<button>
Solution
</button>
<div class="solved">
<p>
The new columns <code>ID_code</code> and <code>cases</code> are
<code>character</code> columns. Whilst this is fine for
<code>ID_code</code>, it is less beneficial for <code>cases.</code> If
we wanted to sum up the cases column, values would need to be
<code>numerical</code>. We could use the converting function
<code>as.integer()</code>.
</p>
</div>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="#cb298-1" aria-hidden="true" tabindex="-1"></a>table3_mod <span class="sc">%&gt;%</span> </span>
<span id="cb298-2"><a href="#cb298-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(rate, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;cases&quot;</span>, <span class="st">&quot;ID_code&quot;</span>), <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>, <span class="at">extra =</span> <span class="st">&quot;merge&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb298-3"><a href="#cb298-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cases =</span> <span class="fu">as.integer</span>(cases))</span></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   country      year  cases ID_code       
##   &lt;chr&gt;       &lt;int&gt;  &lt;int&gt; &lt;chr&gt;         
## 1 Afghanistan  1999    745 19987071/200  
## 2 Afghanistan  2000   2666 20595360/200  
## 3 Brazil       1999  37737 172006362/200 
## 4 Brazil       2000  80488 174504898/200 
## 5 China        1999 212258 1272915272/200
## 6 China        2000 213766 1280428583/200</code></pre>
</div>
</div>
<div id="converting-data-types" class="section level4 hasAnchor" number="5.4.2.5">
<h4 class="hasAnchor"><span class="header-section-number">5.4.2.5</span> Converting data types<a href="#converting-data-types" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The slightly quicker and perhaps more elegant solution would be to add another argument <code>convert</code> to <code>separate()</code> and set it to <code>TRUE</code>. This will convert <code>cases</code> to <code>integer</code> and leave <code>ID_code</code> as <code>character</code> due to the non-numerical <code>/</code>.</p>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="#cb300-1" aria-hidden="true" tabindex="-1"></a>table3_mod <span class="sc">%&gt;%</span> </span>
<span id="cb300-2"><a href="#cb300-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(rate, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;cases&quot;</span>, <span class="st">&quot;ID_code&quot;</span>), <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>, <span class="at">extra =</span> <span class="st">&quot;merge&quot;</span>, <span class="at">convert =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   country      year  cases ID_code       
##   &lt;chr&gt;       &lt;int&gt;  &lt;int&gt; &lt;chr&gt;         
## 1 Afghanistan  1999    745 19987071/200  
## 2 Afghanistan  2000   2666 20595360/200  
## 3 Brazil       1999  37737 172006362/200 
## 4 Brazil       2000  80488 174504898/200 
## 5 China        1999 212258 1272915272/200
## 6 China        2000 213766 1280428583/200</code></pre>
</div>
</div>
<div id="unite" class="section level3 hasAnchor" number="5.4.3">
<h3 class="hasAnchor"><span class="header-section-number">5.4.3</span> unite()<a href="#unite" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Take a look at <code>table5</code>.</p>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="#cb302-1" aria-hidden="true" tabindex="-1"></a>table5</span></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   country     century year  rate             
## * &lt;chr&gt;       &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;            
## 1 Afghanistan 19      99    745/19987071     
## 2 Afghanistan 20      00    2666/20595360    
## 3 Brazil      19      99    37737/172006362  
## 4 Brazil      20      00    80488/174504898  
## 5 China       19      99    212258/1272915272
## 6 China       20      00    213766/1280428583</code></pre>
<p>Here the values in column <code>year</code> are split into <code>century</code> and <code>year</code> which is not very useful. Best to merge the 2 columns together as shown in the image below.</p>
<center>
<img src="images/tidy_5.png" >
</center>
<p><code>unite()</code> (the inverse of separate) can help to combine the values of <code>century</code> and <code>year</code> into a single column. It is used less frequently than it’s counterpart, but is still a useful function to know.</p>
<p>The function <code>unite()</code> is structured like this:</p>
<p><br></p>
<center>
<img src="images/unite.PNG" >
</center>
<p><br></p>
<p>We would need the data <code>table5</code>, a new column we want to create <code>year</code>, the two columns we would like to combine (<code>century</code> and <code>year</code>), and define the separator as “nothing” since the default is sep = “_“.</p>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb304-1"><a href="#cb304-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unite</span>(table5, year, century, year, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 3
##   country     year  rate             
##   &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;            
## 1 Afghanistan 1999  745/19987071     
## 2 Afghanistan 2000  2666/20595360    
## 3 Brazil      1999  37737/172006362  
## 4 Brazil      2000  80488/174504898  
## 5 China       1999  212258/1272915272
## 6 China       2000  213766/1280428583</code></pre>
<p>Yay! The data of <code>table5</code> is in a tidier format now - at least for column <code>year</code>. Ah, but we didn’t save the changes as an object in our <code>Global Environment</code>.</p>
<div class="task">
<p>
<strong>Your turn</strong>
</p>
<p>
Let’s combine the two steps of tidying <code>table5</code> in a
single pipe <code>%&gt;%</code> - separate the <code>rate</code> column
into <code>cases</code> and <code>population</code>, and unite the
columns <code>year</code> and <code>century</code> into a new column
<code>year</code>. Store the new object as <code>tb_cases</code> in the
<code>Global Environment</code>. Make sure, the columns
<code>cases</code> and <code>population</code> are <code>integer</code>
values.
</p>
</div>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="#cb306-1" aria-hidden="true" tabindex="-1"></a>tb_cases <span class="ot">&lt;-</span> table5 <span class="sc">%&gt;%</span> </span>
<span id="cb306-2"><a href="#cb306-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(rate, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;cases&quot;</span>, <span class="st">&quot;population&quot;</span>), <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>, <span class="at">convert =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb306-3"><a href="#cb306-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(year, century, year, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb306-4"><a href="#cb306-4" aria-hidden="true" tabindex="-1"></a>tb_cases</span></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   country     year   cases population
##   &lt;chr&gt;       &lt;chr&gt;  &lt;int&gt;      &lt;int&gt;
## 1 Afghanistan 1999     745   19987071
## 2 Afghanistan 2000    2666   20595360
## 3 Brazil      1999   37737  172006362
## 4 Brazil      2000   80488  174504898
## 5 China       1999  212258 1272915272
## 6 China       2000  213766 1280428583</code></pre>
</div>
<div class="info">
<p>
The year column is still a <code>character</code> column. In this
case, it does not matter too much, as 1999 and 2000 are levels of the
column <code>year</code> and very unlikely to be involved in any
calculations. In case we are dealing with actual numerical value and
have the need to convert the data type, we need to use the function
<code>as.integer()</code> as unite does not have a <code>convert</code>
argument available.
</p>
</div>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb308-1"><a href="#cb308-1" aria-hidden="true" tabindex="-1"></a>tb_cases_converted <span class="ot">&lt;-</span> tb_cases <span class="sc">%&gt;%</span> </span>
<span id="cb308-2"><a href="#cb308-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">as.integer</span>(year))</span>
<span id="cb308-3"><a href="#cb308-3" aria-hidden="true" tabindex="-1"></a>tb_cases_converted</span></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   country      year  cases population
##   &lt;chr&gt;       &lt;int&gt;  &lt;int&gt;      &lt;int&gt;
## 1 Afghanistan  1999    745   19987071
## 2 Afghanistan  2000   2666   20595360
## 3 Brazil       1999  37737  172006362
## 4 Brazil       2000  80488  174504898
## 5 China        1999 212258 1272915272
## 6 China        2000 213766 1280428583</code></pre>
</div>
<div id="additional-arguments-for-unite" class="section level3 hasAnchor" number="5.4.4">
<h3 class="hasAnchor"><span class="header-section-number">5.4.4</span> additional arguments for unite()<a href="#additional-arguments-for-unite" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="retaining-the-original-column-1" class="section level4 hasAnchor" number="5.4.4.1">
<h4 class="hasAnchor"><span class="header-section-number">5.4.4.1</span> Retaining the original column<a href="#retaining-the-original-column-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Similarly to <code>separate()</code>, unite also comes with a remove statement, so if you wanted to keep the original columns before merging them together, you would code</p>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="#cb310-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unite</span>(table5, year_combined, century, year, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>, <span class="at">remove =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 5
##   country     year_combined century year  rate             
##   &lt;chr&gt;       &lt;chr&gt;         &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;            
## 1 Afghanistan 1999          19      99    745/19987071     
## 2 Afghanistan 2000          20      00    2666/20595360    
## 3 Brazil      1999          19      99    37737/172006362  
## 4 Brazil      2000          20      00    80488/174504898  
## 5 China       1999          19      99    212258/1272915272
## 6 China       2000          20      00    213766/1280428583</code></pre>
</div>
<div id="removing-missing-values-before-uniting-columns" class="section level4 hasAnchor" number="5.4.4.2">
<h4 class="hasAnchor"><span class="header-section-number">5.4.4.2</span> Removing missing values before uniting columns<a href="#removing-missing-values-before-uniting-columns" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><code>unite()</code> also comes with an <code>na.rm</code> statement that will remove missing values prior to uniting the values of a column (actually, the values have to be a “character” column). Let me modify <code>table5</code> a wee bit to make that point.</p>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb312-1"><a href="#cb312-1" aria-hidden="true" tabindex="-1"></a>table5_mod <span class="ot">&lt;-</span> table5 <span class="sc">%&gt;%</span> </span>
<span id="cb312-2"><a href="#cb312-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">new =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;200&quot;</span>, <span class="cn">NA</span>), <span class="dv">3</span>))</span>
<span id="cb312-3"><a href="#cb312-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb312-4"><a href="#cb312-4" aria-hidden="true" tabindex="-1"></a>table5_mod</span></code></pre></div>
<pre><code>## # A tibble: 6 x 5
##   country     century year  rate              new  
##   &lt;chr&gt;       &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;             &lt;chr&gt;
## 1 Afghanistan 19      99    745/19987071      200  
## 2 Afghanistan 20      00    2666/20595360     &lt;NA&gt; 
## 3 Brazil      19      99    37737/172006362   200  
## 4 Brazil      20      00    80488/174504898   &lt;NA&gt; 
## 5 China       19      99    212258/1272915272 200  
## 6 China       20      00    213766/1280428583 &lt;NA&gt;</code></pre>
<p>If we wanted to combine the values of <code>rate</code> and <code>new</code>, we would code</p>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb314-1"><a href="#cb314-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unite</span>(table5_mod, rate, rate, new, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   country     century year  rate                 
##   &lt;chr&gt;       &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;                
## 1 Afghanistan 19      99    745/19987071/200     
## 2 Afghanistan 20      00    2666/20595360/NA     
## 3 Brazil      19      99    37737/172006362/200  
## 4 Brazil      20      00    80488/174504898/NA   
## 5 China       19      99    212258/1272915272/200
## 6 China       20      00    213766/1280428583/NA</code></pre>
<p>See how R adds the missing values onto rate, which we do not want. To avoid that happening, we can use the <code>na.rm</code> statement which removes missing values in columns of data type character before merging the columns.</p>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb316-1"><a href="#cb316-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unite</span>(table5_mod, rate, rate, new, <span class="at">sep =</span> <span class="st">&quot;/&quot;</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   country     century year  rate                 
##   &lt;chr&gt;       &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;                
## 1 Afghanistan 19      99    745/19987071/200     
## 2 Afghanistan 20      00    2666/20595360        
## 3 Brazil      19      99    37737/172006362/200  
## 4 Brazil      20      00    80488/174504898      
## 5 China       19      99    212258/1272915272/200
## 6 China       20      00    213766/1280428583</code></pre>
</div>
</div>
</div>
<div id="bonus-materials-mutate-row-names-from-the-mtcars" class="section level2 hasAnchor" number="5.5">
<h2 class="hasAnchor"><span class="header-section-number">5.5</span> Bonus materials: mutate row names from the <code>mtcars</code><a href="#bonus-materials-mutate-row-names-from-the-mtcars" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Remember, in lecture 2 when we were talking about the <code>mtcars</code> dataset and how the car types were not in listed as a separate column but rather row names? Let’s just read in the data and have another quick look to jog our memories…</p>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb318-1"><a href="#cb318-1" aria-hidden="true" tabindex="-1"></a>df_mtcars <span class="ot">&lt;-</span> mtcars</span>
<span id="cb318-2"><a href="#cb318-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-3"><a href="#cb318-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_mtcars)</span></code></pre></div>
<pre><code>##                    mpg cyl disp  hp drat    wt  qsec vs am gear carb
## Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
## Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
## Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
## Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1
## Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2
## Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1</code></pre>
<p>You can see much better what I’m talking about when you view your <code>df_mtcars</code>.</p>
<p>Now, that we have learnt about the <code>mutate()</code> function, we can attempt to get all of these row names into a new column. All we have to do is combining a function called <code>rownames()</code> with <code>mutate()</code>. We also could use some more of these handy pipes <code>%&gt;%</code> you learnt about last week.</p>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb320-1"><a href="#cb320-1" aria-hidden="true" tabindex="-1"></a>df_mtcars <span class="ot">&lt;-</span> mtcars <span class="sc">%&gt;%</span> </span>
<span id="cb320-2"><a href="#cb320-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Car_type =</span> <span class="fu">rownames</span>(mtcars))</span></code></pre></div>
<p>In this example, we have taken the dataset <code>mtcars</code>, then added a new column called <code>Car_type</code> with <code>mutate()</code>. The column <code>Car_type</code> should then hold all the values that were previously listed as the row names in the original <code>mtcars</code> data.</p>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="#cb321-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_mtcars)</span></code></pre></div>
<pre><code>##                    mpg cyl disp  hp drat    wt  qsec vs am gear carb
## Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
## Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
## Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
## Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1
## Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2
## Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1
##                            Car_type
## Mazda RX4                 Mazda RX4
## Mazda RX4 Wag         Mazda RX4 Wag
## Datsun 710               Datsun 710
## Hornet 4 Drive       Hornet 4 Drive
## Hornet Sportabout Hornet Sportabout
## Valiant                     Valiant</code></pre>
<div class="question">
<p>
We can now look at the data <code>df_mtcars</code>, and see that the
new column was added at the end of the dataset. What would we have to do
to make <code>Car_type</code> the first column in the dataframe?
</p>
</div>
<div class="webex-solution">
<button>
Answer
</button>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="#cb323-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We could use the fuction select()</span></span>
<span id="cb323-2"><a href="#cb323-2" aria-hidden="true" tabindex="-1"></a>df_mtcars <span class="ot">&lt;-</span> mtcars <span class="sc">%&gt;%</span> </span>
<span id="cb323-3"><a href="#cb323-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Car_type =</span> <span class="fu">rownames</span>(mtcars)) <span class="sc">%&gt;%</span> </span>
<span id="cb323-4"><a href="#cb323-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Car_type, mpg<span class="sc">:</span>carb)</span>
<span id="cb323-5"><a href="#cb323-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb323-6"><a href="#cb323-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_mtcars)</span></code></pre></div>
<pre><code>##                            Car_type  mpg cyl disp  hp drat    wt  qsec vs am
## Mazda RX4                 Mazda RX4 21.0   6  160 110 3.90 2.620 16.46  0  1
## Mazda RX4 Wag         Mazda RX4 Wag 21.0   6  160 110 3.90 2.875 17.02  0  1
## Datsun 710               Datsun 710 22.8   4  108  93 3.85 2.320 18.61  1  1
## Hornet 4 Drive       Hornet 4 Drive 21.4   6  258 110 3.08 3.215 19.44  1  0
## Hornet Sportabout Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0
## Valiant                     Valiant 18.1   6  225 105 2.76 3.460 20.22  1  0
##                   gear carb
## Mazda RX4            4    4
## Mazda RX4 Wag        4    4
## Datsun 710           4    1
## Hornet 4 Drive       3    1
## Hornet Sportabout    3    2
## Valiant              3    1</code></pre>
</div>
</div>
<div id="additional-information-1" class="section level2 hasAnchor" number="5.6">
<h2 class="hasAnchor"><span class="header-section-number">5.6</span> Additional information<a href="#additional-information-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>More information on stuff we covered today and beyond can be found here:</p>
<ul>
<li><a href="https://r4ds.had.co.nz" class="uri">https://r4ds.had.co.nz</a> “R 4 Data Science” by Garrett Grolemund and Hadley Wickham is the official guidebook for R</li>
<li><a href="https://suzan.rbind.io/categories/tutorial/" class="uri">https://suzan.rbind.io/categories/tutorial/</a> She has some pretty cool tutorials on data wrangling</li>
</ul>
</div>
<div id="formative-homework-2" class="section level2 hasAnchor" number="5.7">
<h2 class="hasAnchor"><span class="header-section-number">5.7</span> Formative Homework<a href="#formative-homework-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The formative assessment can now be downloaded from moodle. There is no need to submit your answers to moodle.</p>
<!--chapter:end:05-dplyr_3.Rmd-->
</div>
</div>
<div id="data-transformation-4-fine-tuned-data-manipulation" class="section level1 hasAnchor" number="6">
<h1 class="hasAnchor"><span class="header-section-number">6</span> Data Transformation 4: Fine-tuned Data Manipulation<a href="#data-transformation-4-fine-tuned-data-manipulation" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="intended-learning-outcomes-6" class="section level2 unnumbered hasAnchor">
<h2 class="unnumbered hasAnchor">Intended Learning Outcomes<a href="#intended-learning-outcomes-6" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The whole purpose of this lecture is to expose you to a couple of useful functions that would make your daily life easier when dealing with your own data. By the end of today, you will know</p>
<ol style="list-style-type: decimal">
<li>How to rename column headers</li>
<li>How to recode cell values based on conditions</li>
<li>How to obtain unique values from your data</li>
</ol>
<p>This lesson is led by Johanna Werner</p>
</div>
<div id="pre-steps-4" class="section level2 hasAnchor" number="6.1">
<h2 class="hasAnchor"><span class="header-section-number">6.1</span> Pre-steps<a href="#pre-steps-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Before we can start to focus on some other functions that might come in handy for data manipulation, we need to make sure to load <code>tidyverse</code> into the library.</p>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="#cb325-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
</div>
<div id="rename" class="section level2 hasAnchor" number="6.2">
<h2 class="hasAnchor"><span class="header-section-number">6.2</span> rename()<a href="#rename" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><code>rename()</code> is a very useful function if we wanted to change column names. All available column are retained, so nothing is lost. If you had 5 variables in a tibble, and wanted to change the name of one of them, your output would be 5 columns in total - one column with a changed name and 4 columns with the previous names. The <code>rename()</code> function follows a very simple pattern of</p>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb326-1"><a href="#cb326-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rename</span>(data, <span class="at">new_column_name =</span> old_column_name)</span></code></pre></div>
<p>You can rename multiple column headers by including more arguments, separating them with a comma. Let’s take a look at a simple example in <code>table1</code>.</p>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb327-1"><a href="#cb327-1" aria-hidden="true" tabindex="-1"></a>table1</span></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   country      year  cases population
##   &lt;chr&gt;       &lt;int&gt;  &lt;int&gt;      &lt;int&gt;
## 1 Afghanistan  1999    745   19987071
## 2 Afghanistan  2000   2666   20595360
## 3 Brazil       1999  37737  172006362
## 4 Brazil       2000  80488  174504898
## 5 China        1999 212258 1272915272
## 6 China        2000 213766 1280428583</code></pre>
<p>If we wanted to change the column headers of <code>country</code> to <code>Country</code> and <code>population</code> to <code>Population</code>, and keep the columns <code>year</code> and <code>cases</code> as they are, we would code</p>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="#cb329-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rename</span>(table1, <span class="at">Country =</span> country,</span>
<span id="cb329-2"><a href="#cb329-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">Population =</span> population)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   Country      year  cases Population
##   &lt;chr&gt;       &lt;int&gt;  &lt;int&gt;      &lt;int&gt;
## 1 Afghanistan  1999    745   19987071
## 2 Afghanistan  2000   2666   20595360
## 3 Brazil       1999  37737  172006362
## 4 Brazil       2000  80488  174504898
## 5 China        1999 212258 1272915272
## 6 China        2000 213766 1280428583</code></pre>
<p>If you want to select a few columns and rename them in the process, you could use <code>select()</code>. The structure is the same as with <code>rename()</code>, the only difference is that the new data only retains the columns mentioned explicitly within <code>select()</code>.</p>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="#cb331-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(data, <span class="at">new_column_name =</span> old_column_name)</span></code></pre></div>
<p>Modifying the <code>rename()</code> example from above would lead to selecting <strong>only</strong> the columns <code>country</code> and <code>population</code> from <code>table1</code> and renaming them as <code>Country</code> and <code>Population</code> at the same time.</p>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb332-1"><a href="#cb332-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(table1, <span class="at">Country =</span> country,</span>
<span id="cb332-2"><a href="#cb332-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">Population =</span> population)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 2
##   Country     Population
##   &lt;chr&gt;            &lt;int&gt;
## 1 Afghanistan   19987071
## 2 Afghanistan   20595360
## 3 Brazil       172006362
## 4 Brazil       174504898
## 5 China       1272915272
## 6 China       1280428583</code></pre>
</div>
<div id="conditional-statements" class="section level2 hasAnchor" number="6.3">
<h2 class="hasAnchor"><span class="header-section-number">6.3</span> Conditional statements<a href="#conditional-statements" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Conditional statements are used when you want to create an output value that is conditioned on an evaluation. Here, we are showing you how to use them in combination with <code>mutate()</code> by either modifying the values within one column, or by adding a new column.</p>
<p>Example scenario: Imagine that we have data in which a column <code>Sex</code> holds values of <code>1</code> and <code>2</code> that stand for <code>Male</code>, and <code>Female</code> participants respectively. Conditional statements make an evaluation: <em>if <code>Sex</code> is <code>1</code>, then put the value of <code>Male</code> in a new column called <code>Sex_char</code>; if <code>Sex</code> is <code>2</code> put <code>Female</code> in column <code>Sex_char</code>.</em></p>
<p>Let’s create some fake data for this. 40 participants (17 male, 20 female, 3 other), they are between 16 and 40 years of age, they study at 4 different institutions (University of Glasgow, University of Strathclyde, Glasgow Caledonian University, University of the West of Scotland), and we had them complete an R assignment and recorded their grade points.</p>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb334-1"><a href="#cb334-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">999</span>) <span class="co">#so we all get the same random data</span></span>
<span id="cb334-2"><a href="#cb334-2" aria-hidden="true" tabindex="-1"></a>fake_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">PP_ID =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">40</span>,</span>
<span id="cb334-3"><a href="#cb334-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">Sex =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">17</span>), <span class="fu">rep</span>(<span class="dv">2</span>,<span class="dv">20</span>), <span class="fu">rep</span>(<span class="dv">3</span>,<span class="dv">3</span>)),</span>
<span id="cb334-4"><a href="#cb334-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">Age =</span> <span class="fu">sample</span>(<span class="dv">16</span><span class="sc">:</span><span class="dv">40</span>, <span class="dv">40</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb334-5"><a href="#cb334-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">Institution =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">10</span>), <span class="fu">rep</span>(<span class="dv">2</span>,<span class="dv">8</span>), <span class="fu">rep</span>(<span class="dv">3</span>,<span class="dv">10</span>), <span class="fu">rep</span>(<span class="dv">4</span>,<span class="dv">10</span>), <span class="fu">rep</span>(<span class="dv">99</span>,<span class="dv">2</span>))),</span>
<span id="cb334-6"><a href="#cb334-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">Grade_points =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">9</span><span class="sc">:</span><span class="dv">22</span>), <span class="dv">40</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>))</span>
<span id="cb334-7"><a href="#cb334-7" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(fake_data)</span></code></pre></div>
<pre><code>## Rows: 40
## Columns: 5
## $ PP_ID        &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17~
## $ Sex          &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, ~
## $ Age          &lt;int&gt; 19, 22, 24, 29, 16, 25, 37, 18, 38, 39, 30, 20, 22, 21, 3~
## $ Institution  &lt;dbl&gt; 3, 1, 1, 4, 2, 3, 1, 4, 3, 4, 3, 4, 4, 4, 2, 3, 3, 99, 2,~
## $ Grade_points &lt;dbl&gt; 0, 20, 15, 20, 11, 22, 21, 9, 13, 22, 19, 13, 10, 0, 12, ~</code></pre>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb336-1"><a href="#cb336-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(fake_data)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">PP_ID</th>
<th align="right">Sex</th>
<th align="right">Age</th>
<th align="right">Institution</th>
<th align="right">Grade_points</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">19</td>
<td align="right">3</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">1</td>
<td align="right">22</td>
<td align="right">1</td>
<td align="right">20</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">1</td>
<td align="right">24</td>
<td align="right">1</td>
<td align="right">15</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">1</td>
<td align="right">29</td>
<td align="right">4</td>
<td align="right">20</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">1</td>
<td align="right">16</td>
<td align="right">2</td>
<td align="right">11</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">1</td>
<td align="right">25</td>
<td align="right">3</td>
<td align="right">22</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="right">1</td>
<td align="right">37</td>
<td align="right">1</td>
<td align="right">21</td>
</tr>
<tr class="even">
<td align="right">8</td>
<td align="right">1</td>
<td align="right">18</td>
<td align="right">4</td>
<td align="right">9</td>
</tr>
<tr class="odd">
<td align="right">9</td>
<td align="right">1</td>
<td align="right">38</td>
<td align="right">3</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="right">10</td>
<td align="right">1</td>
<td align="right">39</td>
<td align="right">4</td>
<td align="right">22</td>
</tr>
<tr class="odd">
<td align="right">11</td>
<td align="right">1</td>
<td align="right">30</td>
<td align="right">3</td>
<td align="right">19</td>
</tr>
<tr class="even">
<td align="right">12</td>
<td align="right">1</td>
<td align="right">20</td>
<td align="right">4</td>
<td align="right">13</td>
</tr>
<tr class="odd">
<td align="right">13</td>
<td align="right">1</td>
<td align="right">22</td>
<td align="right">4</td>
<td align="right">10</td>
</tr>
<tr class="even">
<td align="right">14</td>
<td align="right">1</td>
<td align="right">21</td>
<td align="right">4</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">15</td>
<td align="right">1</td>
<td align="right">34</td>
<td align="right">2</td>
<td align="right">12</td>
</tr>
<tr class="even">
<td align="right">16</td>
<td align="right">1</td>
<td align="right">26</td>
<td align="right">3</td>
<td align="right">17</td>
</tr>
<tr class="odd">
<td align="right">17</td>
<td align="right">1</td>
<td align="right">33</td>
<td align="right">3</td>
<td align="right">20</td>
</tr>
<tr class="even">
<td align="right">18</td>
<td align="right">2</td>
<td align="right">16</td>
<td align="right">99</td>
<td align="right">22</td>
</tr>
<tr class="odd">
<td align="right">19</td>
<td align="right">2</td>
<td align="right">20</td>
<td align="right">2</td>
<td align="right">12</td>
</tr>
<tr class="even">
<td align="right">20</td>
<td align="right">2</td>
<td align="right">34</td>
<td align="right">3</td>
<td align="right">20</td>
</tr>
<tr class="odd">
<td align="right">21</td>
<td align="right">2</td>
<td align="right">27</td>
<td align="right">3</td>
<td align="right">10</td>
</tr>
<tr class="even">
<td align="right">22</td>
<td align="right">2</td>
<td align="right">24</td>
<td align="right">4</td>
<td align="right">11</td>
</tr>
<tr class="odd">
<td align="right">23</td>
<td align="right">2</td>
<td align="right">36</td>
<td align="right">1</td>
<td align="right">15</td>
</tr>
<tr class="even">
<td align="right">24</td>
<td align="right">2</td>
<td align="right">38</td>
<td align="right">99</td>
<td align="right">21</td>
</tr>
<tr class="odd">
<td align="right">25</td>
<td align="right">2</td>
<td align="right">20</td>
<td align="right">2</td>
<td align="right">19</td>
</tr>
<tr class="even">
<td align="right">26</td>
<td align="right">2</td>
<td align="right">40</td>
<td align="right">2</td>
<td align="right">15</td>
</tr>
<tr class="odd">
<td align="right">27</td>
<td align="right">2</td>
<td align="right">19</td>
<td align="right">4</td>
<td align="right">18</td>
</tr>
<tr class="even">
<td align="right">28</td>
<td align="right">2</td>
<td align="right">39</td>
<td align="right">3</td>
<td align="right">16</td>
</tr>
<tr class="odd">
<td align="right">29</td>
<td align="right">2</td>
<td align="right">40</td>
<td align="right">4</td>
<td align="right">21</td>
</tr>
<tr class="even">
<td align="right">30</td>
<td align="right">2</td>
<td align="right">30</td>
<td align="right">2</td>
<td align="right">20</td>
</tr>
<tr class="odd">
<td align="right">31</td>
<td align="right">2</td>
<td align="right">38</td>
<td align="right">1</td>
<td align="right">16</td>
</tr>
<tr class="even">
<td align="right">32</td>
<td align="right">2</td>
<td align="right">31</td>
<td align="right">1</td>
<td align="right">19</td>
</tr>
<tr class="odd">
<td align="right">33</td>
<td align="right">2</td>
<td align="right">26</td>
<td align="right">4</td>
<td align="right">17</td>
</tr>
<tr class="even">
<td align="right">34</td>
<td align="right">2</td>
<td align="right">17</td>
<td align="right">1</td>
<td align="right">18</td>
</tr>
<tr class="odd">
<td align="right">35</td>
<td align="right">2</td>
<td align="right">24</td>
<td align="right">1</td>
<td align="right">21</td>
</tr>
<tr class="even">
<td align="right">36</td>
<td align="right">2</td>
<td align="right">16</td>
<td align="right">3</td>
<td align="right">21</td>
</tr>
<tr class="odd">
<td align="right">37</td>
<td align="right">2</td>
<td align="right">33</td>
<td align="right">1</td>
<td align="right">18</td>
</tr>
<tr class="even">
<td align="right">38</td>
<td align="right">3</td>
<td align="right">39</td>
<td align="right">2</td>
<td align="right">18</td>
</tr>
<tr class="odd">
<td align="right">39</td>
<td align="right">3</td>
<td align="right">23</td>
<td align="right">1</td>
<td align="right">17</td>
</tr>
<tr class="even">
<td align="right">40</td>
<td align="right">3</td>
<td align="right">19</td>
<td align="right">2</td>
<td align="right">18</td>
</tr>
</tbody>
</table>
<p>Now, the data doesn’t look very readable at the moment. If we pass this data set onto a fellow researcher, they would ask us how the columns <code>Sex</code> and <code>Institution</code> are coded.</p>
<p>Best would be to adjust the values to make that clearer. There are the options of using the function <code>recode()</code>, an <code>ifelse</code> statement or <code>case_when()</code>.</p>
<div id="recode" class="section level3 hasAnchor" number="6.3.1">
<h3 class="hasAnchor"><span class="header-section-number">6.3.1</span> recode()<a href="#recode" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Can be used for character, numeric, and factors columns.</p>
<p>The structure for <code>recode()</code> is:</p>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="#cb337-1" aria-hidden="true" tabindex="-1"></a><span class="fu">recode</span>(variable_to_recode, <span class="at">old_value =</span> new_value)</span></code></pre></div>
<p>This is a bit tricky to remember as it doesn’t follow the usual tidyverse logic. In <code>select()</code>, <code>rename()</code>, and <code>mutate()</code> for example it is the other way around <code>new_thing = old_thing</code> or <code>new_thing = something_computational</code>)</p>
<p>In combination with <code>mutate()</code>, the structure looks as follows:</p>
<div class="sourceCode" id="cb338"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb338-1"><a href="#cb338-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(data, <span class="at">new_column_name =</span> <span class="fu">recode</span>(variable_to_recode, <span class="at">old_value =</span> new_value))</span></code></pre></div>
<p>What is a bit unusual in this structure is that we need a new column name within the <code>mutate()</code> function but also a reference column within <code>recode()</code> on which the conditional recoding is based upon.</p>
<p>The new column name within <code>mutate()</code> can either be an entirely new column name, or if it is an existing column name that original column would be overwritten by the new values we recode.</p>
<p>So, let’s turn to our <code>fake_data</code>, and apply that logic for recoding the values of the column <code>Sex</code> where 1 = “Male”, 2 = “Female”, and 3 = “Other”. We will add a new column <code>Sex_char</code> onto our <code>fake_data</code>.</p>
<p>The only tricky thing to remember here is that recoding numeric values requires backticks (if the numbers are on the left side of the equation).</p>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb339-1"><a href="#cb339-1" aria-hidden="true" tabindex="-1"></a>fake_data <span class="ot">&lt;-</span> <span class="fu">mutate</span>(fake_data, <span class="at">Sex_char =</span> <span class="fu">recode</span>(Sex, </span>
<span id="cb339-2"><a href="#cb339-2" aria-hidden="true" tabindex="-1"></a>                                                 <span class="st">`</span><span class="at">1</span><span class="st">`</span> <span class="ot">=</span> <span class="st">&quot;Male&quot;</span>, </span>
<span id="cb339-3"><a href="#cb339-3" aria-hidden="true" tabindex="-1"></a>                                                 <span class="st">`</span><span class="at">2</span><span class="st">`</span> <span class="ot">=</span> <span class="st">&quot;Female&quot;</span>, </span>
<span id="cb339-4"><a href="#cb339-4" aria-hidden="true" tabindex="-1"></a>                                                 <span class="st">`</span><span class="at">3</span><span class="st">`</span> <span class="ot">=</span> <span class="st">&quot;Other&quot;</span>))</span>
<span id="cb339-5"><a href="#cb339-5" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(fake_data)</span></code></pre></div>
<pre><code>## Rows: 40
## Columns: 6
## $ PP_ID        &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17~
## $ Sex          &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, ~
## $ Age          &lt;int&gt; 19, 22, 24, 29, 16, 25, 37, 18, 38, 39, 30, 20, 22, 21, 3~
## $ Institution  &lt;dbl&gt; 3, 1, 1, 4, 2, 3, 1, 4, 3, 4, 3, 4, 4, 4, 2, 3, 3, 99, 2,~
## $ Grade_points &lt;dbl&gt; 0, 20, 15, 20, 11, 22, 21, 9, 13, 22, 19, 13, 10, 0, 12, ~
## $ Sex_char     &lt;chr&gt; &quot;Male&quot;, &quot;Male&quot;, &quot;Male&quot;, &quot;Male&quot;, &quot;Male&quot;, &quot;Male&quot;, &quot;Male&quot;, &quot;~</code></pre>
<div class="warning">
<p>
If you forget to recode one condition (for example
<code>`3` = “Other”</code>), values for 3 would be displayed as
<code>NA</code> in the new column. This becomes more important when you
decide to overwrite an existing column.
</p>
</div>
<div class="task">
<p>
<strong>Your turn</strong>
</p>
<p>
The next variable to recode is <code>Institution</code>:
</p>
<ul>
<li>
1 = UoG,
</li>
<li>
2 = Strathclyde,
</li>
<li>
3 = GCU,
</li>
<li>
4 = UWS
</li>
</ul>
<p>
In the questionnaire, two participants forgot to indicate which
university they are studying at (coded as 99), but fortunately we know
that they are at the University of Strathclyde (the test was distributed
to 10 students at each institution, however, Strathclyde only has 8
responses).
</p>
<p>
Add a new column <code>Institution_char</code> to
<code>fake_data</code> that holds the recoded values as
</p>
</div>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb341-1"><a href="#cb341-1" aria-hidden="true" tabindex="-1"></a>fake_data <span class="ot">&lt;-</span> <span class="fu">mutate</span>(fake_data, <span class="at">Institution_char =</span> <span class="fu">recode</span>(Institution, </span>
<span id="cb341-2"><a href="#cb341-2" aria-hidden="true" tabindex="-1"></a>                                                         <span class="st">`</span><span class="at">1</span><span class="st">`</span> <span class="ot">=</span> <span class="st">&quot;UoG&quot;</span>, </span>
<span id="cb341-3"><a href="#cb341-3" aria-hidden="true" tabindex="-1"></a>                                                         <span class="st">`</span><span class="at">2</span><span class="st">`</span> <span class="ot">=</span> <span class="st">&quot;Strathclyde&quot;</span>, </span>
<span id="cb341-4"><a href="#cb341-4" aria-hidden="true" tabindex="-1"></a>                                                         <span class="st">`</span><span class="at">3</span><span class="st">`</span> <span class="ot">=</span> <span class="st">&quot;GCU&quot;</span>, </span>
<span id="cb341-5"><a href="#cb341-5" aria-hidden="true" tabindex="-1"></a>                                                         <span class="st">`</span><span class="at">4</span><span class="st">`</span> <span class="ot">=</span> <span class="st">&quot;UWS&quot;</span>, </span>
<span id="cb341-6"><a href="#cb341-6" aria-hidden="true" tabindex="-1"></a>                                                         <span class="st">`</span><span class="at">99</span><span class="st">`</span> <span class="ot">=</span> <span class="st">&quot;Strathclyde&quot;</span>))</span>
<span id="cb341-7"><a href="#cb341-7" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(fake_data)</span></code></pre></div>
<pre><code>## Rows: 40
## Columns: 7
## $ PP_ID            &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16~
## $ Sex              &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2,~
## $ Age              &lt;int&gt; 19, 22, 24, 29, 16, 25, 37, 18, 38, 39, 30, 20, 22, 2~
## $ Institution      &lt;dbl&gt; 3, 1, 1, 4, 2, 3, 1, 4, 3, 4, 3, 4, 4, 4, 2, 3, 3, 99~
## $ Grade_points     &lt;dbl&gt; 0, 20, 15, 20, 11, 22, 21, 9, 13, 22, 19, 13, 10, 0, ~
## $ Sex_char         &lt;chr&gt; &quot;Male&quot;, &quot;Male&quot;, &quot;Male&quot;, &quot;Male&quot;, &quot;Male&quot;, &quot;Male&quot;, &quot;Male~
## $ Institution_char &lt;chr&gt; &quot;GCU&quot;, &quot;UoG&quot;, &quot;UoG&quot;, &quot;UWS&quot;, &quot;Strathclyde&quot;, &quot;GCU&quot;, &quot;Uo~</code></pre>
</div>
<p>An alternative to <code>recode()</code> is <code>ifelse()</code>. Let’s see how <code>Sex</code> and <code>Institution</code> could have been recoded using <code>ifelse()</code>.</p>
</div>
<div id="ifelse" class="section level3 hasAnchor" number="6.3.2">
<h3 class="hasAnchor"><span class="header-section-number">6.3.2</span> ifelse()<a href="#ifelse" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>ifelse()</code> is a good option when dealing with character or numeric input but struggles with dates and factors. None of the columns in <code>fake_data</code> are dates or factors, so we can easily use <code>ifelse()</code> for recoding variables.</p>
<p>The generic structure for <code>ifelse()</code> is:</p>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="#cb343-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ifelse</span>(test, yes, no)</span></code></pre></div>
<ul>
<li>test: is an expression to test that creates an output of <code>TRUE</code> or <code>FALSE</code></li>
<li>yes: if test has a <code>TRUE</code> outcome, this is what would be coded in the new column</li>
<li>no: if test has a <code>FALSE</code> outcome, this is what would be coded in the new column</li>
</ul>
<p>The interpretation of <code>ifelse()</code> is: if the test expression is <code>TRUE</code>, write the value of yes, otherwise no.</p>
<p>In combination with <code>mutate()</code>, the structure looks as follows:</p>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb344-1"><a href="#cb344-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(data, <span class="at">new_column_name =</span> <span class="fu">ifelse</span>(test, yes, no))</span></code></pre></div>
<p>How would we apply that to recoding <code>Sex</code>? We would want the expression to test whether the Sex column holds a value of 1, then a new column should code it as “Male”, otherwise as “Female”. Let’s add a new column <code>Sex_ifelse</code> to <code>fake_data</code></p>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="#cb345-1" aria-hidden="true" tabindex="-1"></a>fake_data <span class="ot">&lt;-</span> <span class="fu">mutate</span>(fake_data, <span class="at">Sex_ifelse =</span> <span class="fu">ifelse</span>(Sex <span class="sc">==</span> <span class="dv">1</span>, <span class="st">&quot;Male&quot;</span>, <span class="st">&quot;Female&quot;</span>))</span>
<span id="cb345-2"><a href="#cb345-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(fake_data)</span></code></pre></div>
<pre><code>## Rows: 40
## Columns: 8
## $ PP_ID            &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16~
## $ Sex              &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2,~
## $ Age              &lt;int&gt; 19, 22, 24, 29, 16, 25, 37, 18, 38, 39, 30, 20, 22, 2~
## $ Institution      &lt;dbl&gt; 3, 1, 1, 4, 2, 3, 1, 4, 3, 4, 3, 4, 4, 4, 2, 3, 3, 99~
## $ Grade_points     &lt;dbl&gt; 0, 20, 15, 20, 11, 22, 21, 9, 13, 22, 19, 13, 10, 0, ~
## $ Sex_char         &lt;chr&gt; &quot;Male&quot;, &quot;Male&quot;, &quot;Male&quot;, &quot;Male&quot;, &quot;Male&quot;, &quot;Male&quot;, &quot;Male~
## $ Institution_char &lt;chr&gt; &quot;GCU&quot;, &quot;UoG&quot;, &quot;UoG&quot;, &quot;UWS&quot;, &quot;Strathclyde&quot;, &quot;GCU&quot;, &quot;Uo~
## $ Sex_ifelse       &lt;chr&gt; &quot;Male&quot;, &quot;Male&quot;, &quot;Male&quot;, &quot;Male&quot;, &quot;Male&quot;, &quot;Male&quot;, &quot;Male~</code></pre>
<p>AHHHH!!! But what about the 3 participants that chose option 3? They are now coded as “Female”. Hmmm. One way to get around that would be a nested <code>ifelse()</code> statement. Instead of replacing the no argument (<code>FALSE</code> evaluation) with “Female”, we could include a second <code>ifelse()</code> statement.</p>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb347-1"><a href="#cb347-1" aria-hidden="true" tabindex="-1"></a>fake_data <span class="ot">&lt;-</span> <span class="fu">mutate</span>(fake_data, <span class="at">Sex_ifelse =</span> <span class="fu">ifelse</span>(Sex <span class="sc">==</span> <span class="dv">1</span>, <span class="st">&quot;Male&quot;</span>,</span>
<span id="cb347-2"><a href="#cb347-2" aria-hidden="true" tabindex="-1"></a>                                                   <span class="fu">ifelse</span>(Sex <span class="sc">==</span> <span class="dv">2</span>, <span class="st">&quot;Female&quot;</span>, <span class="st">&quot;Other&quot;</span>)))</span></code></pre></div>
<p>Now everything is coded as it should be.</p>
<div class="task">
<p>
<strong>Your turn</strong>
</p>
<p>
Recode <code>Institution</code> using <code>ifelse()</code>. Add a
new column <code>Institution_ifelse</code> to <code>fake_data</code>. A
quick reminder of the <code>Institution</code> values:
</p>
<ul>
<li>
1 = “UoG”,
</li>
<li>
2 and 99 = “Strathclyde”,
</li>
<li>
3 = “GCU”, and
</li>
<li>
4 = “UWS”
</li>
</ul>
</div>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb348-1"><a href="#cb348-1" aria-hidden="true" tabindex="-1"></a>fake_data <span class="ot">&lt;-</span> <span class="fu">mutate</span>(fake_data, <span class="at">Institution_ifelse =</span> <span class="fu">ifelse</span>(Institution <span class="sc">==</span> <span class="dv">1</span>, <span class="st">&quot;UoG&quot;</span>, </span>
<span id="cb348-2"><a href="#cb348-2" aria-hidden="true" tabindex="-1"></a>                                                           <span class="fu">ifelse</span>(Institution <span class="sc">==</span> <span class="dv">3</span>, <span class="st">&quot;GCU&quot;</span>, </span>
<span id="cb348-3"><a href="#cb348-3" aria-hidden="true" tabindex="-1"></a>                                                                  <span class="fu">ifelse</span>(Institution <span class="sc">==</span>  <span class="dv">4</span>, <span class="st">&quot;UWS&quot;</span>, <span class="st">&quot;Strathclyde&quot;</span>))))</span>
<span id="cb348-4"><a href="#cb348-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb348-5"><a href="#cb348-5" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(fake_data)</span></code></pre></div>
<pre><code>## Rows: 40
## Columns: 9
## $ PP_ID              &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, ~
## $ Sex                &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ~
## $ Age                &lt;int&gt; 19, 22, 24, 29, 16, 25, 37, 18, 38, 39, 30, 20, 22,~
## $ Institution        &lt;dbl&gt; 3, 1, 1, 4, 2, 3, 1, 4, 3, 4, 3, 4, 4, 4, 2, 3, 3, ~
## $ Grade_points       &lt;dbl&gt; 0, 20, 15, 20, 11, 22, 21, 9, 13, 22, 19, 13, 10, 0~
## $ Sex_char           &lt;chr&gt; &quot;Male&quot;, &quot;Male&quot;, &quot;Male&quot;, &quot;Male&quot;, &quot;Male&quot;, &quot;Male&quot;, &quot;Ma~
## $ Institution_char   &lt;chr&gt; &quot;GCU&quot;, &quot;UoG&quot;, &quot;UoG&quot;, &quot;UWS&quot;, &quot;Strathclyde&quot;, &quot;GCU&quot;, &quot;~
## $ Sex_ifelse         &lt;chr&gt; &quot;Male&quot;, &quot;Male&quot;, &quot;Male&quot;, &quot;Male&quot;, &quot;Male&quot;, &quot;Male&quot;, &quot;Ma~
## $ Institution_ifelse &lt;chr&gt; &quot;GCU&quot;, &quot;UoG&quot;, &quot;UoG&quot;, &quot;UWS&quot;, &quot;Strathclyde&quot;, &quot;GCU&quot;, &quot;~</code></pre>
</div>
<p>It does look a bit convoluted, and there is definitely the need to count opening and closing brackets, but it gets us the output we wanted. Before showing you how this can be coded in a slightly neater way with <code>case_when()</code>, I’d like to highlight one advantage <code>ifelse()</code> has over <code>recode()</code>, namely that the test expression can evaluate more complex “things” as long as they return a logical value. For example, if we wanted to add a column <code>Pass_Fail</code> to <code>fake_data</code>, that holds values of “Pass” for grade points above 9, and “Fail” for values of 9 and below, we would code</p>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb350-1"><a href="#cb350-1" aria-hidden="true" tabindex="-1"></a>fake_data <span class="ot">&lt;-</span> <span class="fu">mutate</span>(fake_data, <span class="at">Pass_Fail =</span> <span class="fu">ifelse</span>(Grade_points <span class="sc">&gt;</span> <span class="dv">9</span>, <span class="st">&quot;Pass&quot;</span>, <span class="st">&quot;Fail&quot;</span>))</span>
<span id="cb350-2"><a href="#cb350-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(fake_data)</span></code></pre></div>
<pre><code>## Rows: 40
## Columns: 10
## $ PP_ID              &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, ~
## $ Sex                &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ~
## $ Age                &lt;int&gt; 19, 22, 24, 29, 16, 25, 37, 18, 38, 39, 30, 20, 22,~
## $ Institution        &lt;dbl&gt; 3, 1, 1, 4, 2, 3, 1, 4, 3, 4, 3, 4, 4, 4, 2, 3, 3, ~
## $ Grade_points       &lt;dbl&gt; 0, 20, 15, 20, 11, 22, 21, 9, 13, 22, 19, 13, 10, 0~
## $ Sex_char           &lt;chr&gt; &quot;Male&quot;, &quot;Male&quot;, &quot;Male&quot;, &quot;Male&quot;, &quot;Male&quot;, &quot;Male&quot;, &quot;Ma~
## $ Institution_char   &lt;chr&gt; &quot;GCU&quot;, &quot;UoG&quot;, &quot;UoG&quot;, &quot;UWS&quot;, &quot;Strathclyde&quot;, &quot;GCU&quot;, &quot;~
## $ Sex_ifelse         &lt;chr&gt; &quot;Male&quot;, &quot;Male&quot;, &quot;Male&quot;, &quot;Male&quot;, &quot;Male&quot;, &quot;Male&quot;, &quot;Ma~
## $ Institution_ifelse &lt;chr&gt; &quot;GCU&quot;, &quot;UoG&quot;, &quot;UoG&quot;, &quot;UWS&quot;, &quot;Strathclyde&quot;, &quot;GCU&quot;, &quot;~
## $ Pass_Fail          &lt;chr&gt; &quot;Fail&quot;, &quot;Pass&quot;, &quot;Pass&quot;, &quot;Pass&quot;, &quot;Pass&quot;, &quot;Pass&quot;, &quot;Pa~</code></pre>
<p>We could also add a column <code>Grade</code> to <code>fake_data</code> that tells us the primary band the students got in their test. <code>Grade_points</code> between 18 and 22 result in A, 15 to 17 = B, 12 to 14 = C, 9 to 11 = D, 6 to 8 = E, 3 to 5 = F, 1 and 2 = G, and 0 = H. Here we can use the <code>%in%</code> operator.</p>
<div class="sourceCode" id="cb352"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb352-1"><a href="#cb352-1" aria-hidden="true" tabindex="-1"></a>fake_data <span class="ot">&lt;-</span> <span class="fu">mutate</span>(fake_data, <span class="at">Grade =</span> <span class="fu">ifelse</span>(Grade_points <span class="sc">%in%</span> <span class="dv">18</span><span class="sc">:</span><span class="dv">22</span>, <span class="st">&quot;A&quot;</span>,</span>
<span id="cb352-2"><a href="#cb352-2" aria-hidden="true" tabindex="-1"></a>                                              <span class="fu">ifelse</span>(Grade_points <span class="sc">%in%</span> <span class="dv">15</span><span class="sc">:</span><span class="dv">17</span>, <span class="st">&quot;B&quot;</span>,</span>
<span id="cb352-3"><a href="#cb352-3" aria-hidden="true" tabindex="-1"></a>                                                     <span class="fu">ifelse</span>(Grade_points <span class="sc">%in%</span> <span class="dv">12</span><span class="sc">:</span><span class="dv">14</span>, <span class="st">&quot;C&quot;</span>,</span>
<span id="cb352-4"><a href="#cb352-4" aria-hidden="true" tabindex="-1"></a>                                                            <span class="fu">ifelse</span>(Grade_points <span class="sc">%in%</span> <span class="dv">9</span><span class="sc">:</span><span class="dv">11</span>, <span class="st">&quot;D&quot;</span>,</span>
<span id="cb352-5"><a href="#cb352-5" aria-hidden="true" tabindex="-1"></a>                                                                   <span class="fu">ifelse</span>(Grade_points <span class="sc">%in%</span> <span class="dv">6</span><span class="sc">:</span><span class="dv">8</span>, <span class="st">&quot;E&quot;</span>,</span>
<span id="cb352-6"><a href="#cb352-6" aria-hidden="true" tabindex="-1"></a>                                                                          <span class="fu">ifelse</span>(Grade_points <span class="sc">%in%</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>, <span class="st">&quot;F&quot;</span>,</span>
<span id="cb352-7"><a href="#cb352-7" aria-hidden="true" tabindex="-1"></a>                                                                                 <span class="fu">ifelse</span>(Grade_points <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="st">&quot;G&quot;</span>,<span class="st">&quot;H&quot;</span>))))))))</span>
<span id="cb352-8"><a href="#cb352-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb352-9"><a href="#cb352-9" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(fake_data)</span></code></pre></div>
<pre><code>## Rows: 40
## Columns: 11
## $ PP_ID              &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, ~
## $ Sex                &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ~
## $ Age                &lt;int&gt; 19, 22, 24, 29, 16, 25, 37, 18, 38, 39, 30, 20, 22,~
## $ Institution        &lt;dbl&gt; 3, 1, 1, 4, 2, 3, 1, 4, 3, 4, 3, 4, 4, 4, 2, 3, 3, ~
## $ Grade_points       &lt;dbl&gt; 0, 20, 15, 20, 11, 22, 21, 9, 13, 22, 19, 13, 10, 0~
## $ Sex_char           &lt;chr&gt; &quot;Male&quot;, &quot;Male&quot;, &quot;Male&quot;, &quot;Male&quot;, &quot;Male&quot;, &quot;Male&quot;, &quot;Ma~
## $ Institution_char   &lt;chr&gt; &quot;GCU&quot;, &quot;UoG&quot;, &quot;UoG&quot;, &quot;UWS&quot;, &quot;Strathclyde&quot;, &quot;GCU&quot;, &quot;~
## $ Sex_ifelse         &lt;chr&gt; &quot;Male&quot;, &quot;Male&quot;, &quot;Male&quot;, &quot;Male&quot;, &quot;Male&quot;, &quot;Male&quot;, &quot;Ma~
## $ Institution_ifelse &lt;chr&gt; &quot;GCU&quot;, &quot;UoG&quot;, &quot;UoG&quot;, &quot;UWS&quot;, &quot;Strathclyde&quot;, &quot;GCU&quot;, &quot;~
## $ Pass_Fail          &lt;chr&gt; &quot;Fail&quot;, &quot;Pass&quot;, &quot;Pass&quot;, &quot;Pass&quot;, &quot;Pass&quot;, &quot;Pass&quot;, &quot;Pa~
## $ Grade              &lt;chr&gt; &quot;H&quot;, &quot;A&quot;, &quot;B&quot;, &quot;A&quot;, &quot;D&quot;, &quot;A&quot;, &quot;A&quot;, &quot;D&quot;, &quot;C&quot;, &quot;A&quot;, &quot;~</code></pre>
</div>
<div id="case_when" class="section level3 hasAnchor" number="6.3.3">
<h3 class="hasAnchor"><span class="header-section-number">6.3.3</span> case_when()<a href="#case_when" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>case_when()</code> vectorises multiple <code>ifelse()</code> statements, and might potentially be a touch easier to digest visually than <code>ifelse()</code>.</p>
<p>There are few guidelines to follow when using <code>case_when()</code>:</p>
<ul>
<li>A sequence of two-sided formulas is needed.</li>
<li>The left hand side (LHS) determines which values match this case. The right hand side (RHS) provides the replacement value.</li>
<li>The LHS must evaluate to a logical vector. The RHS does not need to be logical, but all RHSs must evaluate to the same type of vector.</li>
</ul>
<p>Let’s apply this to recoding the values in the column <code>Institution</code>. Combining <code>case_when()</code> with <code>mutate()</code>, we will add another column called <code>Institution_case_when</code> to <code>fake_data</code>.</p>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb354-1"><a href="#cb354-1" aria-hidden="true" tabindex="-1"></a>fake_data <span class="ot">&lt;-</span> <span class="fu">mutate</span>(fake_data, <span class="at">Institution_case_when =</span> <span class="fu">case_when</span>(</span>
<span id="cb354-2"><a href="#cb354-2" aria-hidden="true" tabindex="-1"></a>  Institution <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">&quot;UoG&quot;</span>,</span>
<span id="cb354-3"><a href="#cb354-3" aria-hidden="true" tabindex="-1"></a>  Institution <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">&quot;GCU&quot;</span>,</span>
<span id="cb354-4"><a href="#cb354-4" aria-hidden="true" tabindex="-1"></a>  Institution <span class="sc">==</span> <span class="dv">4</span> <span class="sc">~</span> <span class="st">&quot;UWS&quot;</span>,</span>
<span id="cb354-5"><a href="#cb354-5" aria-hidden="true" tabindex="-1"></a>  <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;Strathclyde&quot;</span></span>
<span id="cb354-6"><a href="#cb354-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb354-7"><a href="#cb354-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb354-8"><a href="#cb354-8" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(fake_data)</span></code></pre></div>
<pre><code>## Rows: 40
## Columns: 12
## $ PP_ID                 &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 1~
## $ Sex                   &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ~
## $ Age                   &lt;int&gt; 19, 22, 24, 29, 16, 25, 37, 18, 38, 39, 30, 20, ~
## $ Institution           &lt;dbl&gt; 3, 1, 1, 4, 2, 3, 1, 4, 3, 4, 3, 4, 4, 4, 2, 3, ~
## $ Grade_points          &lt;dbl&gt; 0, 20, 15, 20, 11, 22, 21, 9, 13, 22, 19, 13, 10~
## $ Sex_char              &lt;chr&gt; &quot;Male&quot;, &quot;Male&quot;, &quot;Male&quot;, &quot;Male&quot;, &quot;Male&quot;, &quot;Male&quot;, ~
## $ Institution_char      &lt;chr&gt; &quot;GCU&quot;, &quot;UoG&quot;, &quot;UoG&quot;, &quot;UWS&quot;, &quot;Strathclyde&quot;, &quot;GCU&quot;~
## $ Sex_ifelse            &lt;chr&gt; &quot;Male&quot;, &quot;Male&quot;, &quot;Male&quot;, &quot;Male&quot;, &quot;Male&quot;, &quot;Male&quot;, ~
## $ Institution_ifelse    &lt;chr&gt; &quot;GCU&quot;, &quot;UoG&quot;, &quot;UoG&quot;, &quot;UWS&quot;, &quot;Strathclyde&quot;, &quot;GCU&quot;~
## $ Pass_Fail             &lt;chr&gt; &quot;Fail&quot;, &quot;Pass&quot;, &quot;Pass&quot;, &quot;Pass&quot;, &quot;Pass&quot;, &quot;Pass&quot;, ~
## $ Grade                 &lt;chr&gt; &quot;H&quot;, &quot;A&quot;, &quot;B&quot;, &quot;A&quot;, &quot;D&quot;, &quot;A&quot;, &quot;A&quot;, &quot;D&quot;, &quot;C&quot;, &quot;A&quot;~
## $ Institution_case_when &lt;chr&gt; &quot;GCU&quot;, &quot;UoG&quot;, &quot;UoG&quot;, &quot;UWS&quot;, &quot;Strathclyde&quot;, &quot;GCU&quot;~</code></pre>
<p>The <code>TRUE</code> statement at the end is similar to the the “else” in the <code>ifelse()</code> function. A further similarity between the two is that arguments are evaluated in order, so you must proceed from the most specific to the most general.</p>
<p>Allison Horst made a really cute artwork about <code>case_when()</code> which might help. In her example, she is using the <code>mutate()</code> function to add a new column called <code>danger</code> to the data <code>df</code>, and wants the danger value to be listed as extreme! if the animal is of <code>type</code> kraken. In all other cases, the danger levels should be “just” high.</p>
<div class="figure">
<img src="images/dplyr_case_when.png" alt="" />
<p class="caption">Artwork by <code>@allison_horst</code>, Source: <a href="https://github.com/allisonhorst/stats-illustrations" class="uri">https://github.com/allisonhorst/stats-illustrations</a></p>
</div>
<div class="task">
<p>
<strong>Your turn</strong>
</p>
<p>
Add a column <code>Grade_case_when</code> into <code>fake_data</code>
using a combination of <code>mutate()</code> and
<code>case_when()</code>, that recodes grade points to primary bands.
Quick reminder:
</p>
<ul>
<li>
grade points 18 - 22 = A,
</li>
<li>
15 to 17 = B,
</li>
<li>
12 to 14 = C,
</li>
<li>
9 to 11 = D,
</li>
<li>
6 to 8 = E,
</li>
<li>
3 to 5 = F,
</li>
<li>
1 and 2 = G, and
</li>
<li>
0 = H.
</li>
</ul>
</div>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb356-1"><a href="#cb356-1" aria-hidden="true" tabindex="-1"></a>fake_data <span class="ot">&lt;-</span> <span class="fu">mutate</span>(fake_data, <span class="at">Grade_case_when =</span> <span class="fu">case_when</span>(</span>
<span id="cb356-2"><a href="#cb356-2" aria-hidden="true" tabindex="-1"></a>  Grade_points <span class="sc">%in%</span> <span class="dv">18</span><span class="sc">:</span><span class="dv">22</span> <span class="sc">~</span> <span class="st">&quot;A&quot;</span>,</span>
<span id="cb356-3"><a href="#cb356-3" aria-hidden="true" tabindex="-1"></a>  Grade_points <span class="sc">%in%</span> <span class="dv">15</span><span class="sc">:</span><span class="dv">17</span> <span class="sc">~</span> <span class="st">&quot;B&quot;</span>,</span>
<span id="cb356-4"><a href="#cb356-4" aria-hidden="true" tabindex="-1"></a>  Grade_points <span class="sc">%in%</span> <span class="dv">12</span><span class="sc">:</span><span class="dv">14</span> <span class="sc">~</span> <span class="st">&quot;C&quot;</span>,</span>
<span id="cb356-5"><a href="#cb356-5" aria-hidden="true" tabindex="-1"></a>  Grade_points <span class="sc">%in%</span> <span class="dv">9</span><span class="sc">:</span><span class="dv">11</span> <span class="sc">~</span> <span class="st">&quot;D&quot;</span>,</span>
<span id="cb356-6"><a href="#cb356-6" aria-hidden="true" tabindex="-1"></a>  Grade_points <span class="sc">%in%</span> <span class="dv">6</span><span class="sc">:</span><span class="dv">8</span> <span class="sc">~</span> <span class="st">&quot;E&quot;</span>,</span>
<span id="cb356-7"><a href="#cb356-7" aria-hidden="true" tabindex="-1"></a>  Grade_points <span class="sc">%in%</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">5</span> <span class="sc">~</span> <span class="st">&quot;F&quot;</span>,</span>
<span id="cb356-8"><a href="#cb356-8" aria-hidden="true" tabindex="-1"></a>  Grade_points <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span> <span class="sc">~</span> <span class="st">&quot;G&quot;</span>,</span>
<span id="cb356-9"><a href="#cb356-9" aria-hidden="true" tabindex="-1"></a>  <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;H&quot;</span></span>
<span id="cb356-10"><a href="#cb356-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb356-11"><a href="#cb356-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb356-12"><a href="#cb356-12" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(fake_data)</span></code></pre></div>
<pre><code>## Rows: 40
## Columns: 13
## $ PP_ID                 &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 1~
## $ Sex                   &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ~
## $ Age                   &lt;int&gt; 19, 22, 24, 29, 16, 25, 37, 18, 38, 39, 30, 20, ~
## $ Institution           &lt;dbl&gt; 3, 1, 1, 4, 2, 3, 1, 4, 3, 4, 3, 4, 4, 4, 2, 3, ~
## $ Grade_points          &lt;dbl&gt; 0, 20, 15, 20, 11, 22, 21, 9, 13, 22, 19, 13, 10~
## $ Sex_char              &lt;chr&gt; &quot;Male&quot;, &quot;Male&quot;, &quot;Male&quot;, &quot;Male&quot;, &quot;Male&quot;, &quot;Male&quot;, ~
## $ Institution_char      &lt;chr&gt; &quot;GCU&quot;, &quot;UoG&quot;, &quot;UoG&quot;, &quot;UWS&quot;, &quot;Strathclyde&quot;, &quot;GCU&quot;~
## $ Sex_ifelse            &lt;chr&gt; &quot;Male&quot;, &quot;Male&quot;, &quot;Male&quot;, &quot;Male&quot;, &quot;Male&quot;, &quot;Male&quot;, ~
## $ Institution_ifelse    &lt;chr&gt; &quot;GCU&quot;, &quot;UoG&quot;, &quot;UoG&quot;, &quot;UWS&quot;, &quot;Strathclyde&quot;, &quot;GCU&quot;~
## $ Pass_Fail             &lt;chr&gt; &quot;Fail&quot;, &quot;Pass&quot;, &quot;Pass&quot;, &quot;Pass&quot;, &quot;Pass&quot;, &quot;Pass&quot;, ~
## $ Grade                 &lt;chr&gt; &quot;H&quot;, &quot;A&quot;, &quot;B&quot;, &quot;A&quot;, &quot;D&quot;, &quot;A&quot;, &quot;A&quot;, &quot;D&quot;, &quot;C&quot;, &quot;A&quot;~
## $ Institution_case_when &lt;chr&gt; &quot;GCU&quot;, &quot;UoG&quot;, &quot;UoG&quot;, &quot;UWS&quot;, &quot;Strathclyde&quot;, &quot;GCU&quot;~
## $ Grade_case_when       &lt;chr&gt; &quot;H&quot;, &quot;A&quot;, &quot;B&quot;, &quot;A&quot;, &quot;D&quot;, &quot;A&quot;, &quot;A&quot;, &quot;D&quot;, &quot;C&quot;, &quot;A&quot;~</code></pre>
</div>
</div>
</div>
<div id="distinct" class="section level2 hasAnchor" number="6.4">
<h2 class="hasAnchor"><span class="header-section-number">6.4</span> distinct()<a href="#distinct" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The <code>distinct()</code> function is used to remove duplicate rows in your dataframe. If we are using <code>distinct()</code> without specifying any arguments, R checks the whole row and excludes any row that is exactly repeated.</p>
<div class="sourceCode" id="cb358"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb358-1"><a href="#cb358-1" aria-hidden="true" tabindex="-1"></a>fake_data_no_dup <span class="ot">&lt;-</span> fake_data <span class="sc">%&gt;%</span> </span>
<span id="cb358-2"><a href="#cb358-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span></code></pre></div>
<p>We can see that all rows are still there. This is not surprising, given every participant has a unique ID number. However, <code>distinct()</code> does take arguments as well, namely the variable columns you are trying to determine uniqueness for. Say we we wanted to see how many different institutions we have data from.</p>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="#cb359-1" aria-hidden="true" tabindex="-1"></a>institution_distinct <span class="ot">&lt;-</span> fake_data <span class="sc">%&gt;%</span> </span>
<span id="cb359-2"><a href="#cb359-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(Institution_char)</span>
<span id="cb359-3"><a href="#cb359-3" aria-hidden="true" tabindex="-1"></a>institution_distinct</span></code></pre></div>
<pre><code>## # A tibble: 4 x 1
##   Institution_char
##   &lt;chr&gt;           
## 1 GCU             
## 2 UoG             
## 3 UWS             
## 4 Strathclyde</code></pre>
<p>We can see that there are 4 distinct institutions. But what happened to the output? We still have the output from the column we specified but all other information is gone. One quick solution would be to use the argument <code>.keep_all</code> and set that to <code>TRUE</code> (the default here is <code>FALSE</code>).</p>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="#cb361-1" aria-hidden="true" tabindex="-1"></a>institution_distinct <span class="ot">&lt;-</span> fake_data <span class="sc">%&gt;%</span> </span>
<span id="cb361-2"><a href="#cb361-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(Institution_char, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb361-3"><a href="#cb361-3" aria-hidden="true" tabindex="-1"></a>institution_distinct</span></code></pre></div>
<pre><code>## # A tibble: 4 x 13
##   PP_ID   Sex   Age Institution Grade_points Sex_char Institution_char
##   &lt;int&gt; &lt;dbl&gt; &lt;int&gt;       &lt;dbl&gt;        &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;           
## 1     1     1    19           3            0 Male     GCU             
## 2     2     1    22           1           20 Male     UoG             
## 3     4     1    29           4           20 Male     UWS             
## 4     5     1    16           2           11 Male     Strathclyde     
## # ... with 6 more variables: Sex_ifelse &lt;chr&gt;, Institution_ifelse &lt;chr&gt;,
## #   Pass_Fail &lt;chr&gt;, Grade &lt;chr&gt;, Institution_case_when &lt;chr&gt;,
## #   Grade_case_when &lt;chr&gt;</code></pre>
<p>In the new <code>institution_distinct</code> dataframe, we still have 4 institutions listed but we kept all 13 columns. If there are multiple rows with the same input (in this case 40 participants from 4 different institutions), <code>distinct()</code> only preserves the first row a new value occurs.</p>
<p>The <code>distinct()</code> function also allows you to eliminate duplicate rows with multiple variables in the dataframe. So if we wanted to see where participants were studying but also the different sexes taking part in the study, we would code…</p>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="#cb363-1" aria-hidden="true" tabindex="-1"></a>institution_sex_distinct <span class="ot">&lt;-</span> fake_data <span class="sc">%&gt;%</span> </span>
<span id="cb363-2"><a href="#cb363-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(Institution_char, Sex_char)</span>
<span id="cb363-3"><a href="#cb363-3" aria-hidden="true" tabindex="-1"></a>institution_sex_distinct</span></code></pre></div>
<pre><code>## # A tibble: 10 x 2
##    Sex_char Institution_char
##    &lt;chr&gt;    &lt;chr&gt;           
##  1 Male     GCU             
##  2 Male     UoG             
##  3 Male     UWS             
##  4 Male     Strathclyde     
##  5 Female   Strathclyde     
##  6 Female   GCU             
##  7 Female   UWS             
##  8 Female   UoG             
##  9 Other    Strathclyde     
## 10 Other    UoG</code></pre>
<p><code>institution_sex_distinct</code> has 10 observations, so that means, we have at least 1 male and 1 female participant from each of the 4 institutions. Additionally, Strathclyde and Glasgow have participants classifying as neither male nor female (here coded as “Other”).</p>
<div class="question">
<p>
You can see they are not sorted by either of the column. Why is
that?
</p>
</div>
<div class="webex-solution">
<button>
Solution
</button>
<div class="solved">
<p>
The values are sorted by occurrence. R goes through the tibble row by
row to determine whether the values are distinct from the ones in the
row before. So if you look at your original dataframe
<code>fake_data</code>, you can see the first row is a male participant
from Glasgow Caledonian University. The participant in row 2 is from the
University of Glasgow, but so is participant 3 (which means he is not
listed in the distinct tibble). The next unique value would be detected
in row 4, then in row 7, then in row 18, 20, 22, 23, 38, and 39.
</p>
</div>
</div>
</div>
<div id="recap" class="section level2 hasAnchor" number="6.5">
<h2 class="hasAnchor"><span class="header-section-number">6.5</span> Recap<a href="#recap" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let’s just have some fun with <code>fake_data</code> whilst recapping a little bit of what we did in the past 5 weeks.</p>
<div id="question-1" class="section level3 hasAnchor" number="6.5.1">
<h3 class="hasAnchor"><span class="header-section-number">6.5.1</span> Question 1<a href="#question-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Select the variables <code>PP_ID</code>, <code>Sex_char</code>, <code>Age</code>, <code>Institution_char</code>, <code>Grade_points</code>, <code>Grade</code>, and <code>Pass_Fail</code> from <code>fake_data</code>and save it as <code>fake_data</code> in your Global Environment (i.e. overwrite/replace <code>fake_data</code>). Rename the following variables in the process:</p>
<ul>
<li><code>PP_ID</code> as <code>Participant_ID</code></li>
<li><code>Sex_char</code> as <code>Sex</code></li>
<li><code>Institution_char</code> as <code>Institution</code></li>
</ul>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb365-1"><a href="#cb365-1" aria-hidden="true" tabindex="-1"></a>fake_data <span class="ot">&lt;-</span> <span class="cn">NULL</span></span></code></pre></div>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb366-1"><a href="#cb366-1" aria-hidden="true" tabindex="-1"></a><span class="co"># solution using select:</span></span>
<span id="cb366-2"><a href="#cb366-2" aria-hidden="true" tabindex="-1"></a>fake_data <span class="ot">&lt;-</span> fake_data <span class="sc">%&gt;%</span> </span>
<span id="cb366-3"><a href="#cb366-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">Participant_ID =</span> PP_ID, <span class="at">Sex =</span> Sex_char, Age, <span class="at">Institution =</span> Institution_char, Grade_points, Grade, Pass_Fail)</span>
<span id="cb366-4"><a href="#cb366-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb366-5"><a href="#cb366-5" aria-hidden="true" tabindex="-1"></a>fake_data</span></code></pre></div>
<pre><code>## # A tibble: 40 x 7
##    Participant_ID Sex     Age Institution Grade_points Grade Pass_Fail
##             &lt;int&gt; &lt;chr&gt; &lt;int&gt; &lt;chr&gt;              &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;    
##  1              1 Male     19 GCU                    0 H     Fail     
##  2              2 Male     22 UoG                   20 A     Pass     
##  3              3 Male     24 UoG                   15 B     Pass     
##  4              4 Male     29 UWS                   20 A     Pass     
##  5              5 Male     16 Strathclyde           11 D     Pass     
##  6              6 Male     25 GCU                   22 A     Pass     
##  7              7 Male     37 UoG                   21 A     Pass     
##  8              8 Male     18 UWS                    9 D     Fail     
##  9              9 Male     38 GCU                   13 C     Pass     
## 10             10 Male     39 UWS                   22 A     Pass     
## # ... with 30 more rows</code></pre>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb368-1"><a href="#cb368-1" aria-hidden="true" tabindex="-1"></a><span class="co"># solution involving select and rename:</span></span>
<span id="cb368-2"><a href="#cb368-2" aria-hidden="true" tabindex="-1"></a><span class="co"># fake_data &lt;- fake_data %&gt;% </span></span>
<span id="cb368-3"><a href="#cb368-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   select(PP_ID, Sex_char, Age, Institution_char, Grade_points, Grade, Pass_Fail) %&gt;%</span></span>
<span id="cb368-4"><a href="#cb368-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   rename(Participant_ID = PP_ID, Sex = Sex_char, Institution = Institution_char)</span></span></code></pre></div>
</div>
</div>
<div id="question-2" class="section level3 hasAnchor" number="6.5.2">
<h3 class="hasAnchor"><span class="header-section-number">6.5.2</span> Question 2<a href="#question-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Calculate the average grade points for each University. Store the output as a new object <code>grade_points</code> in your <code>Global Environment</code>. The new column should be named <code>Average_grade_points</code>.</p>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb369-1"><a href="#cb369-1" aria-hidden="true" tabindex="-1"></a>grade_points <span class="ot">&lt;-</span> <span class="cn">NULL</span></span></code></pre></div>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb370"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb370-1"><a href="#cb370-1" aria-hidden="true" tabindex="-1"></a>grade_points <span class="ot">&lt;-</span> fake_data <span class="sc">%&gt;%</span> </span>
<span id="cb370-2"><a href="#cb370-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Institution) <span class="sc">%&gt;%</span> </span>
<span id="cb370-3"><a href="#cb370-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Average_grade_points =</span> <span class="fu">mean</span>(Grade_points)) <span class="sc">%&gt;%</span> </span>
<span id="cb370-4"><a href="#cb370-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb370-5"><a href="#cb370-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb370-6"><a href="#cb370-6" aria-hidden="true" tabindex="-1"></a>grade_points</span></code></pre></div>
<pre><code>## # A tibble: 4 x 2
##   Institution Average_grade_points
##   &lt;chr&gt;                      &lt;dbl&gt;
## 1 GCU                         15.8
## 2 Strathclyde                 16.8
## 3 UoG                         18  
## 4 UWS                         14.1</code></pre>
</div>
</div>
<div id="question-3" class="section level3 hasAnchor" number="6.5.3">
<h3 class="hasAnchor"><span class="header-section-number">6.5.3</span> Question 3<a href="#question-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Join the <code>fake_data</code> and <code>grade_points</code>, and calculate how much each person differs from the mean of their university. Results should be stored in a column named <code>grade_diff</code>. Store the output in your <code>Global Environment</code> as a new object called <code>fake_data_meandiff</code>. Sort the data by <code>Institution</code> and <code>Sex</code>.</p>
<div class="sourceCode" id="cb372"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb372-1"><a href="#cb372-1" aria-hidden="true" tabindex="-1"></a>fake_data_meandiff <span class="ot">&lt;-</span> <span class="cn">NULL</span></span></code></pre></div>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb373"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb373-1"><a href="#cb373-1" aria-hidden="true" tabindex="-1"></a>fake_data_meandiff <span class="ot">&lt;-</span> <span class="fu">left_join</span>(fake_data, grade_points) <span class="sc">%&gt;%</span> </span>
<span id="cb373-2"><a href="#cb373-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">grade_diff =</span> Grade_points <span class="sc">-</span> Average_grade_points) <span class="sc">%&gt;%</span> </span>
<span id="cb373-3"><a href="#cb373-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Institution, Sex)</span></code></pre></div>
<pre><code>## Joining, by = &quot;Institution&quot;</code></pre>
<div class="sourceCode" id="cb375"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb375-1"><a href="#cb375-1" aria-hidden="true" tabindex="-1"></a>fake_data_meandiff</span></code></pre></div>
<pre><code>## # A tibble: 40 x 9
##    Participant_ID Sex      Age Institution Grade_points Grade Pass_Fail
##             &lt;int&gt; &lt;chr&gt;  &lt;int&gt; &lt;chr&gt;              &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;    
##  1             20 Female    34 GCU                   20 A     Pass     
##  2             21 Female    27 GCU                   10 D     Pass     
##  3             28 Female    39 GCU                   16 B     Pass     
##  4             36 Female    16 GCU                   21 A     Pass     
##  5              1 Male      19 GCU                    0 H     Fail     
##  6              6 Male      25 GCU                   22 A     Pass     
##  7              9 Male      38 GCU                   13 C     Pass     
##  8             11 Male      30 GCU                   19 A     Pass     
##  9             16 Male      26 GCU                   17 B     Pass     
## 10             17 Male      33 GCU                   20 A     Pass     
## # ... with 30 more rows, and 2 more variables: Average_grade_points &lt;dbl&gt;,
## #   grade_diff &lt;dbl&gt;</code></pre>
</div>
</div>
<div id="question-4" class="section level3 hasAnchor" number="6.5.4">
<h3 class="hasAnchor"><span class="header-section-number">6.5.4</span> Question 4<a href="#question-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Our colleague is interested in what the grade point average for each university would be if we were only looking at the students who passed the R assignment initially (i.e. grade points above 9). Store the output in your <code>Global Environment</code> as a new object called <code>fake_data_pass</code>.</p>
<div class="sourceCode" id="cb377"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb377-1"><a href="#cb377-1" aria-hidden="true" tabindex="-1"></a>fake_data_pass <span class="ot">&lt;-</span> <span class="cn">NULL</span></span></code></pre></div>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb378"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb378-1"><a href="#cb378-1" aria-hidden="true" tabindex="-1"></a><span class="co"># filter Grade_points</span></span>
<span id="cb378-2"><a href="#cb378-2" aria-hidden="true" tabindex="-1"></a>fake_data_pass <span class="ot">&lt;-</span> fake_data <span class="sc">%&gt;%</span> </span>
<span id="cb378-3"><a href="#cb378-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Grade_points <span class="sc">&gt;</span> <span class="dv">9</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb378-4"><a href="#cb378-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Institution) <span class="sc">%&gt;%</span> </span>
<span id="cb378-5"><a href="#cb378-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Average_grade_points_pass =</span> <span class="fu">mean</span>(Grade_points)) <span class="sc">%&gt;%</span> </span>
<span id="cb378-6"><a href="#cb378-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb378-7"><a href="#cb378-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb378-8"><a href="#cb378-8" aria-hidden="true" tabindex="-1"></a><span class="co"># filter Pass_Fail</span></span>
<span id="cb378-9"><a href="#cb378-9" aria-hidden="true" tabindex="-1"></a>fake_data_pass <span class="ot">&lt;-</span> fake_data <span class="sc">%&gt;%</span> </span>
<span id="cb378-10"><a href="#cb378-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Pass_Fail <span class="sc">==</span> <span class="st">&quot;Pass&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb378-11"><a href="#cb378-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Institution) <span class="sc">%&gt;%</span> </span>
<span id="cb378-12"><a href="#cb378-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Average_grade_points_pass =</span> <span class="fu">mean</span>(Grade_points)) <span class="sc">%&gt;%</span> </span>
<span id="cb378-13"><a href="#cb378-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb378-14"><a href="#cb378-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb378-15"><a href="#cb378-15" aria-hidden="true" tabindex="-1"></a>fake_data_pass</span></code></pre></div>
<pre><code>## # A tibble: 4 x 2
##   Institution Average_grade_points_pass
##   &lt;chr&gt;                           &lt;dbl&gt;
## 1 GCU                              17.6
## 2 Strathclyde                      16.8
## 3 UoG                              18  
## 4 UWS                              16.5</code></pre>
</div>
</div>
<div id="question-5" class="section level3 hasAnchor" number="6.5.5">
<h3 class="hasAnchor"><span class="header-section-number">6.5.5</span> Question 5<a href="#question-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now our colleague wants to know whether the males or the females did better at each university. They are asking for a table with 4 columns in which the first column titled <code>Institution</code> lists the university, the second column is called <code>Males</code> for the average grade point scores of the males at each institution, the third column called <code>Females</code> with average grade point scores for the females, and the fourth column <code>Better</code> should say <code>"female"</code> or <code>"male"</code> if the females or males had higher grade points respectively. Store the output in your <code>Global Environment</code> as a new object called <code>fake_data_sex</code>. Use <code>fake_data</code> as the reference dataframe.</p>
<div class="sourceCode" id="cb380"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb380-1"><a href="#cb380-1" aria-hidden="true" tabindex="-1"></a>fake_data_sex <span class="ot">&lt;-</span> <span class="cn">NULL</span></span></code></pre></div>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb381"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb381-1"><a href="#cb381-1" aria-hidden="true" tabindex="-1"></a>fake_data_sex <span class="ot">&lt;-</span> fake_data <span class="sc">%&gt;%</span> </span>
<span id="cb381-2"><a href="#cb381-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Sex <span class="sc">!=</span> <span class="st">&quot;Other&quot;</span>) <span class="sc">%&gt;%</span> <span class="co"># this step could actually be left out</span></span>
<span id="cb381-3"><a href="#cb381-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Institution, Sex) <span class="sc">%&gt;%</span> </span>
<span id="cb381-4"><a href="#cb381-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Average_gp =</span> <span class="fu">mean</span>(Grade_points)) <span class="sc">%&gt;%</span> </span>
<span id="cb381-5"><a href="#cb381-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb381-6"><a href="#cb381-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from=</span>Sex, <span class="at">values_from=</span>Average_gp) <span class="sc">%&gt;%</span> </span>
<span id="cb381-7"><a href="#cb381-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Institution, <span class="at">Males =</span> Male, <span class="at">Females =</span> Female) <span class="sc">%&gt;%</span> </span>
<span id="cb381-8"><a href="#cb381-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Better =</span> <span class="fu">ifelse</span>(Males <span class="sc">&gt;</span> Females, <span class="st">&quot;male&quot;</span>, <span class="st">&quot;female&quot;</span>))</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;Institution&#39;. You can override using the
## `.groups` argument.</code></pre>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb383-1"><a href="#cb383-1" aria-hidden="true" tabindex="-1"></a>fake_data_sex</span></code></pre></div>
<pre><code>## # A tibble: 4 x 4
##   Institution Males Females Better
##   &lt;chr&gt;       &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt; 
## 1 GCU          15.2    16.8 female
## 2 Strathclyde  11.5    18.2 female
## 3 UoG          18.7    17.8 male  
## 4 UWS          12.3    16.8 female</code></pre>
</div>
</div>
</div>
<div id="summative-homework-2" class="section level2 hasAnchor" number="6.6">
<h2 class="hasAnchor"><span class="header-section-number">6.6</span> Summative Homework<a href="#summative-homework-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The third summative assignment is available on moodle now.</p>
<p>Good luck.</p>
<p>Check that your Rmd file knits into a html file before submitting. Upload your Rmd file (not the knitted html) to moodle.</p>
<!--chapter:end:06-dplyr_4.Rmd-->
</div>
</div>
<div id="data-visualisation-1" class="section level1 hasAnchor" number="7">
<h1 class="hasAnchor"><span class="header-section-number">7</span> Data Visualisation 1<a href="#data-visualisation-1" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This week we are moving on to plots. You have learned how to get your data into a usable format, so now it is time for you to learn how to visualise your data. Visualisations are important as they tell us how our data looks like; help us discover outlier variables, tells us about distribution abnormalities etc. Plots also help your reader to better understand the data that you are working with.</p>
<div id="pre-class-activities" class="section level2 hasAnchor" number="7.1">
<h2 class="hasAnchor"><span class="header-section-number">7.1</span> Pre-class Activities<a href="#pre-class-activities" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Before you start this week’s class, here are some pre-class readings:</p>
<ul>
<li><a href="https://getpocket.com/explore/item/five-ways-to-lie-with-charts?utm_source=pocket-newtab-global-en-GB">Five Ways to Lie with Charts</a></li>
<li><a href="https://www.autodeskresearch.com/publications/samestats">Datasaurus Dosen</a> - How a T-Rex convinced people to plot their data (and a fun visualisation of the principle in this <a href="https://twitter.com/ameisen_strasse/status/1316133566972125186">thread</a> )</li>
<li><a href="https://en.wikipedia.org/wiki/Anscombe%27s_quartet">Anscombe’s Quartet</a> - Old school version of datasaurus</li>
<li><a href="https://medium.com/information-visualization/5-things-you-should-focus-on-when-designing-graphs-693a16421040">Tips on Graph making</a></li>
<li>Here is a webspace with a large compilation of graphs that will help you develop a better understanding of what style you can use for the data you have and for the message you are trying to convey. The graphs also come with R code for you to adapt to data you might have. - <a href="https://www.r-graph-gallery.com/index.html">The R Graph Gallery</a></li>
<li>Pre-class <a href="https://youtu.be/vP9hgPOvU1s">video</a></li>
</ul>
</div>
<div id="intended-learning-outcomes-7" class="section level2 unnumbered hasAnchor">
<h2 class="unnumbered hasAnchor">Intended Learning Outcomes<a href="#intended-learning-outcomes-7" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li>Develop an understanding of the basics of ggplot2 and how layering works</li>
<li>Learn how to make simple two layer plots</li>
<li>Learn how to make plots with more than 2 layers</li>
<li>Learn how to create groups in plots</li>
<li>Learn how to make a variety of plots based on the type of variables we have</li>
</ol>
<p>This lesson is led by Sean Wood.</p>
</div>
<div id="pre-steps-5" class="section level2 hasAnchor" number="7.2">
<h2 class="hasAnchor"><span class="header-section-number">7.2</span> Pre-steps<a href="#pre-steps-5" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Today, we will be working with <code>ggplot2</code> which is part of <code>tidyverse</code> and data from the Scottish Government saved in the file <code>free_movement_uk.csv</code>.</p>
<p>Firstly, load <code>tidyverse</code>, and then read the data into your <code>Global Environment</code> as <code>migration_scot</code>.</p>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb385-1"><a href="#cb385-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb385-2"><a href="#cb385-2" aria-hidden="true" tabindex="-1"></a>migration_scot <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;free_movement_uk.csv&quot;</span>) <span class="co">#downloaded from the Scottish Government Stats website</span></span></code></pre></div>
</div>
<div id="introduction-to-the-data" class="section level2 hasAnchor" number="7.3">
<h2 class="hasAnchor"><span class="header-section-number">7.3</span> Introduction to the data<a href="#introduction-to-the-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This data is openly available from the Scottish Government, and it introduces the flow of people at different ages and sex into and out of the Scotland from the rest of UK (RUK) and Overseas. We have several variables to work with:</p>
<table>
<colgroup>
<col width="23%" />
<col width="76%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">FeatureCode</td>
<td align="left">Codes given by the Scottish Government</td>
</tr>
<tr class="even">
<td align="left">DateCode</td>
<td align="left">Year of data collected</td>
</tr>
<tr class="odd">
<td align="left">Measurement</td>
<td align="left">What type of measurement it is (here we have only counts i.e. the number of people)</td>
</tr>
<tr class="even">
<td align="left">Units</td>
<td align="left">Units (here we have number of people)</td>
</tr>
<tr class="odd">
<td align="left">Value</td>
<td align="left">The actual count (i.e. the number of people)</td>
</tr>
<tr class="even">
<td align="left">Age</td>
<td align="left">Age of the counted people (separate by age, and total (sum of all age groups))</td>
</tr>
<tr class="odd">
<td align="left">Sex</td>
<td align="left">Sex of the counted people (separate by sex, and total (sum all sex groups))</td>
</tr>
<tr class="even">
<td align="left">Migration Source</td>
<td align="left">Where the people are coming from (Overseas, RUK)</td>
</tr>
<tr class="odd">
<td align="left">Migration Type</td>
<td align="left">Whether people are coming or leaving (In, Out, and Net (people coming in less the people leaving))</td>
</tr>
</tbody>
</table>
<p>The data is a bit messy, so let’s clean it a little bit before we can work with it. When we make plots, we want to make sure that the data we are working with contains only data that we are going to include in the plot. This helps us avoid things like double counting. For example, if we have values for males and females and total, but we do not want to give separate representations for males and females, then we would only keep information that gives us the total number.</p>
</div>
<div id="some-warm-up-tasks" class="section level2 hasAnchor" number="7.4">
<h2 class="hasAnchor"><span class="header-section-number">7.4</span> Some warm-up tasks<a href="#some-warm-up-tasks" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Use pipes <code>%&gt;%</code> for the following 4 tasks and save your data into the <strong>traffic_scot</strong> variable so that it appears in your <code>Global Environment</code>.</p>
<ol style="list-style-type: decimal">
<li>Select only the necessary variable - <code>DateCode</code>, <code>Value</code>, <code>Sex</code>, <code>Age</code>, <code>Migration Source</code> &amp; <code>Migration Type</code> (notice that some variable names include spaces)</li>
<li>Filter the data in column <code>DateCode</code>, and keep only observations from 2016</li>
<li>Keep only the total number of people by <code>Age</code> (‘All’) and <code>Sex</code> (‘All’)</li>
<li>Keep only the information about the number of people that came to and left Scotland (we do not want to know about the net value)</li>
</ol>
<div class="sourceCode" id="cb386"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb386-1"><a href="#cb386-1" aria-hidden="true" tabindex="-1"></a>traffic_scot <span class="ot">&lt;-</span> <span class="cn">NULL</span></span></code></pre></div>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb387"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb387-1"><a href="#cb387-1" aria-hidden="true" tabindex="-1"></a>traffic_scot <span class="ot">&lt;-</span> migration_scot <span class="sc">%&gt;%</span> </span>
<span id="cb387-2"><a href="#cb387-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(DateCode, Value, Sex, Age, <span class="st">`</span><span class="at">Migration Source</span><span class="st">`</span>, <span class="st">`</span><span class="at">Migration Type</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb387-3"><a href="#cb387-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(DateCode <span class="sc">==</span> <span class="st">&#39;2016&#39;</span>, </span>
<span id="cb387-4"><a href="#cb387-4" aria-hidden="true" tabindex="-1"></a>         Age <span class="sc">==</span> <span class="st">&#39;All&#39;</span>, </span>
<span id="cb387-5"><a href="#cb387-5" aria-hidden="true" tabindex="-1"></a>         Sex <span class="sc">!=</span> <span class="st">&#39;All&#39;</span>, </span>
<span id="cb387-6"><a href="#cb387-6" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Migration Type</span><span class="st">`</span> <span class="sc">!=</span> <span class="st">&#39;Net&#39;</span>)</span></code></pre></div>
</div>
</div>
<div id="the-package-ggplot2" class="section level2 hasAnchor" number="7.5">
<h2 class="hasAnchor"><span class="header-section-number">7.5</span> The package GGPLOT2<a href="#the-package-ggplot2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We use the <code>ggplot2</code> package due to its ease of layering and variety. With <code>ggplot2</code> we can create beautiful and varied plots that can show us much more than just the simplicity of the base R plots. Whereas the plot/graph’s job is to visualise the data, how you visualise your data is very important. Sometimes in an attempt to show off our plotting skills, we can make the graph difficult to read. Today and next week, using <code>ggplot2</code> we will streamline the process of plot creation.</p>
</div>
<div id="layering" class="section level2 hasAnchor" number="7.6">
<h2 class="hasAnchor"><span class="header-section-number">7.6</span> Layering<a href="#layering" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Plots created with <code>ggplot2</code> work in a layering format. In the simplest form we have two layers.</p>
<ul>
<li>Layer 1: what data are we going to use
<ul>
<li><strong>+</strong></li>
</ul></li>
<li>Layer 2: how do we want it to look</li>
</ul>
<p>Layer 1: ggplot(data, aes(x, y, …)) + <br>
Layer 2: geom_something(…)</p>
<div id="layer-1" class="section level3 hasAnchor" number="7.6.1">
<h3 class="hasAnchor"><span class="header-section-number">7.6.1</span> Layer 1<a href="#layer-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Plots always start with <em>ggplot()</em>. This initialises the plot. It is used to tell <em>R</em> what data we are going to use. We can also set the aesthetics of the plot which will be used to specify the axes of our plot, any groupings, variables we are going to colour based on, etc. Unless specifically overwritten in the following layers, all the data information you give in this first layer will be inherited in every following layer.</p>
<p>For now we are going to stick with one global specification - i.e. we are going to specify all our data in this first layer.</p>
<p>If you run just the first command, R is going to show you the first layer - i.e. a blank screen. R has prepared a space for you to create your plot.</p>
<p>Let’s try it.</p>
<div class="sourceCode" id="cb388"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb388-1"><a href="#cb388-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()</span></code></pre></div>
<p><img src="Intro-to-R-GU-Open-Studies-2021-2022_files/figure-html/unnamed-chunk-270-1.png" width="672" /></p>
<p>Now let’s add some information. Let’s include the data and the axes. From our data <code>traffic_scot</code> let’s put <code>Sex</code> on the x-axis and <code>Value</code> on the y-axis. This way we can visualise how many people from each sex category came to and left Scotland overall.</p>
<p>What’s the difference with the empty plot above?</p>
<div class="sourceCode" id="cb389"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb389-1"><a href="#cb389-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(traffic_scot, <span class="fu">aes</span>(<span class="at">x =</span> Sex, <span class="at">y =</span> Value))</span></code></pre></div>
<p><img src="Intro-to-R-GU-Open-Studies-2021-2022_files/figure-html/unnamed-chunk-271-1.png" width="672" /></p>
<div class="question">
<p>
What is the difference in the produced plots from the above two lines
of code? What does the first layer give you?
</p>
</div>
<div class="webex-solution">
<button>
Solution
</button>
<div class="solved">
<p>
If you look closely, new plot we have created with the first layer of
<code>ggplot2</code> gives us numbers on y-axis and the two sexes on the
x-axis. We also now have the titles of the two axes. We do not have any
view of the data because we have not told <code>R</code> how we want to
visualise the data. R only knows what the data is.
</p>
</div>
</div>
</div>
<div id="layer-2-and-onward" class="section level3 hasAnchor" number="7.6.2">
<h3 class="hasAnchor"><span class="header-section-number">7.6.2</span> Layer 2 and onward<a href="#layer-2-and-onward" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>From the second layer onward, we are specifying how we want our plot to look: from the type of graph to the titles and colours. For now, we are going to stick with the basics.</p>
</div>
</div>
<div id="how-do-we-choose-the-type-of-plot" class="section level2 hasAnchor" number="7.7">
<h2 class="hasAnchor"><span class="header-section-number">7.7</span> How do we choose the type of plot?<a href="#how-do-we-choose-the-type-of-plot" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>There are numerous plots we can choose from, and we are going to try several today.</p>
<p>Before plotting we need to know what types of data we want to portray.</p>
<p>Depending on whether our data is categorical or continuous, the type of plot that is most appropriate will change.</p>
<div id="data-format" class="section level3 hasAnchor" number="7.7.1">
<h3 class="hasAnchor"><span class="header-section-number">7.7.1</span> Data format<a href="#data-format" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="continuous" class="section level4 hasAnchor" number="7.7.1.1">
<h4 class="hasAnchor"><span class="header-section-number">7.7.1.1</span> Continuous<a href="#continuous" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In continuous data the distance between any two consecutive points is equivalent to the distance between any other two consecutive points - i.e. the difference between 1 and 2 is the same as the difference between 3 and 4, or 5 and 6 etc. If you think back to <code>L2</code>, integer and double data types will fall in this category.</p>
</div>
<div id="categorical" class="section level4 hasAnchor" number="7.7.1.2">
<h4 class="hasAnchor"><span class="header-section-number">7.7.1.2</span> Categorical<a href="#categorical" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Categorical data, simply put, groups (categorises) data. The data in each group or category vary solely on one characteristic and usually those characteristics cannot be ranked - i.e. sex, race, nationality etc. If you think back to <code>L2</code>, logical and character data types will fall in this category.</p>
<div class="question">
<p>
Can you think of a time when a continuous variable can be used as
categorical and/or categorical data can be used as continuous?
</p>
</div>
<div class="webex-solution">
<button>
Solution
</button>
<div class="solved">
<p>
Continuous that is really categorical: If you have used the numbers
1, 2, 3 … to label groups in your data, then that data is
integer/double, but in reality the difference between 1 and 2 is in no
way measurable. In this case you will have to transform that column in
your data and change it from continuous to categorical, so R does not
misinterpret it. if you do not remember how to do that, go back to
<code>L2</code>.
</p>
<p>
Categorical that can be used as continuous: Sometimes you have
questions where people answer from Strongly Agree to Strongly Disagree,
and you have given numeric values to the responses: 1 = Strongly Agree,
2 = Agree, 3 = Neutral, etc. In reality, you cannot say that the
distance between Strongly Agree and Agree is the same as the distance
between Agree and Neutral. However, we can make the assumption that they
represent equal distances and treat the numbers as a continuous scale.
In fact, this is often done in Psychology and the Social Sciences.
</p>
</div>
</div>
</div>
</div>
<div id="number-of-variables" class="section level3 hasAnchor" number="7.7.2">
<h3 class="hasAnchor"><span class="header-section-number">7.7.2</span> Number of variables<a href="#number-of-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Next we need to know the relationship between how many variables we want to show. In a 2D plot, we can usually graphically show between 1 and 3 variables with ease. After that, **usually*_** more than 2 dimensions are necessary.</p>
<div class="task">
<p>
Look at the five plots below. What type of data are used: categorical
or continuous, or both? How many variables do we need to create these
plots?
</p>
</div>
<p><img src="Intro-to-R-GU-Open-Studies-2021-2022_files/figure-html/unnamed-chunk-277-1.png" width="672" /></p>
<div class="webex-solution">
<button>
Solution
</button>
<div class="solved">
<p>
3 variables: 2 continuous (depth &amp; density), 1 categorical (cut)
<strong>In reality R only needs depth and cut, as it will calculate
density for us.</strong>
</p>
</div>
</div>
<p><img src="Intro-to-R-GU-Open-Studies-2021-2022_files/figure-html/unnamed-chunk-279-1.png" width="672" /></p>
<div class="webex-solution">
<button>
Solution
</button>
<div class="solved">
<p>
3 variables: 2 categorical (clarity &amp; cut), 1 continuous
(price)
</p>
</div>
</div>
<p><img src="Intro-to-R-GU-Open-Studies-2021-2022_files/figure-html/unnamed-chunk-281-1.png" width="672" /></p>
<div class="webex-solution">
<button>
Solution
</button>
<div class="solved">
<p>
2 variables: 1 categorical (group), 1 continuous (outcome)
</p>
</div>
</div>
<p><img src="Intro-to-R-GU-Open-Studies-2021-2022_files/figure-html/unnamed-chunk-283-1.png" width="672" /></p>
<div class="webex-solution">
<button>
Solution
</button>
<div class="solved">
<p>
2 variables: 2 continuous (unemployment &amp; date)
</p>
</div>
</div>
<p><img src="Intro-to-R-GU-Open-Studies-2021-2022_files/figure-html/unnamed-chunk-285-1.png" width="672" /></p>
<div class="webex-solution">
<button>
Solution
</button>
<div class="solved">
<p>
3 variables: 2 continuous (Net worth &amp; Probability of being
happy), 1 categorical (group)
</p>
</div>
</div>
<div class="info">
<p>
<strong>Tip</strong>: Most of the time, if you cannot represent a
graph in 2D then you are probably trying to show too much, and you
should reconsider splitting it into multiple plots.
</p>
</div>
<p>Let’s get back to our free movement data that we started with in the section above. Remember we wanted to visualise how many people from each sex category came to and left Scotland.</p>
<div class="question">
<p>
How many variables have we chosen so far? Type the number in the box
below.
</p>
</div>
<p><input class='webex-solveme nospaces' size='1' data-answer='["2"]'/> <br></p>
<div class="question">
<p>
What types of data are we trying to plot according to our first
layer? Continuous, categorical, or both?
</p>
</div>
<div class="webex-solution">
<button>
Solution
</button>
<div class="solved">
<p>
We are using both continuous (value i.e. count of people) and
categorical (sex).
</p>
</div>
</div>
</div>
<div id="types-of-plots" class="section level3 hasAnchor" number="7.7.3">
<h3 class="hasAnchor"><span class="header-section-number">7.7.3</span> Types of plots<a href="#types-of-plots" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There is variety of plots that we can create using ggplot2. We select the plot by adding on <code>geom_???()</code>. Instead of the <strong>???</strong> we specify the type of plot we want to make. Below are some examples, but you can see more here: ggplot2 layers.</p>
<table>
<colgroup>
<col width="23%" />
<col width="76%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Geom</th>
<th align="left">Plot type</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>geom_col()</code> <code>geom_bar()</code></td>
<td align="left">Bar plots</td>
</tr>
<tr class="even">
<td align="left"><code>geom_boxplot()</code></td>
<td align="left">Box with whiskers plot</td>
</tr>
<tr class="odd">
<td align="left"><code>geom_density()</code></td>
<td align="left">Density plot</td>
</tr>
<tr class="even">
<td align="left"><code>geom_histogram()</code></td>
<td align="left">Histogram</td>
</tr>
<tr class="odd">
<td align="left"><code>geom_point()</code></td>
<td align="left">Scatter plot</td>
</tr>
<tr class="even">
<td align="left"><code>geom_jitter()</code></td>
<td align="left">Jittered points plot</td>
</tr>
<tr class="odd">
<td align="left"><code>geom_line()</code></td>
<td align="left">Line plot</td>
</tr>
<tr class="even">
<td align="left"><code>geom_violin()</code></td>
<td align="left">Violin plot</td>
</tr>
<tr class="odd">
<td align="left"><code>geom_smooth()</code></td>
<td align="left">Smoothed conditional means (often used to add a regression line)</td>
</tr>
</tbody>
</table>
<p>Let’s create a column/bar plot to visualise the data using <code>geom_col()</code>. What does the data look like?</p>
<div class="sourceCode" id="cb390"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb390-1"><a href="#cb390-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(traffic_scot, <span class="fu">aes</span>(<span class="at">x =</span> Sex, <span class="at">y =</span> Value)) <span class="sc">+</span> </span>
<span id="cb390-2"><a href="#cb390-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>()</span></code></pre></div>
<p><img src="Intro-to-R-GU-Open-Studies-2021-2022_files/figure-html/unnamed-chunk-291-1.png" width="672" /></p>
<div class="question">
<p>
Considering what we know from the data description and the different
variable in it, do we need another variable to make the plot more
informative? If yes, which one?
</p>
</div>
<p><input class='webex-solveme nospaces ignorecase' size='14' data-answer='["Migration Type"]'/> <br></p>
<div class="webex-solution">
<button>
Explanation
</button>
<div class="solved">
<p>
If you worked in the immigration office, you would want to know how
many people left and how many people came to Scotland. Knowing how many
people moved about is not particularly informative. In what ways can we
differentiate the males and females who came to and who went out of
Scotland? Separating the data by <code>Migration Type</code> would tell
us whether the people came into or left Scotland.
</p>
</div>
</div>
</div>
<div id="groupings" class="section level3 hasAnchor" number="7.7.4">
<h3 class="hasAnchor"><span class="header-section-number">7.7.4</span> Groupings<a href="#groupings" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When we want to group data to provide a better representation, we can usually use colour, shapes etc. Most of the time, this will depend on the type of graph we want to create. If we are using line graphs, then colours are usually best. If we are using dot plots then we can use the shape as well as the colours to differentiate the different groups.</p>
<p>Let’s first look at colour.</p>
<p>Depending on the type of graph, colouring in can be done either with <code>colour</code> or with <code>fill</code>. For our column plots we use <code>fill.</code> If we used <code>colour</code>, then we would get different colours for the outlines. You can find out whether to use colour or fill by typing the name of the geom in the Help search bar or typing <code>?geom_col()</code> in the console and looking at the <strong>Aesthetics</strong> section.</p>
<div class="sourceCode" id="cb391"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb391-1"><a href="#cb391-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(traffic_scot, <span class="fu">aes</span>(<span class="at">x =</span> Sex, <span class="at">y =</span> Value, <span class="at">fill =</span> <span class="st">`</span><span class="at">Migration Type</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb391-2"><a href="#cb391-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">&#39;dodge&#39;</span>)</span></code></pre></div>
<p><img src="Intro-to-R-GU-Open-Studies-2021-2022_files/figure-html/unnamed-chunk-294-1.png" width="672" /></p>
<p>Let’s decompose the code above:</p>
<p>We have our data and our two variables. They are the same as before. This time we are saying that we want the data to be separated even further by <code>Migration Type</code> and we have given two different colours to the ‘In’ and ‘Out’ migration types using the additional argument <code>fill</code>.</p>
<p>We have also added the argument <code>position = 'dodge'</code> in the <code>geom_col()</code>. This makes sure that any groupings we create are then presented separately.</p>
<div class="task">
<p>
Simple task:
</p>
<ol style="list-style-type: decimal">
<li>
Remove <code>position =‘dodge’</code> from the geom and describe
what happens in your stub file.
</li>
</ol>
</div>
<div class="sourceCode" id="cb392"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb392-1"><a href="#cb392-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(traffic_scot, <span class="fu">aes</span>(<span class="at">x =</span> Sex, <span class="at">y =</span> Value, <span class="at">fill =</span> <span class="st">`</span><span class="at">Migration Type</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb392-2"><a href="#cb392-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>()</span></code></pre></div>
<p><img src="Intro-to-R-GU-Open-Studies-2021-2022_files/figure-html/unnamed-chunk-296-1.png" width="672" /></p>
<div class="task">
<p>
Simple task:
</p>
<ol start="2" style="list-style-type: decimal">
<li>
Use <code>position = ‘fill’</code> and describe what happens in your
stub.
</li>
</ol>
</div>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb393-1"><a href="#cb393-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create your plot here</span></span>
<span id="cb393-2"><a href="#cb393-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(traffic_scot, <span class="fu">aes</span>(<span class="at">x =</span> Sex, <span class="at">y =</span> Value, <span class="at">fill =</span> <span class="st">`</span><span class="at">Migration Type</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb393-3"><a href="#cb393-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">&#39;fill&#39;</span>)</span></code></pre></div>
<p><img src="Intro-to-R-GU-Open-Studies-2021-2022_files/figure-html/unnamed-chunk-298-1.png" width="672" /></p>
<div class="question">
<p>
What are the differences between ‘dodge’, ‘fill’ and no position
argument? (Use <code>?geom_col()</code> to help you).
</p>
</div>
<div class="webex-solution">
<button>
Explanation
</button>
<div class="solved">
<p>
If we use <code>position = ‘fill’</code> it stacks our data and it
also gives us proportions: check the y-axis between the plot with
<code>position = ‘fill’</code> and the one without any position
arguments. Whereas the plot without the position argument just stacks
information on top of one another, <code>position = ‘fill’</code> shows
relative proportions. Use the Help menu or put <strong>?</strong> in the
console in front of the function you want to know more about, for
example <code>?geom_col()</code>.
</p>
</div>
</div>
<p>The argument <code>position</code> is an argument specific for the <code>geom_col</code>. It is just one example of an additional argument that helps us to represent the data better. These types of arguments allow for better control over the plots that we create. To find what arguments each geom has, look for it in the Help section or put <strong>?</strong> in the <code>Console</code> in front of the function.</p>
<p>Geoms in <code>ggplot2</code> have a large selection of arguments to allow you to adjust your visualisations. This is what makes it one of the most preferred visualisation packages by the R community.</p>
<div id="more-groupings" class="section level4 hasAnchor" number="7.7.4.1">
<h4 class="hasAnchor"><span class="header-section-number">7.7.4.1</span> More groupings<a href="#more-groupings" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Now let’s imagine that we want to know whether the individuals are moving to/from Overseas or RUK as well as all the information we have so far. Should we create more groups? Let’s try also using colour as a grouping way, based on <code>Migration Source</code>.</p>
<div class="sourceCode" id="cb394"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb394-1"><a href="#cb394-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(traffic_scot, <span class="fu">aes</span>(<span class="at">x =</span> Sex, <span class="at">y =</span> Value, <span class="at">fill =</span> <span class="st">`</span><span class="at">Migration Type</span><span class="st">`</span>, <span class="at">colour =</span><span class="st">`</span><span class="at">Migration Source</span><span class="st">`</span>)) <span class="sc">+</span> </span>
<span id="cb394-2"><a href="#cb394-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">&#39;dodge&#39;</span>)</span></code></pre></div>
<p><img src="Intro-to-R-GU-Open-Studies-2021-2022_files/figure-html/unnamed-chunk-301-1.png" width="672" /></p>
<p>Here I have used the argument <code>colour</code> to give different borders to the migration sources. As you can see, this makes it much more difficult to see. Next week, we will work on separating the plots.</p>
<div class="question">
<p>
Would you think there is a better way to represent the data? Write it
down in your stub file.
</p>
</div>
</div>
</div>
</div>
<div id="now-lets-have-a-look-at-different-plots-with-more-complexity" class="section level2 hasAnchor" number="7.8">
<h2 class="hasAnchor"><span class="header-section-number">7.8</span> Now let’s have a look at different plots with more complexity<a href="#now-lets-have-a-look-at-different-plots-with-more-complexity" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Imagine you want to see the difference in the number of people coming into and moving out of Scotland from both the RUK and Overseas throughout the years, but you do not want to know the net flow of people, their age or their sex.</p>
<div class="question">
<p>
What variables would you use? Write them down in your stub file.
</p>
</div>
<div class="webex-solution">
<button>
Solution
</button>
<div class="solved">
<p>
DateCode, Migration Type, Migration Source, Value
</p>
</div>
</div>
<p>First, let’s get the data we will need. We want our selected variables from above, and the overall data for the rest of the variables i.e. the ‘all’ categories for <code>Age</code>, and <code>Sex</code>. Remember we want to look at people moving in and out, so we do not want the net <code>Migration Type</code>. Save the output into the variable <strong>trafic_scot2</strong> so that it appears in your <code>Global Environment</code>.</p>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb395-1"><a href="#cb395-1" aria-hidden="true" tabindex="-1"></a>traffic_scot2 <span class="ot">&lt;-</span> <span class="cn">NULL</span></span></code></pre></div>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb396"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb396-1"><a href="#cb396-1" aria-hidden="true" tabindex="-1"></a>traffic_scot2 <span class="ot">&lt;-</span> migration_scot <span class="sc">%&gt;%</span> </span>
<span id="cb396-2"><a href="#cb396-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Age <span class="sc">==</span> <span class="st">&#39;All&#39;</span>, </span>
<span id="cb396-3"><a href="#cb396-3" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Migration Type</span><span class="st">`</span> <span class="sc">!=</span> <span class="st">&#39;Net&#39;</span>,</span>
<span id="cb396-4"><a href="#cb396-4" aria-hidden="true" tabindex="-1"></a>         Sex <span class="sc">==</span> <span class="st">&#39;All&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb396-5"><a href="#cb396-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(DateCode, Value,<span class="st">`</span><span class="at">Migration Source</span><span class="st">`</span>, <span class="st">`</span><span class="at">Migration Type</span><span class="st">`</span>)</span></code></pre></div>
</div>
<div class="question">
<p>
What type of data are these variables?
</p>
</div>
<ul>
<li>DateCode: <select class='webex-select'><option value='blank'></option><option value='answer'>continuous</option><option value=''>categorical</option></select></li>
<li>Value: <select class='webex-select'><option value='blank'></option><option value='answer'>continuous</option><option value=''>categorical</option></select></li>
<li>Sex: <select class='webex-select'><option value='blank'></option><option value=''>continuous</option><option value='answer'>categorical</option></select></li>
<li>Migration Source:<select class='webex-select'><option value='blank'></option><option value=''>continuous</option><option value='answer'>categorical</option></select></li>
<li>Migration Type:<select class='webex-select'><option value='blank'></option><option value=''>continuous</option><option value='answer'>categorical</option></select></li>
</ul>
<p>So we need to use a different type of plot - one that can portray continuous data well enough.</p>
<p>Good way to portray data like this are point graphs (i.e. scatter plots) and line graphs.</p>
<p>We have several variables again. It will help if we separate them with different aesthetics.</p>
<p>Let’s start with a scatter plot.</p>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb397-1"><a href="#cb397-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(traffic_scot2, <span class="fu">aes</span>(DateCode, Value, </span>
<span id="cb397-2"><a href="#cb397-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">shape =</span> <span class="st">`</span><span class="at">Migration Source</span><span class="st">`</span>, </span>
<span id="cb397-3"><a href="#cb397-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">colour =</span> <span class="st">`</span><span class="at">Migration Type</span><span class="st">`</span>)) <span class="sc">+</span> </span>
<span id="cb397-4"><a href="#cb397-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() </span></code></pre></div>
<p><img src="Intro-to-R-GU-Open-Studies-2021-2022_files/figure-html/unnamed-chunk-308-1.png" width="672" /></p>
<p>This seems difficult to look at. Let’s make it easier by adding a line that connects the data. We can do this by adding another <strong>Layer</strong>.</p>
<div class="sourceCode" id="cb398"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb398-1"><a href="#cb398-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(traffic_scot2, <span class="fu">aes</span>(DateCode, Value, </span>
<span id="cb398-2"><a href="#cb398-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">shape =</span> <span class="st">`</span><span class="at">Migration Source</span><span class="st">`</span>,</span>
<span id="cb398-3"><a href="#cb398-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">colour =</span> <span class="st">`</span><span class="at">Migration Type</span><span class="st">`</span>)) <span class="sc">+</span> </span>
<span id="cb398-4"><a href="#cb398-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb398-5"><a href="#cb398-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="Intro-to-R-GU-Open-Studies-2021-2022_files/figure-html/unnamed-chunk-309-1.png" width="672" /></p>
<div class="question">
<p>
Question: How do we know that the line graph is going to connect the
<code>Migration Type</code> and not the <code>Migration Source</code>?
(Think about the aesthetics of <code>geom_line</code> and
<code>geom_point</code>)
</p>
</div>
<div class="webex-solution">
<button>
Solution
</button>
<div class="solved">
<p>
If we look up <code>geom_point()</code> and <code>geom_line()</code>
we can see the type of aesthetics that they take. Look them up in the
<code>Help</code> tab or by typing <code>?geom_point()</code> in the
console. There you will find a section called aesthetics, which will
tell you the aesthetics each of them can have. Because lines cannot use
an aesthetic of shape, it will only inherit the colour aesthetic from
<code>ggplot()</code>.
</p>
</div>
</div>
<div class="info">
<p>
Scatter and dot plots are excellent representations of the data as
they show us where each data point is. In this way no data can hide
behind a bar chart.
</p>
</div>
</div>
<div id="other-plots" class="section level2 hasAnchor" number="7.9">
<h2 class="hasAnchor"><span class="header-section-number">7.9</span> Other plots<a href="#other-plots" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let’s make some more plots.</p>
<p><strong>Violin plots and Box plots</strong>
We need a continuous variable and a categorical variable for both of them. In both of these the categorical variable usually goes on the x-axis and the continuous on the y axis.</p>
<p>Let’s get back to the original data and plot the distribution of all females entering and leaving Scotland from overseas, from all ages. For this, we need to tidy the data into what we need and store it into the variable <code>female_migration</code>.</p>
<div class="sourceCode" id="cb399"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb399-1"><a href="#cb399-1" aria-hidden="true" tabindex="-1"></a>female_migration <span class="ot">&lt;-</span> migration_scot <span class="sc">%&gt;%</span> </span>
<span id="cb399-2"><a href="#cb399-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Sex <span class="sc">==</span> <span class="st">&#39;Female&#39;</span>, </span>
<span id="cb399-3"><a href="#cb399-3" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Migration Source</span><span class="st">`</span> <span class="sc">==</span> <span class="st">&#39;To-from Overseas&#39;</span>, </span>
<span id="cb399-4"><a href="#cb399-4" aria-hidden="true" tabindex="-1"></a>         Age <span class="sc">==</span> <span class="st">&#39;All&#39;</span>, </span>
<span id="cb399-5"><a href="#cb399-5" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Migration Type</span><span class="st">`</span> <span class="sc">!=</span> <span class="st">&#39;Net&#39;</span>)</span>
<span id="cb399-6"><a href="#cb399-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb399-7"><a href="#cb399-7" aria-hidden="true" tabindex="-1"></a><span class="co"># make box plots</span></span>
<span id="cb399-8"><a href="#cb399-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(female_migration, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Migration Type</span><span class="st">`</span>, <span class="at">y =</span> Value, <span class="at">fill =</span> <span class="st">`</span><span class="at">Migration Type</span><span class="st">`</span>)) <span class="sc">+</span> </span>
<span id="cb399-9"><a href="#cb399-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="Intro-to-R-GU-Open-Studies-2021-2022_files/figure-html/unnamed-chunk-313-1.png" width="672" /></p>
<div class="sourceCode" id="cb400"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb400-1"><a href="#cb400-1" aria-hidden="true" tabindex="-1"></a><span class="co">#make violin plots</span></span>
<span id="cb400-2"><a href="#cb400-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(female_migration, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Migration Type</span><span class="st">`</span>, <span class="at">y =</span> Value, <span class="at">fill =</span> <span class="st">`</span><span class="at">Migration Type</span><span class="st">`</span>)) <span class="sc">+</span> </span>
<span id="cb400-3"><a href="#cb400-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>()</span></code></pre></div>
<p><img src="Intro-to-R-GU-Open-Studies-2021-2022_files/figure-html/unnamed-chunk-313-2.png" width="672" /></p>
<div class="info">
<p>
These plots show us the distribution of females entering and leaving
Scotland. What we can tell is that over the years is that we haven’t had
less than 12000 women coming to Scotland and no more than 16000 women
leaving. These types of plots also tell us where the bulk of the data
is. We can see from the violin plots that the most common number of
females coming into Scotland throughout the years is between 22000 and
18000. Box plots on the other hand, tell you where the middle 50% of the
data are.
</p>
</div>
<div class="task">
<p>
<strong>Your turn</strong>
</p>
<p>
Using the data for this class follow the instructions. Remember, you
can use <code>View()</code> in the console to look at your data, or
click on the data variable in your <code>Global Environment</code>. This
can help you to make your choices for the steps bellow and with the
exact spelling. Start from the original dataset we loaded in the
beginning <code>traffic_scot</code>. Use pipes <code>%&gt;%</code> for
the first 5 steps and save the output into a variable
<code>my_data</code>. Use that data to create three separate plots for
steps 6, 7 and 8.
</p>
<ol style="list-style-type: decimal">
<li>
Select two different years.
</li>
<li>
Select two different age groups.
</li>
<li>
Select the total for both sex ( i.e. ‘all’).
</li>
<li>
Select migration In and Out of Scotland.
</li>
<li>
Pick whether you are going to look at
<code>To-from Rest of UK</code> or <code>To-from Overseas</code>.
</li>
<li>
Plot the overall people, regardless of age and year, that have moved
into and left Scotland using <code>geom_col()</code>. Save the plot in
the variable q6 into your <code>Global Environment</code>.
</li>
<li>
Create a new plot using <code>geom_col()</code> that shows the
differences between the two years you have selected, regardless of age.
Save the plot in the variable q7 into your
<code>Global Environment</code>.
</li>
<li>
Plot the differences between the two ages, regardless of year.
</li>
</ol>
</div>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb401-1"><a href="#cb401-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example answer </span></span>
<span id="cb401-2"><a href="#cb401-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb401-3"><a href="#cb401-3" aria-hidden="true" tabindex="-1"></a>traffic_scot <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;free_movement_uk.csv&quot;</span>) </span></code></pre></div>
<pre><code>## Rows: 28152 Columns: 9
## -- Column specification --------------------------------------------------------
## Delimiter: &quot;,&quot;
## chr (7): FeatureCode, Measurement, Units, Age, Sex, Migration Source, Migrat...
## dbl (2): DateCode, Value
## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb403-1"><a href="#cb403-1" aria-hidden="true" tabindex="-1"></a>my_data <span class="ot">&lt;-</span> traffic_scot <span class="sc">%&gt;%</span> </span>
<span id="cb403-2"><a href="#cb403-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Age <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&#39;21 years&#39;</span>, <span class="st">&#39;41 years&#39;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb403-3"><a href="#cb403-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(DateCode, Value, Age, Sex, <span class="st">`</span><span class="at">Migration Source</span><span class="st">`</span>, <span class="st">`</span><span class="at">Migration Type</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb403-4"><a href="#cb403-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(DateCode <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&#39;2013&#39;</span>, <span class="st">&#39;2018&#39;</span>), </span>
<span id="cb403-5"><a href="#cb403-5" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Migration Type</span><span class="st">`</span> <span class="sc">!=</span> <span class="st">&#39;Net&#39;</span>, </span>
<span id="cb403-6"><a href="#cb403-6" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Migration Source</span><span class="st">`</span> <span class="sc">==</span> <span class="st">&#39;To-from Overseas&#39;</span>, </span>
<span id="cb403-7"><a href="#cb403-7" aria-hidden="true" tabindex="-1"></a>         Sex <span class="sc">==</span> <span class="st">&#39;All&#39;</span>)</span>
<span id="cb403-8"><a href="#cb403-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb403-9"><a href="#cb403-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb403-10"><a href="#cb403-10" aria-hidden="true" tabindex="-1"></a>q6 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(my_data, <span class="fu">aes</span>(<span class="st">`</span><span class="at">Migration Type</span><span class="st">`</span>, Value)) <span class="sc">+</span> </span>
<span id="cb403-11"><a href="#cb403-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>()</span>
<span id="cb403-12"><a href="#cb403-12" aria-hidden="true" tabindex="-1"></a>q6</span></code></pre></div>
<p><img src="Intro-to-R-GU-Open-Studies-2021-2022_files/figure-html/unnamed-chunk-316-1.png" width="672" /></p>
<div class="sourceCode" id="cb404"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb404-1"><a href="#cb404-1" aria-hidden="true" tabindex="-1"></a>q7 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(my_data, <span class="fu">aes</span>(<span class="st">`</span><span class="at">Migration Type</span><span class="st">`</span>, Value, <span class="at">fill =</span> <span class="fu">as.character</span>(DateCode))) <span class="sc">+</span> </span>
<span id="cb404-2"><a href="#cb404-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">&#39;dodge&#39;</span>)</span>
<span id="cb404-3"><a href="#cb404-3" aria-hidden="true" tabindex="-1"></a>q7 </span></code></pre></div>
<p><img src="Intro-to-R-GU-Open-Studies-2021-2022_files/figure-html/unnamed-chunk-316-2.png" width="672" /></p>
<div class="sourceCode" id="cb405"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb405-1"><a href="#cb405-1" aria-hidden="true" tabindex="-1"></a>q8 <span class="ot">&lt;-</span><span class="fu">ggplot</span>(my_data, <span class="fu">aes</span>(<span class="st">`</span><span class="at">Migration Type</span><span class="st">`</span>, Value, <span class="at">fill =</span> Age)) <span class="sc">+</span> </span>
<span id="cb405-2"><a href="#cb405-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">&#39;dodge&#39;</span>)</span>
<span id="cb405-3"><a href="#cb405-3" aria-hidden="true" tabindex="-1"></a>q8</span></code></pre></div>
<p><img src="Intro-to-R-GU-Open-Studies-2021-2022_files/figure-html/unnamed-chunk-316-3.png" width="672" /></p>
</div>
</div>
<div id="formative-homework-3" class="section level2 hasAnchor" number="7.10">
<h2 class="hasAnchor"><span class="header-section-number">7.10</span> Formative Homework<a href="#formative-homework-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The formative homework for this week can now be found on Moodle.</p>
<!--chapter:end:07-viz_1.Rmd-->
</div>
</div>
<div id="data-visualisation-2" class="section level1 hasAnchor" number="8">
<h1 class="hasAnchor"><span class="header-section-number">8</span> Data Visualisation 2<a href="#data-visualisation-2" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Today, we will continue working with <code>ggplot2</code> which is part of <code>tidyverse</code>. We will continue working with the data from the Scottish Government saved in the file <code>free_movement_uk.csv</code>.</p>
<div id="additional-resources" class="section level2 hasAnchor" number="8.1">
<h2 class="hasAnchor"><span class="header-section-number">8.1</span> Additional Resources<a href="#additional-resources" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><a href="http://www.cookbook-r.com/Graphs/">Cookbook for R - Graphs</a></li>
<li>Hadley Wickham et al.’s <a href="https://ggplot2-book.org/index.html">Elegant graphics for Data Analysis</a></li>
<li><a href="https://rstudio.com/wp-content/uploads/2015/03/ggplot2-cheatsheet.pdf">ggplot2 cheatsheet</a></li>
<li><a href="https://ggplot2.tidyverse.org/reference/#section-plot-basics">ggplot2 functions reference</a></li>
</ul>
</div>
<div id="intended-learning-outcomes-8" class="section level2 unnumbered hasAnchor">
<h2 class="unnumbered hasAnchor">Intended Learning Outcomes<a href="#intended-learning-outcomes-8" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li>Learn how to make multiple plots at the same time</li>
<li>Learn the difference between global and local aesthetics</li>
<li>Learn how to work with themes: adding labels, changing font size, colours and axes ticks.</li>
<li>Learn to work with legends.</li>
</ol>
<p>This lesson is led by Sean Wood.</p>
</div>
<div id="pre-steps-6" class="section level2 hasAnchor" number="8.2">
<h2 class="hasAnchor"><span class="header-section-number">8.2</span> Pre-steps<a href="#pre-steps-6" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Firstly, load <code>tidyverse</code>, and read the data into your <code>Global Environment</code> as <code>migration_scot</code>.</p>
<div class="sourceCode" id="cb406"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb406-1"><a href="#cb406-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb406-2"><a href="#cb406-2" aria-hidden="true" tabindex="-1"></a>migration_scot <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;free_movement_uk.csv&quot;</span>)</span></code></pre></div>
</div>
<div id="re-introduction-to-the-data" class="section level2 hasAnchor" number="8.3">
<h2 class="hasAnchor"><span class="header-section-number">8.3</span> Re-introduction to the data<a href="#re-introduction-to-the-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This data is openly available from the Scottish Government, and it introduces the flow of people at different ages and sex into and out of Scotland from the rest of UK (RUK) and Overseas. We have several variables to work with:</p>
<table>
<colgroup>
<col width="23%" />
<col width="76%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Variable</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">FeatureCode</td>
<td align="left">Codes given by the Scottish Government</td>
</tr>
<tr class="even">
<td align="left">DateCode</td>
<td align="left">Year of data collected</td>
</tr>
<tr class="odd">
<td align="left">Measurement</td>
<td align="left">What type of measurement it is (here we have only counts i.e. the number of people)</td>
</tr>
<tr class="even">
<td align="left">Units</td>
<td align="left">Units (here we have number of people)</td>
</tr>
<tr class="odd">
<td align="left">Value</td>
<td align="left">The actual count (i.e. the number of people)</td>
</tr>
<tr class="even">
<td align="left">Age</td>
<td align="left">Age of the counted people (separate by age, and total (sum of all age groups))</td>
</tr>
<tr class="odd">
<td align="left">Sex</td>
<td align="left">Sex of the counted people (separate by sex, and total (sum all sex groups))</td>
</tr>
<tr class="even">
<td align="left">Migration Source</td>
<td align="left">Where the people are coming from (Overseas, RUK)</td>
</tr>
<tr class="odd">
<td align="left">Migration Type</td>
<td align="left">Whether people are coming or leaving (In, Out, and Net (people coming in less the people leaving))</td>
</tr>
</tbody>
</table>
<p>This is the wrangled data from last week.</p>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb407-1"><a href="#cb407-1" aria-hidden="true" tabindex="-1"></a>traffic_scot <span class="ot">&lt;-</span> migration_scot <span class="sc">%&gt;%</span> </span>
<span id="cb407-2"><a href="#cb407-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(DateCode, Value, Sex, </span>
<span id="cb407-3"><a href="#cb407-3" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Migration Source</span><span class="st">`</span>, <span class="st">`</span><span class="at">Migration Type</span><span class="st">`</span>, Age) <span class="sc">%&gt;%</span> </span>
<span id="cb407-4"><a href="#cb407-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(DateCode <span class="sc">==</span> <span class="st">&#39;2016&#39;</span>, Age <span class="sc">==</span> <span class="st">&#39;All&#39;</span>, </span>
<span id="cb407-5"><a href="#cb407-5" aria-hidden="true" tabindex="-1"></a>         Sex <span class="sc">!=</span> <span class="st">&#39;All&#39;</span>, <span class="st">`</span><span class="at">Migration Type</span><span class="st">`</span> <span class="sc">!=</span> <span class="st">&#39;Net&#39;</span>)</span></code></pre></div>
</div>
<div id="create-multiple-plots-in-one" class="section level2 hasAnchor" number="8.4">
<h2 class="hasAnchor"><span class="header-section-number">8.4</span> Create multiple plots in one<a href="#create-multiple-plots-in-one" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Sometimes, we have way too many variables and they are all important. You should always avoid having busy plots. They get too confusing, and it is easy for people to misinterpret them.</p>
<p>We are going to look at two ways to create multiple plots.</p>
<div id="select-the-data-beforehand-and-create-different-plots." class="section level3 hasAnchor" number="8.4.1">
<h3 class="hasAnchor"><span class="header-section-number">8.4.1</span> Select the data beforehand and create different plots.<a href="#select-the-data-beforehand-and-create-different-plots." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="task">
<p>
Simple Task 1:
</p>
<p>
From the data we just created, select only data relevant for movement
to and from the rest of the UK and save it to the
<code>Global Environment</code> as an object called
<code>rest_of_uk</code> .
</p>
</div>
<div class="sourceCode" id="cb408"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb408-1"><a href="#cb408-1" aria-hidden="true" tabindex="-1"></a>rest_of_uk <span class="ot">&lt;-</span> <span class="cn">NULL</span></span></code></pre></div>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb409"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb409-1"><a href="#cb409-1" aria-hidden="true" tabindex="-1"></a>rest_of_uk <span class="ot">&lt;-</span> traffic_scot <span class="sc">%&gt;%</span> </span>
<span id="cb409-2"><a href="#cb409-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">Migration Source</span><span class="st">`</span> <span class="sc">==</span> <span class="st">&#39;To-from Rest of UK&#39;</span>)</span></code></pre></div>
</div>
<div class="task">
<p>
Simple Task 2:
</p>
<p>
Create a column plot that shows the number of people for each sex
using the data we just created using <code>geom_col()</code>. Separate
the data by using different colours based on
<code>Migration Type</code>. Don’t forget to use
<code>position = ‘dodge’</code> so that your columns do not overlap.
</p>
</div>
<div class="sourceCode" id="cb410"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb410-1"><a href="#cb410-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="cn">NULL</span>) <span class="sc">+</span> <span class="cn">NULL</span></span></code></pre></div>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb411"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb411-1"><a href="#cb411-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(rest_of_uk, <span class="fu">aes</span>(<span class="at">x =</span> Sex, <span class="at">y =</span> Value, </span>
<span id="cb411-2"><a href="#cb411-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">fill =</span> <span class="st">`</span><span class="at">Migration Type</span><span class="st">`</span>)) <span class="sc">+</span> </span>
<span id="cb411-3"><a href="#cb411-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">&#39;dodge&#39;</span>)</span></code></pre></div>
<p><img src="Intro-to-R-GU-Open-Studies-2021-2022_files/figure-html/unnamed-chunk-325-1.png" width="672" /></p>
</div>
<div class="task">
<p>
Simple Task 3:
</p>
<p>
Now plot only the data for the movement to and from Overseas
following the previous two steps. This time, make sure you save your
wrangled data into an object called <code>overseas</code> and then use
it to create your plot.
</p>
</div>
<div class="sourceCode" id="cb412"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb412-1"><a href="#cb412-1" aria-hidden="true" tabindex="-1"></a>overseas <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb412-2"><a href="#cb412-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb412-3"><a href="#cb412-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="cn">NULL</span>) <span class="sc">+</span> <span class="cn">NULL</span></span></code></pre></div>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb413-1"><a href="#cb413-1" aria-hidden="true" tabindex="-1"></a>overseas<span class="ot">&lt;-</span> traffic_scot <span class="sc">%&gt;%</span> </span>
<span id="cb413-2"><a href="#cb413-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">Migration Source</span><span class="st">`</span> <span class="sc">==</span> <span class="st">&#39;To-from Overseas&#39;</span>)</span>
<span id="cb413-3"><a href="#cb413-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb413-4"><a href="#cb413-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(overseas, <span class="fu">aes</span>(<span class="at">x =</span> Sex, <span class="at">y =</span> Value, </span>
<span id="cb413-5"><a href="#cb413-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">fill =</span> <span class="st">`</span><span class="at">Migration Type</span><span class="st">`</span>)) <span class="sc">+</span> </span>
<span id="cb413-6"><a href="#cb413-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">&#39;dodge&#39;</span>)</span></code></pre></div>
<p><img src="Intro-to-R-GU-Open-Studies-2021-2022_files/figure-html/unnamed-chunk-328-1.png" width="672" /></p>
</div>
<p>This becomes very cumbersome when we have more than one variable. Imagine you have data for 10 different countries. Can you imagine doing these plots by hand. Moreover, when you have to arrange them on a page to show how things differ you will loose a lot of time. Instead we can use <strong>facets</strong>.</p>
</div>
<div id="facets" class="section level3 hasAnchor" number="8.4.2">
<h3 class="hasAnchor"><span class="header-section-number">8.4.2</span> Facets<a href="#facets" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Facets allow us to create separate plots without manually separating the data. Moreover we can specify how we want to put the plots in a grid: do we want them side by side or one on top of each other, etc.</p>
<p>We can use several facet functions.</p>
<ul>
<li><code>facet_grid(variable_to_split_by)</code> structures the rows and columns of graphs based on a third variable</li>
<li><code>facet_grid(.~variable)</code> creates columns - i.e. side by side panels</li>
<li><code>facet_grid(variable~.)</code> creates rows - i.e. one on top of the other</li>
<li><code>facet_grid(variable1~variable2)</code> creates rows based on variable1 and columns based on variable2<br />
</li>
<li><code>facet_wrap(variable)</code> creates a grid with rectangular slots for the plots based on your variables</li>
</ul>
<p>Let’s replicate the two plots we just created but using <code>facet_grid()</code> and put them side-by-side in one. Now we have both plots next to each other, which makes it much easier to look at the differences in the migration patterns between the two Migration Sources.</p>
<div class="sourceCode" id="cb414"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb414-1"><a href="#cb414-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(traffic_scot, <span class="fu">aes</span>(<span class="at">x =</span> Sex, <span class="at">y =</span> Value, </span>
<span id="cb414-2"><a href="#cb414-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fill =</span> <span class="st">`</span><span class="at">Migration Type</span><span class="st">`</span>)) <span class="sc">+</span> </span>
<span id="cb414-3"><a href="#cb414-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">&#39;dodge&#39;</span>) <span class="sc">+</span></span>
<span id="cb414-4"><a href="#cb414-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span><span class="st">`</span><span class="at">Migration Source</span><span class="st">`</span>)</span></code></pre></div>
<p><img src="Intro-to-R-GU-Open-Studies-2021-2022_files/figure-html/unnamed-chunk-329-1.png" width="672" /></p>
<p><span style="font-size: 22px; font-weight: bold; color: hsl(24, 100%, 50%);">Question Time</span></p>
<p>Let’s look at these plots.</p>
<ul>
<li>Which sex tends to move to Scotland more, regardless of migration location? <select class='webex-select'><option value='blank'></option><option value='answer'>Female</option><option value=''>Male</option></select></li>
<li>Which migration location do both males and females migrate to more when they leave Scotland? <select class='webex-select'><option value='blank'></option><option value=''>To Overseas</option><option value='answer'>To RUK</option></select></li>
</ul>
</div>
</div>
<div id="global-and-local-aesthetics" class="section level2 hasAnchor" number="8.5">
<h2 class="hasAnchor"><span class="header-section-number">8.5</span> Global and Local aesthetics<a href="#global-and-local-aesthetics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>So far, we have been working with a <strong>Global</strong> definition of the aesthetics. This allows us to specify the axes and the groupings only once.</p>
<p>Sometimes, we want to use multiple data and put multiple plots on top of each other. For these occasions we can specify the aesthetics at a local level - i.e. in the geoms.</p>
<p>If you remember from last week, we specified both the colour and the shape in our <code>ggplot()</code> when we were making the line graph. The <code>geom_line()</code> inherited the colour but not the shape argument.</p>
<p>However, if we have two geoms that share the same aesthetics but we do not want to have the same colours, we can move them to each of the geoms instead of specifying them globally in the <code>ggplot()</code> function.</p>
<p>Let’s redo the violins and box plots from last week, and put them together into two separate layers of the same graph. This time, we will give them some colour. We will colour the violins with the <code>fill</code> argument and make the box plots transparent using the <code>alpha</code> argument.</p>
<div class="sourceCode" id="cb415"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb415-1"><a href="#cb415-1" aria-hidden="true" tabindex="-1"></a><span class="co">#some data wrangling</span></span>
<span id="cb415-2"><a href="#cb415-2" aria-hidden="true" tabindex="-1"></a>boxes <span class="ot">&lt;-</span> migration_scot <span class="sc">%&gt;%</span> </span>
<span id="cb415-3"><a href="#cb415-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Sex <span class="sc">==</span> <span class="st">&#39;Female&#39;</span>, </span>
<span id="cb415-4"><a href="#cb415-4" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Migration Source</span><span class="st">`</span> <span class="sc">==</span> <span class="st">&#39;To-from Overseas&#39;</span>, </span>
<span id="cb415-5"><a href="#cb415-5" aria-hidden="true" tabindex="-1"></a>         Age <span class="sc">==</span> <span class="st">&#39;All&#39;</span>, </span>
<span id="cb415-6"><a href="#cb415-6" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Migration Type</span><span class="st">`</span> <span class="sc">!=</span> <span class="st">&#39;Net&#39;</span>)</span>
<span id="cb415-7"><a href="#cb415-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb415-8"><a href="#cb415-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb415-9"><a href="#cb415-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb415-10"><a href="#cb415-10" aria-hidden="true" tabindex="-1"></a><span class="co">#make violins and box plots </span></span>
<span id="cb415-11"><a href="#cb415-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb415-12"><a href="#cb415-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(boxes, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Migration Type</span><span class="st">`</span>, <span class="at">y =</span> Value)) <span class="sc">+</span> </span>
<span id="cb415-13"><a href="#cb415-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> <span class="st">`</span><span class="at">Migration Type</span><span class="st">`</span>)) <span class="sc">+</span> </span>
<span id="cb415-14"><a href="#cb415-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>))</span></code></pre></div>
<p><img src="Intro-to-R-GU-Open-Studies-2021-2022_files/figure-html/unnamed-chunk-330-1.png" width="672" /></p>
<p>Because <code>alpha</code> (the transparency argument) and <code>fill</code> are arguments for both box plots and violins, if we had put them in the <code>ggplot()</code> layer, they would both be inherited by the two geoms.</p>
<p>Let’s see how it would have looked like if we had specified the two arguments globally.</p>
<div class="sourceCode" id="cb416"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb416-1"><a href="#cb416-1" aria-hidden="true" tabindex="-1"></a><span class="co">#make violins and box plots </span></span>
<span id="cb416-2"><a href="#cb416-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb416-3"><a href="#cb416-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(boxes, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Migration Type</span><span class="st">`</span>, <span class="at">y =</span> Value, <span class="at">fill =</span> <span class="st">`</span><span class="at">Migration Type</span><span class="st">`</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>)) <span class="sc">+</span> </span>
<span id="cb416-4"><a href="#cb416-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>() <span class="sc">+</span> </span>
<span id="cb416-5"><a href="#cb416-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="Intro-to-R-GU-Open-Studies-2021-2022_files/figure-html/unnamed-chunk-331-1.png" width="672" /></p>
<p>Now the violins and the box plots are both coloured and transparent.</p>
<div class="info">
<p>
As you know, R works left to right and top to bottom, reading your
code line by line. The box plots are on top of the violins because
<code>geom_boxplot()</code> is after <code>geom_violin()</code>. Try it
in your console, or make an r chunk in your stub file to see how it
would look like.
</p>
</div>
</div>
<div id="themes-making-your-plots-pretty-looking-the-way-you-want-them-to" class="section level2 hasAnchor" number="8.6">
<h2 class="hasAnchor"><span class="header-section-number">8.6</span> Themes: Making your plots pretty: looking the way you want them to<a href="#themes-making-your-plots-pretty-looking-the-way-you-want-them-to" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The great thing about making your own plots in R is that you can make them look the way you want. Even better, if you are writing a paper, graphs are easy to adjust to match journals’ criteria. Let’s adjust the look of our graph.</p>
<div id="ready-made-themes" class="section level3 hasAnchor" number="8.6.1">
<h3 class="hasAnchor"><span class="header-section-number">8.6.1</span> Ready-made themes<a href="#ready-made-themes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>ggplot2 comes with several ready made themes. Some of them are:</p>
<ul>
<li><code>theme_bw()</code>: a white background with major axes and border.</li>
<li><code>theme_minimal()</code>: a white background with major axes
and more. Just use the cheetsheet for visualisations with ggplot for some more examples.</li>
</ul>
<p>Themes are just like any other layer for ggplot. You just add them at the end of your plot with <code>+</code>. Let’s add one of these theme formats to our plot above.</p>
<div class="sourceCode" id="cb417"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb417-1"><a href="#cb417-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(boxes, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Migration Type</span><span class="st">`</span>, <span class="at">y =</span> Value)) <span class="sc">+</span> </span>
<span id="cb417-2"><a href="#cb417-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> <span class="st">`</span><span class="at">Migration Type</span><span class="st">`</span>)) <span class="sc">+</span> </span>
<span id="cb417-3"><a href="#cb417-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb417-4"><a href="#cb417-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="Intro-to-R-GU-Open-Studies-2021-2022_files/figure-html/unnamed-chunk-333-1.png" width="672" /></p>
<div class="question">
<p>
Can you see the difference from our original plot?
</p>
</div>
<div class="webex-solution">
<button>
Explanation
</button>
<div class="solved">
<p>
The background is no longer grey, the grid lines are a light grey
instead of white, and there is a black border around the plot area.
</p>
</div>
</div>
</div>
<div id="adding-axes-titles-and-headings" class="section level3 hasAnchor" number="8.6.2">
<h3 class="hasAnchor"><span class="header-section-number">8.6.2</span> Adding axes titles and headings<a href="#adding-axes-titles-and-headings" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Next, let’s add some titles and better labels with <code>labs()</code>. You need to specify which labels you want to change - x, y or the title, and type in the labels you want. Write <code>?labs()</code> in your console to see some examples.</p>
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb418-1"><a href="#cb418-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(boxes, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Migration Type</span><span class="st">`</span>, <span class="at">y =</span> Value)) <span class="sc">+</span> </span>
<span id="cb418-2"><a href="#cb418-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> <span class="st">`</span><span class="at">Migration Type</span><span class="st">`</span>)) <span class="sc">+</span> </span>
<span id="cb418-3"><a href="#cb418-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb418-4"><a href="#cb418-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb418-5"><a href="#cb418-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Female migration to and from Overseas into Scotland&#39;</span>, </span>
<span id="cb418-6"><a href="#cb418-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&#39;Migration direction&#39;</span>, </span>
<span id="cb418-7"><a href="#cb418-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Number of people&#39;</span>)</span></code></pre></div>
<p><img src="Intro-to-R-GU-Open-Studies-2021-2022_files/figure-html/unnamed-chunk-336-1.png" width="672" /></p>
<p>Sometimes, we need the titles to be a specific size. We can change all of that in an additional <code>theme()</code> layer. We specify the argument we want to change and what about them we need to change. In our case, I want to change the size of the x-axis title to 12pt, and the graph title to 20pt. Let’s also pretend we do not want the y-axis title. We can also specify this in the <code>theme()</code> layer.</p>
<p>We do this by specifying <code>element_text()</code> and <code>element_blank()</code> for the correct theme arguments (<code>axis.title.x</code>, <code>title</code>, <code>axis.title.x</code>). Simply put, for that element of the plot, what do we want to change - text and to make it blank.</p>
<div class="sourceCode" id="cb419"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb419-1"><a href="#cb419-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(boxes, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Migration Type</span><span class="st">`</span>, <span class="at">y =</span> Value)) <span class="sc">+</span> </span>
<span id="cb419-2"><a href="#cb419-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> <span class="st">`</span><span class="at">Migration Type</span><span class="st">`</span>)) <span class="sc">+</span> </span>
<span id="cb419-3"><a href="#cb419-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb419-4"><a href="#cb419-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb419-5"><a href="#cb419-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Female migration to and from</span><span class="sc">\n</span><span class="st">Overseas into Scotland&#39;</span>, </span>
<span id="cb419-6"><a href="#cb419-6" aria-hidden="true" tabindex="-1"></a>       <span class="co">#the addition of \n gives a new line</span></span>
<span id="cb419-7"><a href="#cb419-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&#39;Migration direction&#39;</span>, </span>
<span id="cb419-8"><a href="#cb419-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Number of people&#39;</span>) <span class="sc">+</span></span>
<span id="cb419-9"><a href="#cb419-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb419-10"><a href="#cb419-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>), </span>
<span id="cb419-11"><a href="#cb419-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># read this as: change the size of element_text of the </span></span>
<span id="cb419-12"><a href="#cb419-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># x axis title</span></span>
<span id="cb419-13"><a href="#cb419-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb419-14"><a href="#cb419-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>() </span>
<span id="cb419-15"><a href="#cb419-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># read this as: change the title of the y axis to blank</span></span>
<span id="cb419-16"><a href="#cb419-16" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="Intro-to-R-GU-Open-Studies-2021-2022_files/figure-html/unnamed-chunk-337-1.png" width="672" /></p>
<div class="info">
<p>
The ready made themes like <code>theme_bw()</code> come with an
already pre-set size of the titles and and headings. However, since we
are putting the <code>theme()</code> as a new layer below
<code>theme_bw()</code> we will override only the specific component
that we want. Try putting <code>theme_bw()</code> at the bottom instead
of above the <code>theme()</code> layer.
</p>
</div>
</div>
</div>
<div id="changing-colours" class="section level2 hasAnchor" number="8.7">
<h2 class="hasAnchor"><span class="header-section-number">8.7</span> Changing colours<a href="#changing-colours" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We can rely on the colour schemes automatically set by <code>ggplot2</code>, or we can manually specify colours we want. To change any of the colours, we need to specify which scale we are changing. This is done by specifying the aesthetic. In our case, we are changing the colours of the <code>fill</code> aesthetic so we use <code>scale_fill_manual()</code>. Instead of using names, you can use any hex colour you want. A hex colour is the representation of a colour using a 6 digit code. <code>scale_fill_manual()</code> works like another layer, which overwrites the automatic colour schemes. Because it overwrites an existing function, it has to be after the geom that uses the <code>fill</code> argument.</p>
<div class="sourceCode" id="cb420"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb420-1"><a href="#cb420-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(boxes, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Migration Type</span><span class="st">`</span>, <span class="at">y =</span> Value)) <span class="sc">+</span> </span>
<span id="cb420-2"><a href="#cb420-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> <span class="st">`</span><span class="at">Migration Type</span><span class="st">`</span>)) <span class="sc">+</span> </span>
<span id="cb420-3"><a href="#cb420-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb420-4"><a href="#cb420-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&#39;#127d69&#39;</span>, <span class="st">&#39;#cedc00&#39;</span>)) <span class="sc">+</span> </span>
<span id="cb420-5"><a href="#cb420-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#here I have picked two specific colours</span></span>
<span id="cb420-6"><a href="#cb420-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb420-7"><a href="#cb420-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Female migration to and from</span><span class="sc">\n</span><span class="st">Overseas into Scotland&#39;</span>, </span>
<span id="cb420-8"><a href="#cb420-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&#39;Migration direction&#39;</span>, </span>
<span id="cb420-9"><a href="#cb420-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Number of people&#39;</span>) <span class="sc">+</span></span>
<span id="cb420-10"><a href="#cb420-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb420-11"><a href="#cb420-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb420-12"><a href="#cb420-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb420-13"><a href="#cb420-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>()</span>
<span id="cb420-14"><a href="#cb420-14" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="Intro-to-R-GU-Open-Studies-2021-2022_files/figure-html/unnamed-chunk-339-1.png" width="672" /></p>
<div class="info">
<p>
R really likes order, so it will put everything in alphabetical
order. This is why the first colour in the
<code>scale_fill_manual()</code> layer - <code>#127d69</code>, is
associated with migration category <strong>In</strong> and the second
colour - <code>#cedc00</code> is associated with migration category
<strong>Out</strong>.
</p>
</div>
</div>
<div id="legends" class="section level2 hasAnchor" number="8.8">
<h2 class="hasAnchor"><span class="header-section-number">8.8</span> Legends<a href="#legends" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We can see that for any additional aesthetic we have put, ggplot has created a legend on the side.</p>
<p>Now let’s change what the labels actually say. We do this in the same place we specified the colours <code>scale_fill_manual</code> because, again, we are overwriting the automatic <code>fill</code> labels.</p>
<p>Let’s also:</p>
<ol style="list-style-type: decimal">
<li><p>hide the legend associated with the box plots (i.e. <code>alpha</code>);</p></li>
<li><p>move the legend to the bottom of the graph using the <code>legend.position</code> argument; and</p></li>
<li><p>change the size of the legend titles (using <code>legend.title</code>).</p></li>
</ol>
<p>We do steps 2 and 3 in the <code>theme()</code> layer.</p>
<p>Because we have more than one legend, everything we do will be applied to both legends.This is a good idea for consistency. But when we want to hide one of the legends, we have to specify that in the geom where the legend is created using the argument <code>show.legend</code>.</p>
<div class="sourceCode" id="cb421"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb421-1"><a href="#cb421-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(boxes, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Migration Type</span><span class="st">`</span>, <span class="at">y =</span> Value)) <span class="sc">+</span> </span>
<span id="cb421-2"><a href="#cb421-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> <span class="st">`</span><span class="at">Migration Type</span><span class="st">`</span>)) <span class="sc">+</span> </span>
<span id="cb421-3"><a href="#cb421-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>), <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> <span class="co"># hide the legend</span></span>
<span id="cb421-4"><a href="#cb421-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&#39;#127d69&#39;</span>, <span class="st">&#39;#cedc00&#39;</span>),</span>
<span id="cb421-5"><a href="#cb421-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Coming to Scotland&#39;</span>,</span>
<span id="cb421-6"><a href="#cb421-6" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&#39;Leaving Scotland&#39;</span>)) <span class="sc">+</span></span>
<span id="cb421-7"><a href="#cb421-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb421-8"><a href="#cb421-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Female migration to and from</span><span class="sc">\n</span><span class="st">Overseas into Scotland&#39;</span>,</span>
<span id="cb421-9"><a href="#cb421-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&#39;Migration direction&#39;</span>,</span>
<span id="cb421-10"><a href="#cb421-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Number of people&#39;</span>) <span class="sc">+</span></span>
<span id="cb421-11"><a href="#cb421-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb421-12"><a href="#cb421-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb421-13"><a href="#cb421-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb421-14"><a href="#cb421-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb421-15"><a href="#cb421-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&#39;bottom&#39;</span>, <span class="co">#move the legend to the bottom</span></span>
<span id="cb421-16"><a href="#cb421-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>)</span>
<span id="cb421-17"><a href="#cb421-17" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="Intro-to-R-GU-Open-Studies-2021-2022_files/figure-html/unnamed-chunk-341-1.png" width="672" /></p>
</div>
<div id="changing-axes-ticks" class="section level2 hasAnchor" number="8.9">
<h2 class="hasAnchor"><span class="header-section-number">8.9</span> Changing axes ticks<a href="#changing-axes-ticks" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now, we also need to change what is stated on our x-axis to match the legend. We use <code>scale_x_discrete()</code> to give new names inside the graph, so that we do not have to change our dataset. We specify the labels of the new groups by giving the old name in quotes and then the new name, also in quotes. We use <code>scale_x_discrete()</code>, because we have discrete groups - a categorical variable.</p>
<div class="sourceCode" id="cb422"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb422-1"><a href="#cb422-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(boxes, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Migration Type</span><span class="st">`</span>, <span class="at">y =</span> Value)) <span class="sc">+</span> </span>
<span id="cb422-2"><a href="#cb422-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill =</span> <span class="st">`</span><span class="at">Migration Type</span><span class="st">`</span>)) <span class="sc">+</span> </span>
<span id="cb422-3"><a href="#cb422-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>), <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb422-4"><a href="#cb422-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&#39;#127d69&#39;</span>, <span class="st">&#39;#cedc00&#39;</span>),</span>
<span id="cb422-5"><a href="#cb422-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Coming to Scotland&#39;</span>,</span>
<span id="cb422-6"><a href="#cb422-6" aria-hidden="true" tabindex="-1"></a>                               <span class="st">&#39;Leaving Scotland&#39;</span>)) <span class="sc">+</span></span>
<span id="cb422-7"><a href="#cb422-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;In&#39;</span> <span class="ot">=</span> <span class="st">&#39;Coming to Scotland&#39;</span>, </span>
<span id="cb422-8"><a href="#cb422-8" aria-hidden="true" tabindex="-1"></a>                              <span class="st">&#39;Out&#39;</span> <span class="ot">=</span> <span class="st">&#39;Leaving Scotland&#39;</span>)) <span class="sc">+</span></span>
<span id="cb422-9"><a href="#cb422-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb422-10"><a href="#cb422-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Female migration to and from</span><span class="sc">\n</span><span class="st">Overseas into Scotland&#39;</span>, </span>
<span id="cb422-11"><a href="#cb422-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&#39;Migration direction&#39;</span>, </span>
<span id="cb422-12"><a href="#cb422-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Number of people&#39;</span>) <span class="sc">+</span></span>
<span id="cb422-13"><a href="#cb422-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb422-14"><a href="#cb422-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb422-15"><a href="#cb422-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>),</span>
<span id="cb422-16"><a href="#cb422-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb422-17"><a href="#cb422-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&#39;bottom&#39;</span>,</span>
<span id="cb422-18"><a href="#cb422-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>)</span>
<span id="cb422-19"><a href="#cb422-19" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="Intro-to-R-GU-Open-Studies-2021-2022_files/figure-html/unnamed-chunk-342-1.png" width="672" /></p>
<p>Let’s also say that we are plotting data which is continuous but we want to show each of the values. For example we have years and we want to show every year. <code>ggplot</code> will try and skip some of the years to make the graph look neater. There are several ways we can change that. We can either make the variable into a factor or a character using <code>as.character</code>so that <code>ggplot</code> will be forced to look at it as a discrete variable or we can change the ticks of the x axis by giving them <code>limits</code> and <code>breaks</code> in the layer that overwrites the original x values - <code>scale_x_continuous()</code>.</p>
<p>Let’s use the graph from last week which showed us the change in migration across the years.</p>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb423-1"><a href="#cb423-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First, we are getting the data from last week to recreate the code.</span></span>
<span id="cb423-2"><a href="#cb423-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb423-3"><a href="#cb423-3" aria-hidden="true" tabindex="-1"></a>traffic_scot2 <span class="ot">&lt;-</span> migration_scot <span class="sc">%&gt;%</span> </span>
<span id="cb423-4"><a href="#cb423-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Age <span class="sc">==</span> <span class="st">&#39;All&#39;</span>, </span>
<span id="cb423-5"><a href="#cb423-5" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Migration Type</span><span class="st">`</span> <span class="sc">!=</span> <span class="st">&#39;Net&#39;</span>,</span>
<span id="cb423-6"><a href="#cb423-6" aria-hidden="true" tabindex="-1"></a>         Sex <span class="sc">==</span> <span class="st">&#39;All&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb423-7"><a href="#cb423-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(DateCode, Value,<span class="st">`</span><span class="at">Migration Source</span><span class="st">`</span>, <span class="st">`</span><span class="at">Migration Type</span><span class="st">`</span>)</span>
<span id="cb423-8"><a href="#cb423-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb423-9"><a href="#cb423-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb423-10"><a href="#cb423-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb423-11"><a href="#cb423-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(traffic_scot2, <span class="fu">aes</span>(DateCode, Value,</span>
<span id="cb423-12"><a href="#cb423-12" aria-hidden="true" tabindex="-1"></a>                          <span class="at">shape =</span> <span class="st">`</span><span class="at">Migration Source</span><span class="st">`</span>, </span>
<span id="cb423-13"><a href="#cb423-13" aria-hidden="true" tabindex="-1"></a>                          <span class="at">colour =</span> <span class="st">`</span><span class="at">Migration Type</span><span class="st">`</span>)) <span class="sc">+</span> </span>
<span id="cb423-14"><a href="#cb423-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb423-15"><a href="#cb423-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb423-16"><a href="#cb423-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">2002</span>,<span class="dv">2018</span>), <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">2002</span><span class="sc">:</span><span class="dv">2018</span>))</span></code></pre></div>
<p><img src="Intro-to-R-GU-Open-Studies-2021-2022_files/figure-html/unnamed-chunk-343-1.png" width="672" /></p>
</div>
<div id="saving-plots" class="section level2 hasAnchor" number="8.10">
<h2 class="hasAnchor"><span class="header-section-number">8.10</span> Saving plots<a href="#saving-plots" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Finally, we have made these lovely plots but we want to be able to put them in reports, papers, on a poster (print it in a large canvas for friends and family to admire). To save your plot to your working directory, you can use the function <code>ggsave</code>. First, you have to save your plot into an object in the <code>Global Environment</code>.</p>
<div class="sourceCode" id="cb424"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb424-1"><a href="#cb424-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save your plot to the Global Environment.</span></span>
<span id="cb424-2"><a href="#cb424-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb424-3"><a href="#cb424-3" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(traffic_scot2, <span class="fu">aes</span>(DateCode, Value,</span>
<span id="cb424-4"><a href="#cb424-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">shape =</span> <span class="st">`</span><span class="at">Migration Source</span><span class="st">`</span>, </span>
<span id="cb424-5"><a href="#cb424-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">colour =</span> <span class="st">`</span><span class="at">Migration Type</span><span class="st">`</span>)) <span class="sc">+</span> </span>
<span id="cb424-6"><a href="#cb424-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb424-7"><a href="#cb424-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb424-8"><a href="#cb424-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb424-9"><a href="#cb424-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb424-10"><a href="#cb424-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb424-11"><a href="#cb424-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Then save it to your working directory folder</span></span>
<span id="cb424-12"><a href="#cb424-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">&#39;myplot.png&#39;</span>, plot1, <span class="at">width =</span> <span class="dv">9</span> , <span class="at">height =</span> <span class="dv">6</span>)</span></code></pre></div>
</div>
<div id="summative-homework-3" class="section level2 hasAnchor" number="8.11">
<h2 class="hasAnchor"><span class="header-section-number">8.11</span> Summative Homework<a href="#summative-homework-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The fourth summative assignment is available on Moodle now.</p>
<p>Good luck.</p>
<p>Check that your Rmd file knits into a html file before submitting. Upload your Rmd file (not the knitted html) to Moodle.</p>
<!--chapter:end:08-viz_2.Rmd-->
</div>
</div>
<div id="errors" class="section level1 hasAnchor" number="9">
<h1 class="hasAnchor"><span class="header-section-number">9</span> Errors<a href="#errors" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="intended-learning-outcomes-9" class="section level2 unnumbered hasAnchor">
<h2 class="unnumbered hasAnchor">Intended Learning Outcomes<a href="#intended-learning-outcomes-9" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>By the end of this session you should be:</p>
<ol style="list-style-type: decimal">
<li>Able to identify some of the more common errors found in R code.</li>
<li>Able to correct some of the more common errors found in R code.</li>
<li>Know where to go online to find help and continue your coding journey on your own.</li>
</ol>
<p>This lesson is led by <a href="https://www.psy.gla.ac.uk/otherstaff/?id=TJ001">Jaimie Torrance</a>.</p>
</div>
<div id="errors-how-to-avoid-some-and-live-through-the-rest" class="section level2 hasAnchor" number="9.1">
<h2 class="hasAnchor"><span class="header-section-number">9.1</span> Errors: How to avoid some and live through the rest<a href="#errors-how-to-avoid-some-and-live-through-the-rest" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>I don’t know a single person who can produce 100% correct code on the first attempt. It’s even common to produce code that runs, only for you to find out later that there were errors. Not all errors prevent code from running!</p>
<p>This is a lesson focused on how to find and correct it <em>when</em> they happen- and they often do.</p>
</div>
<div id="debugging" class="section level2 hasAnchor" number="9.2">
<h2 class="hasAnchor"><span class="header-section-number">9.2</span> Debugging<a href="#debugging" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<center>
<figure>
<img src="images/debugging.jpg">
<figcaption>
A literal bug in a machine, often incorrectly cited as the source of the term “debugging”. From <a href="https://en.wikipedia.org/wiki/Debugging" class="uri">https://en.wikipedia.org/wiki/Debugging</a>.
</figcaption>
</figure>
</center>
<p><br></p>
<p>Debugging is the process of identifying and removing errors from your code. It sounds a bit technical, but you’ve probably been doing it already.</p>
<p>What you do to identify errors depends on what is wrong. There are various types of messages that R will give you that will help you identify the issues that you are having.</p>
<p>Reading these error messages will come naturally after you get a bit more experience under your belt, but in the meantime let’s look at common problems.</p>
<div id="messages-from-r" class="section level3 hasAnchor" number="9.2.1">
<h3 class="hasAnchor"><span class="header-section-number">9.2.1</span> Messages from R<a href="#messages-from-r" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Occasionally, R will return some text when you run a piece of code. Often, this text is coloured red, which causes a bit of panic in newer users. It is printed in the console, but also may be displayed below code chunks in R Markdown documents.</p>
<div class="info">
<p>
It is important to note that <strong>not all red text indicates an
error!</strong> There are a number of things that R could be trying to
tell you, all that the red colour indicates is that you should be paying
attention to it.
</p>
</div>
<p>Let’s have a look at what different types of thing R could be telling you when you get a text output.</p>
</div>
<div id="error-messages" class="section level3 hasAnchor" number="9.2.2">
<h3 class="hasAnchor"><span class="header-section-number">9.2.2</span> Error Messages<a href="#error-messages" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>These are definitely the ones that people worry about the most, but error messages given information about what has gone wrong. By reading and interpreting these messages we can diagnose the problem and fix it- a process called <strong>debugging</strong>. Let’s do something that will definitely generate an error and have a look at it:</p>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb425-1"><a href="#cb425-1" aria-hidden="true" tabindex="-1"></a>demo <span class="ot">&lt;-</span> <span class="fu">read_cvs</span>(<span class="st">&quot;some_file_name.csv&quot;</span>)</span></code></pre></div>
<pre><code>## Error in read_cvs(&quot;some_file_name.csv&quot;): konnte Funktion &quot;read_cvs&quot; nicht finden</code></pre>
<p>Breaking it down:</p>
<ul>
<li><code>Error...</code>: error messages are always preceded by the word error</li>
<li><code>could not find function "read_cvs"</code>: the content of the error message. In this case the function I have tried to call is not found.</li>
</ul>
<div class="info">
<p>
<strong>Error messages should give a hint as to what has gone
wrong</strong>. You will gain more experience in reading and
interpreting these messages over time, most of us have just seen them a
lot in our own work and have become accustomed to it!
</p>
</div>
<p>Trying to run a piece of code that results in an error will not produce any output, besides the error message. This means that any objects you try to create or processes that you try to run, will not be created or run.</p>
<div class="warning">
<p>
<strong>It is possible to write code which is valid, but does not do
what you expect it to do!</strong> In this case, no error messages are
produced, but the final outcome is still “incorrect”- that is, it is not
the outcome that you anticipated.
</p>
<p>
For this reason, you should always check that the outcome you have
gotten from a line or segment of code is what you expected to get!
</p>
<p>
For example, this might happen if you try to use
<code>filter(variable &gt; 150)</code>, which would retain all
observations where the values in <code>variable</code> were greater than
150, when you actually mean to use
<code>filter(variable &lt; 150)</code> to get rid of all observations
where the values in <code>variable</code> were greater than 150
(retaining those below 150).
</p>
</div>
<p><span style="font-size: 22px; font-weight: bold; color: hsl(24, 100%, 50%);">Question Time</span></p>
<div class="task">
<p>
<strong>Your turn</strong>
</p>
<p>
We have some error messages below- let’s look at them and see if we
can solve them.
</p>
<p>
If you want, you can download
<a href="data/cars_for_sale.csv" download>cars_for_sale.csv</a> and test
them out as we go.
</p>
</div>
<div id="could-not-find-function-1" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Could not find function: 1<a href="#could-not-find-function-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb427-1"><a href="#cb427-1" aria-hidden="true" tabindex="-1"></a>demonstration <span class="ot">&lt;-</span> <span class="fu">read_cvs</span>(<span class="st">&quot;cars_for_sale.csv&quot;</span>)</span></code></pre></div>
<pre><code>## Error in read_cvs(&quot;cars_for_sale.csv&quot;): konnte Funktion &quot;read_cvs&quot; nicht finden</code></pre>
<p>What do you think this error message means? How is it fixed?</p>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb429-1"><a href="#cb429-1" aria-hidden="true" tabindex="-1"></a>demonstration <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;cars_for_sale.csv&quot;</span>)</span>
<span id="cb429-2"><a href="#cb429-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb429-3"><a href="#cb429-3" aria-hidden="true" tabindex="-1"></a><span class="co"># We tried to run the function read_cvs()- this doesn&#39;t </span></span>
<span id="cb429-4"><a href="#cb429-4" aria-hidden="true" tabindex="-1"></a><span class="co"># exist! Again, it might seem trivial, but R really </span></span>
<span id="cb429-5"><a href="#cb429-5" aria-hidden="true" tabindex="-1"></a><span class="co"># won&#39;t know what this means.</span></span></code></pre></div>
</div>
</div>
<div id="could-not-find-function-2" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Could not find function: 2<a href="#could-not-find-function-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb430-1"><a href="#cb430-1" aria-hidden="true" tabindex="-1"></a>demonstration <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;cars_for_sale.csv&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb431-1"><a href="#cb431-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Error in read_cvs(&quot;cars_for_sale.csv&quot;): could not find function &quot;read_csv&quot;</span></span></code></pre></div>
<p>What do you think this error message means? How is it fixed?</p>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb432"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb432-1"><a href="#cb432-1" aria-hidden="true" tabindex="-1"></a>demonstration <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;cars_for_sale.csv&quot;</span>)</span>
<span id="cb432-2"><a href="#cb432-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb432-3"><a href="#cb432-3" aria-hidden="true" tabindex="-1"></a><span class="co"># We tried to run the function read_csv(), but if tidyverse</span></span>
<span id="cb432-4"><a href="#cb432-4" aria-hidden="true" tabindex="-1"></a><span class="co"># is not loaded then this function, which is part of tidyverse,</span></span>
<span id="cb432-5"><a href="#cb432-5" aria-hidden="true" tabindex="-1"></a><span class="co"># is not available for use.</span></span>
<span id="cb432-6"><a href="#cb432-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb432-7"><a href="#cb432-7" aria-hidden="true" tabindex="-1"></a><span class="co"># We need to run library(tidyverse) before we can use it</span></span></code></pre></div>
</div>
</div>
<div id="unexpected" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Unexpected ‘)’<a href="#unexpected" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb433-1"><a href="#cb433-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)<span class="er">)</span></span></code></pre></div>
<pre><code>## Error: &lt;text&gt;:1:19: Unerwartete(s) &#39;)&#39;
## 1: library(tidyverse))
##                       ^</code></pre>
<p>What does the error message tell you? What happened and what do you think I should do to fix it?</p>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb435-1"><a href="#cb435-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb435-2"><a href="#cb435-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb435-3"><a href="#cb435-3" aria-hidden="true" tabindex="-1"></a><span class="co"># There was an extra ) in there. It might seem trivial, </span></span>
<span id="cb435-4"><a href="#cb435-4" aria-hidden="true" tabindex="-1"></a><span class="co"># but this prevented the line of code from being run.</span></span>
<span id="cb435-5"><a href="#cb435-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb435-6"><a href="#cb435-6" aria-hidden="true" tabindex="-1"></a><span class="co"># This can happen with any function that uses brackets, </span></span>
<span id="cb435-7"><a href="#cb435-7" aria-hidden="true" tabindex="-1"></a><span class="co"># but also with other symbols such as &quot;,&quot;.</span></span></code></pre></div>
</div>
</div>
<div id="not-in-current-working-directory" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Not in current working directory<a href="#not-in-current-working-directory" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb436"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb436-1"><a href="#cb436-1" aria-hidden="true" tabindex="-1"></a>demonstration <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;cars_for_sale.csv&quot;</span>)</span></code></pre></div>
<pre><code>## Error: &#39;cars_for_sale.csv&#39; does not exist in current working directory (&#39;C:/Users/johan/Desktop/Intro_to_R_2022_Book/Gaby&#39;).</code></pre>
<p>What do you think this error means? We have all seen it at least once. I see it all the time because I always forget to do something when I start working.</p>
<div class="webex-solution">
<button>
Solution
</button>
<p>If you are coding along and have correctly set your working directory before trying to replicate this error… you won’t see the error! Well done!</p>
<div class="sourceCode" id="cb438"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb438-1"><a href="#cb438-1" aria-hidden="true" tabindex="-1"></a>demonstration <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;cars_for_sale.csv&quot;</span>)</span>
<span id="cb438-2"><a href="#cb438-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb438-3"><a href="#cb438-3" aria-hidden="true" tabindex="-1"></a><span class="co"># We tried to run the function read_csv() and to read</span></span>
<span id="cb438-4"><a href="#cb438-4" aria-hidden="true" tabindex="-1"></a><span class="co"># cars_for_sale.csv, but in this instance the file was </span></span>
<span id="cb438-5"><a href="#cb438-5" aria-hidden="true" tabindex="-1"></a><span class="co"># not in the current working directory</span></span>
<span id="cb438-6"><a href="#cb438-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb438-7"><a href="#cb438-7" aria-hidden="true" tabindex="-1"></a><span class="co"># to fix this we can go to the Session Menu, Set Working</span></span>
<span id="cb438-8"><a href="#cb438-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Directory and Choose Directory to tell R where this file</span></span>
<span id="cb438-9"><a href="#cb438-9" aria-hidden="true" tabindex="-1"></a><span class="co"># can be found</span></span></code></pre></div>
</div>
</div>
<div id="could-not-find-object" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Could not find object<a href="#could-not-find-object" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb439"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb439-1"><a href="#cb439-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(demonstration)</span></code></pre></div>
<pre><code>## Error in head(demonstration): Objekt &#39;demonstration&#39; nicht gefunden</code></pre>
<p>I’ve tried to use the function head on the object I tried to create above. Have a think about why this error has been returned and how to fix it.</p>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb441"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb441-1"><a href="#cb441-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(demonstration)</span>
<span id="cb441-2"><a href="#cb441-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb441-3"><a href="#cb441-3" aria-hidden="true" tabindex="-1"></a><span class="co"># This code is correct, but errors can be cumulative... </span></span>
<span id="cb441-4"><a href="#cb441-4" aria-hidden="true" tabindex="-1"></a><span class="co"># that is, if a later piece of code is contingent on a </span></span>
<span id="cb441-5"><a href="#cb441-5" aria-hidden="true" tabindex="-1"></a><span class="co"># previous piece of code running successfully then</span></span>
<span id="cb441-6"><a href="#cb441-6" aria-hidden="true" tabindex="-1"></a><span class="co"># the later piece of code won&#39;t work if the earlier</span></span>
<span id="cb441-7"><a href="#cb441-7" aria-hidden="true" tabindex="-1"></a><span class="co"># one wasn&#39;t run!</span></span>
<span id="cb441-8"><a href="#cb441-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb441-9"><a href="#cb441-9" aria-hidden="true" tabindex="-1"></a><span class="co"># The previous code creating the object had many errors, </span></span>
<span id="cb441-10"><a href="#cb441-10" aria-hidden="true" tabindex="-1"></a><span class="co"># one loading tidyverse into the library which is </span></span>
<span id="cb441-11"><a href="#cb441-11" aria-hidden="true" tabindex="-1"></a><span class="co"># necessary for the `read_csv()` function to be usable </span></span>
<span id="cb441-12"><a href="#cb441-12" aria-hidden="true" tabindex="-1"></a><span class="co"># and the second was a typo in the `read_csv()` function, </span></span>
<span id="cb441-13"><a href="#cb441-13" aria-hidden="true" tabindex="-1"></a><span class="co"># so the object `demonstration` was not created, and </span></span>
<span id="cb441-14"><a href="#cb441-14" aria-hidden="true" tabindex="-1"></a><span class="co"># thus there is no object to call using `head()`</span></span></code></pre></div>
</div>
</div>
<div id="code-wont-run-in-the-console" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Code won’t run, + in the console<a href="#code-wont-run-in-the-console" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb442"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb442-1"><a href="#cb442-1" aria-hidden="true" tabindex="-1"></a>demonstration <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;cars_for_sale.csv&quot;</span></span></code></pre></div>
<p>This error appears in the console as below:</p>
<center>
<img src="images/plus_error.gif">
</center>
<p>What has happened? How do I fix it?</p>
<div class="webex-solution">
<button>
Solution
</button>
<div class="sourceCode" id="cb443"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb443-1"><a href="#cb443-1" aria-hidden="true" tabindex="-1"></a>demonstration <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;cars_for_sale.csv&quot;</span>)</span></code></pre></div>
<pre><code>## Error: &#39;cars_for_sale.csv&#39; does not exist in current working directory (&#39;C:/Users/johan/Desktop/Intro_to_R_2022_Book/Gaby&#39;).</code></pre>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb445-1"><a href="#cb445-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This time there is a missing bracket at the end!</span></span>
<span id="cb445-2"><a href="#cb445-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb445-3"><a href="#cb445-3" aria-hidden="true" tabindex="-1"></a><span class="co"># This means R is still expecting some kind of input.</span></span>
<span id="cb445-4"><a href="#cb445-4" aria-hidden="true" tabindex="-1"></a><span class="co"># It&#39;s kinda like talking to someone but forgetting to </span></span>
<span id="cb445-5"><a href="#cb445-5" aria-hidden="true" tabindex="-1"></a><span class="co"># finish the sentence! The person listening will be</span></span>
<span id="cb445-6"><a href="#cb445-6" aria-hidden="true" tabindex="-1"></a><span class="co"># confused because they expected a bit more.</span></span>
<span id="cb445-7"><a href="#cb445-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb445-8"><a href="#cb445-8" aria-hidden="true" tabindex="-1"></a><span class="co"># To get rid of the +, click in the console then </span></span>
<span id="cb445-9"><a href="#cb445-9" aria-hidden="true" tabindex="-1"></a><span class="co"># press the escape key (&quot;esc&quot;, top-left of the keyboard)</span></span>
<span id="cb445-10"><a href="#cb445-10" aria-hidden="true" tabindex="-1"></a><span class="co"># until you see the more familiar &gt; symbol.</span></span>
<span id="cb445-11"><a href="#cb445-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb445-12"><a href="#cb445-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Next, correct the code by giving R what it expected </span></span>
<span id="cb445-13"><a href="#cb445-13" aria-hidden="true" tabindex="-1"></a><span class="co"># you to finish with, in this case the closing ).</span></span>
<span id="cb445-14"><a href="#cb445-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the code again to create the object.</span></span></code></pre></div>
</div>
</div>
</div>
<div id="multiple-errors" class="section level3 hasAnchor" number="9.2.3">
<h3 class="hasAnchor"><span class="header-section-number">9.2.3</span> Multiple Errors<a href="#multiple-errors" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If you have an error in your script on an earlier line, and have code later which depends on the success of running this earlier line, then you are also going have problems. Later code which might otherwise work would be missing a key component which would cause errors further down.</p>
<p>Sometimes finding the source of an error requires you to go back to look through your previous code. Keep this in mind when debugging!</p>
<p>For example: <code>libraary(tidyverse)</code> fails to load the appropriate package containing the function we need (<code>read_csv()</code>), which then means we do not load the data file we want.</p>
<p>You can help prevent this sort of thing from happening by running all lines of code individually, rerunning later code after you’ve made changes to earlier code and periodically restarting the R session and running all code from the beginning.</p>
<p>Find the error location by following the trail set out in the error message. Where did the code stop running correctly? When did the error message appear in the console or in the .Rmd outputs? What does the error message say?</p>
<p>These pieces of information should allow you to find the location of the error and solve it successfully.</p>
</div>
<div id="finding-errors-in-longer-code-segments" class="section level3 hasAnchor" number="9.2.4">
<h3 class="hasAnchor"><span class="header-section-number">9.2.4</span> Finding errors in longer code segments<a href="#finding-errors-in-longer-code-segments" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The above examples are the most simple examples of debugging that you are likely to get. If these are the only ones you encounter, you will be incredibly lucky!</p>
<p>We’ve been learning to use longer segments of code- not only single lines as in the example above… this can make it more difficult to find and diagnose errors.</p>
<p>Let’s look at some error messages in longer examples and discuss some of the strategies that you might want to use to make your life easier.</p>
<div id="errors-in-pipes" class="section level4 hasAnchor" number="9.2.4.1">
<h4 class="hasAnchor"><span class="header-section-number">9.2.4.1</span> Errors in Pipes<a href="#errors-in-pipes" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>As we saw before, pipes allow us to chain multiple functions together. For a recap of pipes, see the section on pipes in <a href="#pipes">lecture 4</a>. This makes life a lot easier, <em>if the code works</em>. If there is an error, it makes debugging a little more difficult as we need to establish which line the error occurs in.</p>
<p>Let’s get a working example going, and we’ll use some of the data built in to the tidyverse called <code>starwars</code> so we don’t need to import any new data. let’s look at it:</p>
<div class="sourceCode" id="cb446"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb446-1"><a href="#cb446-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb446-2"><a href="#cb446-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb446-3"><a href="#cb446-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(starwars)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 14
##   name      height  mass hair_color skin_color eye_color birth_year sex   gender
##   &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
## 1 Luke Sky~    172    77 blond      fair       blue            19   male  mascu~
## 2 C-3PO        167    75 &lt;NA&gt;       gold       yellow         112   none  mascu~
## 3 R2-D2         96    32 &lt;NA&gt;       white, bl~ red             33   none  mascu~
## 4 Darth Va~    202   136 none       white      yellow          41.9 male  mascu~
## 5 Leia Org~    150    49 brown      light      brown           19   fema~ femin~
## 6 Owen Lars    178   120 brown, gr~ light      blue            52   male  mascu~
## # ... with 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
## #   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
<p>This is the data on the characters in the Star Wars universe (I have no idea if it counts the newer movies).</p>
<p>Let’s look at this (faulty) code which counts the number of each species and their genders featured then arranges them by number in descending order:</p>
<div class="sourceCode" id="cb448"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb448-1"><a href="#cb448-1" aria-hidden="true" tabindex="-1"></a>species_count <span class="ot">&lt;-</span> starwars <span class="sc">%&gt;%</span></span>
<span id="cb448-2"><a href="#cb448-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(starwars, species, gender) <span class="sc">%&gt;%</span></span>
<span id="cb448-3"><a href="#cb448-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb448-4"><a href="#cb448-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n))</span></code></pre></div>
<pre><code>## Error in `group_by()`:
## ! Must group by variables found in `.data`.
## x Column `starwars` is not found.</code></pre>
<p>What is the best way to find out which part is wrong?</p>
<p>Going through it a bit at a time will help you!</p>
<p>We can do this by first highlighting the first line <em><strong>before the first pipe</strong></em> and then pressing <code>Ctrl</code>+<code>Enter</code>. this will run only that line of code:</p>
<center>
<img src="images/pipe_error_1.gif" />
</center>
<p>OK, we can see that we now have an object called <code>species_count</code> in the environment, and this now contains the data set <code>starwars</code>. The code ran, and ran as we expected it to.</p>
<p>Let’s move on to the second line. Highlight the first two lines <em><strong>before the second pipe</strong></em>, again this will only run the first two lines of code:</p>
<center>
<img src="images/pipe_error_2.gif" />
</center>
<pre><code>## Error in `group_by()`:
## ! Must group by variables found in `.data`.
## x Column `starwars` is not found.</code></pre>
<p>There we go, the location of the error is uncovered! We can now look at what is going on in line 2 and figure out what is going on.</p>
<p><span style="font-size: 22px; font-weight: bold; color: hsl(24, 100%, 50%);">Question Time</span></p>
<p>From the text of the error message that the error relates to the column name <code>starwars</code>, so we look at parts called <code>starwars</code> in our code. We have already established that the first time this appears (in line 1) that the code runs and runs as we expected it to, so the error is in line 2.</p>
<p>Let’s look at line 2 in more detail. We know that:</p>
<ul>
<li>the result of line 1 (the entire data frame <code>starwars</code>) is run <strong>and then</strong> is put into the first argument of the second line’s function</li>
<li><code>group_by()</code> normally takes a data frame as its first argument so we only need to specify the grouping variables because the data argument is already specified by the pipe.</li>
</ul>
<p>Given the information above and the text of the error message, who knows what is happening? What would the correct code be?</p>
<div class="webex-solution">
<button>
Solution
</button>
<p>We tried to re-specify the data frame argument in the <code>group_by()</code> function on the second line.</p>
<p>Because the pipe operator already does this, the function then interprets the extra <code>starwars</code> as a column to group by. There is no column called that in the data frame, so we get an error message saying that there is no column called <code>starwars</code>.</p>
<pre><code>## Error in `group_by()`:
## ! Must group by variables found in `.data`.
## x Column `starwars` is not found.</code></pre>
<p>This would be the correct code to use:</p>
<div class="sourceCode" id="cb452"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb452-1"><a href="#cb452-1" aria-hidden="true" tabindex="-1"></a>species_count <span class="ot">&lt;-</span> starwars <span class="sc">%&gt;%</span></span>
<span id="cb452-2"><a href="#cb452-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(species, gender) <span class="sc">%&gt;%</span></span>
<span id="cb452-3"><a href="#cb452-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb452-4"><a href="#cb452-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n))</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;species&#39;. You can override using the
## `.groups` argument.</code></pre>
<p>This is a common error for those who are new to using pipelines in their code.</p>
</div>
</div>
<div id="errors-in-ggplot" class="section level4 hasAnchor" number="9.2.4.2">
<h4 class="hasAnchor"><span class="header-section-number">9.2.4.2</span> Errors in ggplot()<a href="#errors-in-ggplot" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><code>ggplot()</code> errors can be difficult to diagnose for the same reason that pipeline errors can be- there are multiple lines of code!</p>
<p>Let’s get an example of a plot to work with. We’ll use the built in data set called <code>mpg</code>.</p>
<p>The following plot looks at data on fuel consumption. More specifically it shows the relationship between city fuel consumption (on the x axis) and highway fuel consumption (on the y axis), with a “line of best fit” to demonstrate the correlation between them. Vehicles of different classes are specified in different colours according to the legend on the right of the graph.</p>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="Intro-to-R-GU-Open-Studies-2021-2022_files/figure-html/unnamed-chunk-369-1.png" width="672" /></p>
<p>Plots are made by code, and like all the other code, it can be subject to the same errors from misplaced or missing brackets, commas and non-existent objects in the environment. We won’t be looking at these here because they’ve been covered above and you should be able to extrapolate that information when the same error occurs under different circumstances.</p>
<p>Let’s look at a few errors that can occur specifically when creating plots:</p>
<div class="sourceCode" id="cb455"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb455-1"><a href="#cb455-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> cty)) <span class="sc">+</span></span>
<span id="cb455-2"><a href="#cb455-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> F, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>) </span>
<span id="cb455-3"><a href="#cb455-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">colour =</span> class)) <span class="sc">+</span></span>
<span id="cb455-4"><a href="#cb455-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span> (<span class="at">x =</span> <span class="st">&quot;City MPG&quot;</span>,</span>
<span id="cb455-5"><a href="#cb455-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">&quot;Highway MPG&quot;</span>)</span></code></pre></div>
<p>Here is the code to recreate the graph presented above, but I’ve created 3 errors in it. These are probably the most common errors you will encounter.</p>
<p><span style="font-size: 22px; font-weight: bold; color: hsl(24, 100%, 50%);">Question Time</span></p>
<p>Let’s look at fixing these 3 errors. As a bonus, the same method used in debugging pipes is also used.</p>
<p>The data set <code>mpg</code> is built in to tidyverse, so if you want to code and test the issues to see if you resolve them please do.</p>
<div id="stat_smooth-requires-the-following-missing-aesthetics-y" class="section level5 unnumbered hasAnchor">
<h5 class="unnumbered hasAnchor">stat_smooth requires the following missing aesthetics: y<a href="#stat_smooth-requires-the-following-missing-aesthetics-y" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>This is our first attempt at replicating the graph above. This time we have three errors, two with error messages (currently), but let’s focus only on the first one for now. The error message that appears first in the console is the one that happens first in the code and <strong>error messages can be cumulative</strong>- even if we correct the second one it still might not work because of the earlier code.</p>
<p>When I run this code, I get the following print out in the console, indicating the errors that have occurred:</p>
<div class="sourceCode" id="cb456"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb456-1"><a href="#cb456-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> cty)) <span class="sc">+</span></span>
<span id="cb456-2"><a href="#cb456-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> F, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>) </span>
<span id="cb456-3"><a href="#cb456-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">colour =</span> class)) <span class="sc">+</span></span>
<span id="cb456-4"><a href="#cb456-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span> (<span class="at">x =</span> <span class="st">&quot;City MPG&quot;</span>,</span>
<span id="cb456-5"><a href="#cb456-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">&quot;Highway MPG&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb457"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb457-1"><a href="#cb457-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Error: stat_smooth requires the following missing aesthetics: y</span></span>
<span id="cb457-2"><a href="#cb457-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> F, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>) </span>
<span id="cb457-3"><a href="#cb457-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Error: Cannot add ggproto objects together. Did you forget to add this object to a ggplot object?</span></span></code></pre></div>
<p>Let’s do the same thing that we did with pipes, highlight the first line and run it. This time we don’t stop at a pipe, because there is no pipe, we <strong>stop before the <code>+</code></strong>.</p>
<center>
<img src="images/gg_error_2.gif" />
</center>
<p><img src="Intro-to-R-GU-Open-Studies-2021-2022_files/figure-html/unnamed-chunk-373-1.png" width="672" /></p>
<p>OK, so this produces the first layer of the graph- the background with a scale on the axis.</p>
<p>What do you think is going on here? There is a hint available at this stage. Compare the axes on the graph we are aiming to produce versus the axes you have on this sample.</p>
<p>If you are still not sure, do the same thing with the second line of the code, this is where the error message is produced in the code and this should provide you with extra information.</p>
<center>
<img src="images/gg_error_3.gif" />
</center>
<div class="webex-solution">
<button>
Solution
</button>
<p>You are attempting to plot a “line of best fit” to show a correlation between two variables, and those two variables should be presented on each of the axes. The erroneous code specifies only one axis (the <code>x</code> axis). The correct code also specifies the missing <code>y</code> axis:</p>
<div class="sourceCode" id="cb458"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb458-1"><a href="#cb458-1" aria-hidden="true" tabindex="-1"></a><span class="co"># first two lines should read:</span></span>
<span id="cb458-2"><a href="#cb458-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> cty, <span class="at">y =</span> hwy)) <span class="sc">+</span></span>
<span id="cb458-3"><a href="#cb458-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> F, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>) </span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="Intro-to-R-GU-Open-Studies-2021-2022_files/figure-html/unnamed-chunk-374-1.png" width="672" /></p>
</div>
</div>
<div id="cannot-add-ggproto-objects-together.-did-you-forget-to-add-this-object-to-a-ggplot-object" class="section level5 unnumbered hasAnchor">
<h5 class="unnumbered hasAnchor">Cannot add ggproto objects together. Did you forget to add this object to a ggplot object?<a href="#cannot-add-ggproto-objects-together.-did-you-forget-to-add-this-object-to-a-ggplot-object" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Here you can clearly see that I have 2 <code>geom</code> layers, but only the <code>geom_smooth</code> is showing (that’s the line of the correlation between the variables on the x and y axes).</p>
<div class="sourceCode" id="cb460"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb460-1"><a href="#cb460-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> cty, <span class="at">y=</span> hwy)) <span class="sc">+</span></span>
<span id="cb460-2"><a href="#cb460-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> F, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>) </span>
<span id="cb460-3"><a href="#cb460-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">colour =</span> class)) <span class="sc">+</span></span>
<span id="cb460-4"><a href="#cb460-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span> (<span class="at">x =</span> <span class="st">&quot;City MPG&quot;</span>,</span>
<span id="cb460-5"><a href="#cb460-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">&quot;Highway MPG&quot;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="Intro-to-R-GU-Open-Studies-2021-2022_files/figure-html/unnamed-chunk-376-1.png" width="672" /></p>
<div class="sourceCode" id="cb462"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb462-1"><a href="#cb462-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Error: Cannot add ggproto objects together. Did you forget to add this object to a ggplot object?</span></span></code></pre></div>
<p>Let’s do the same thing that we did with pipes, highlight the first line and run it. As above, we don’t stop at a pipe we <strong>stop before the <code>+</code></strong>.</p>
<center>
<img src="images/gg_error_1.gif" />
</center>
<p><img src="Intro-to-R-GU-Open-Studies-2021-2022_files/figure-html/unnamed-chunk-378-1.png" width="672" /></p>
<p>Did it do as we expected it to do?</p>
<p>Keep moving down the code segment line by line until you find where the result deviates from what we were expecting.</p>
<p>What was the problem in this case? How do we solve this?</p>
<div class="webex-solution">
<button>
Solution
</button>
<p>The <code>+</code> symbol was missing at the end of the line <code>geom_smooth()</code>. This means that <code>ggplot()</code> didn’t know to add the extra layers to the graph!</p>
</div>
</div>
<div id="stat_count-must-not-be-used-with-a-y-aesthetic." class="section level5 unnumbered hasAnchor">
<h5 class="unnumbered hasAnchor">stat_count() must not be used with a y aesthetic.<a href="#stat_count-must-not-be-used-with-a-y-aesthetic." class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Now that the previous error is fixed we can have a look at the next one.</p>
<div class="sourceCode" id="cb463"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb463-1"><a href="#cb463-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x =</span> cty, <span class="at">y=</span> hwy)) <span class="sc">+</span></span>
<span id="cb463-2"><a href="#cb463-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> F, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb463-3"><a href="#cb463-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">colour =</span> class)) <span class="sc">+</span></span>
<span id="cb463-4"><a href="#cb463-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span> (<span class="at">x =</span> <span class="st">&quot;City MPG&quot;</span>,</span>
<span id="cb463-5"><a href="#cb463-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">&quot;Highway MPG&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb464"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb464-1"><a href="#cb464-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Error: stat_count() must not be used with a y aesthetic.</span></span></code></pre></div>
<p><code>stat_count()</code> is another way of producing a <code>geom_bar()</code> style of graph. With this in mind, what do you think is wrong with the code segment?</p>
<p>Do you think a bar graph is a good way to demonstrate the relationship between two sets of continuous values?</p>
<p>Have a think and figure out what the problem is now. Run each line of code individually and see where the problem is coming from.</p>
<div class="webex-solution">
<button>
Solution
</button>
<p>If we want to display individual data points a bar graph would be the wrong type of <code>geom</code> to use, as these produce counts and not individual points for each data point.</p>
<p>instead of using <code>geom_bar()</code> we should have used <code>geom_point()</code> or <code>geom_jitter()</code>.</p>
</div>
</div>
</div>
</div>
<div id="warning-messages" class="section level3 hasAnchor" number="9.2.5">
<h3 class="hasAnchor"><span class="header-section-number">9.2.5</span> Warning Messages<a href="#warning-messages" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Warning messages are another type of message that you might encounter. Warning messages aren’t quite errors, but aren’t as benign as other types of textual outputs in the console.</p>
<p>A warning will not halt the execution of code that you are running, but will allow the code to run. A warning message should spur you to checking if the function(s) you have tried to run have done so correctly.</p>
</div>
<div id="other-messages" class="section level3 hasAnchor" number="9.2.6">
<h3 class="hasAnchor"><span class="header-section-number">9.2.6</span> Other Messages<a href="#other-messages" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There are also other types of textual output, too numerous to classify here. Here is an example that you should have been seeing on a regular basis by this stage:</p>
<center>
<img src="images/tidyverse_success.png" />
</center>
<p>This informs us that by using the code <code>library(tidyverse)</code> we have loaded in the packages listed under the sections that says <code>Attaching Packages</code>. <code>tidyverse</code> is, after all, a collection of other packages.</p>
<p>It also informs us that there are some conflicts- this usually panics people!</p>
<p>This section indicates that the function <code>filter()</code>, as part of the <code>dplyr</code> package within <code>tidyverse</code>, is masking another function with the same name which is part of the <code>stats</code> package, a part of base R. The same with <code>lag()</code>.</p>
<p>This just means that when you use the functions <code>filter()</code> or <code>lag()</code> it will be the <code>tidyverse</code> versions that are used as default.</p>
<p>You can still use the others, you just need to specify <code>stats::filter()</code> or <code>stats::lag()</code> if you do want to use these.</p>
<div class="warning">
<p>
Even though these functions use the same name, they do not perform
the same function!
</p>
<p>
<code>stats::filter()</code> and <code>stats::lag()</code> are both
concerned with time series analysis, not with data wrangling!
</p>
</div>
</div>
</div>
<div id="searching-for-help-online" class="section level2 hasAnchor" number="9.3">
<h2 class="hasAnchor"><span class="header-section-number">9.3</span> Searching for Help Online<a href="#searching-for-help-online" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>There are multiple places online where you can search for help.</p>
<div id="googling-it" class="section level3 hasAnchor" number="9.3.1">
<h3 class="hasAnchor"><span class="header-section-number">9.3.1</span> Googling It<a href="#googling-it" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The first thing you should do with an error is to Google it. It sounds daft, but if you are having an issue there is probably someone on the internet who has also had that same problem.</p>
<p>The main thing that you need to remember is that you need to include the right level of information in your query:
* searching for “R code not working” will not get you information which is specific enough.
* searching for “R” and the text given in the error message will give you a lot more, but some error message text can be the same for different functions.
* searching for “R”, the text given in the error message and the name of the function that is giving that error message will give you a lot more, specific information.</p>
<p>Learning to Google with appropriate levels of detail in your question is a skill in itself! We know this because we were in exactly the same position as you when we were first learning- and we still frequently Google things!</p>
</div>
<div id="stack-overflow" class="section level3 hasAnchor" number="9.3.2">
<h3 class="hasAnchor"><span class="header-section-number">9.3.2</span> Stack Overflow<a href="#stack-overflow" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><a href="https://stackoverflow.com/">Stack Overflow</a> is a useful site for discussion and asking for help from experts. It is a community for professional coders, and operates on a reputation-based system. There are already huge numbers of questions there that have been answered that you can search through, but if your question is novel or unique you might want to ask there.</p>
</div>
<div id="youtube" class="section level3 hasAnchor" number="9.3.3">
<h3 class="hasAnchor"><span class="header-section-number">9.3.3</span> YouTube<a href="#youtube" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><a href="https://www.youtube.com/results?search_query=learning+R">YouTube</a> has a number of free video tutorials that you might want to check out now that you’ve had an introduction from us. Sometimes hearing the information from a different perspective, or hearing it explained in a different way, can help you understand it better.</p>
</div>
<div id="further-reading" class="section level3 hasAnchor" number="9.3.4">
<h3 class="hasAnchor"><span class="header-section-number">9.3.4</span> Further Reading<a href="#further-reading" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Look at the <a href="#appendices">appendices</a> section of this site to see some further reading materials to expand on the knowledge you’ve gained in this course.</p>
</div>
</div>
<div id="formative-exercises" class="section level2 hasAnchor" number="9.4">
<h2 class="hasAnchor"><span class="header-section-number">9.4</span> Formative Exercises<a href="#formative-exercises" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now that we have completed the stuff for the in-class, we can move on to the formative exercises. Try the first couple in class (time permitting) and discuss them with those sitting near you if you wish or Rebecca.</p>
<p>Download the .zip folder <code>cars.zip</code> from Moodle. Extract the files and open the file <code>cars_formative.Rmd</code>.</p>
<p>In this file there are 6 error diagnosis and correction questions.</p>
<p>When you are done there is a file called <code>cars_solutions.Rmd</code> in this same zip folder. Use this to check your answers.</p>
<p>If you have questions you can ask on the Moodle forum.</p>
<!--chapter:end:09-debug.Rmd-->
</div>
</div>
<div id="recap-before-the-final-assessment" class="section level1 hasAnchor" number="10">
<h1 class="hasAnchor"><span class="header-section-number">10</span> Recap: Before the final assessment<a href="#recap-before-the-final-assessment" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="outline-for-today" class="section level2 hasAnchor" number="10.1">
<h2 class="hasAnchor"><span class="header-section-number">10.1</span> Outline for today<a href="#outline-for-today" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This lecture is structured a bit differently. First 10-15 min is time for you to ask any questions you have, clarify whatever you want to have clarified, etc. Then we will have an in-class practice exam that is structured fairly similar to the final summative homework assignment.</p>
<p>This in-class practice exam is led by <a href="https://www.psy.gla.ac.uk/otherstaff/?id=TIWT1">Wilhelmiina Toivo</a>.</p>
</div>
<div id="lecture-10-bringing-your-skills-together" class="section level2 hasAnchor" number="10.2">
<h2 class="hasAnchor"><span class="header-section-number">10.2</span> Lecture 10: Bringing your skills together<a href="#lecture-10-bringing-your-skills-together" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this practice exam, you will use all the skills you have learnt to tidy up, summarise, and visualise an actual data set. These data are from an experiment where participants were asked to rate 240 words on a scale from 1-9, 1 being <em>not exciting at all</em> and 9 being <em>extremely exciting</em>. This dimension is called emotional arousal of language. The words are split into three conditions: HA = <em>High arousal</em>, LA = <em>Low arousal</em> and DI = <em>neutral distractor words</em>. Each of the words has their own item number ranging from 1-240.</p>
<p>There are three datafiles:</p>
<ul>
<li><code>ratings.csv</code> contains ratings from 47 participants.</li>
<li><code>item_info.csv</code> contains more information about the words: <code>AROUSAL</code> column shows how people from a larger database (different to our participants) have rated the words on arousal, and <code>VALENCE</code> column shows how people have rated these words on valence (i.e. how positive or negative they think the words are).</li>
<li><code>groups</code> contains information about our participants, who were either bilingual speakers <code>B</code> or monolingual native English speakers <code>E</code>.</li>
</ul>
<p>Before we get started, make sure you have downloaded and unzipped the folder, and you have the three datafiles and this .Rmd file in it. Now set your working directory to the folder and we are ready to go.</p>
<p>Again, DON’T CHANGE THE OBJECT NAMES. Replace the NULLs with your code.</p>
<p>This exercise is <strong>NOT GRADED</strong>, but it is very similar to the summative assignment you will be given after this class, and should help you prepare for it.</p>
<div id="question-1-1" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Question 1<a href="#question-1-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Load in the package <code>tidyverse</code>. Type your code in the code chunk below.</p>
<div class="sourceCode" id="cb465"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb465-1"><a href="#cb465-1" aria-hidden="true" tabindex="-1"></a><span class="cn">NULL</span></span></code></pre></div>
</div>
<div id="question-2-1" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Question 2<a href="#question-2-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Read the data files into your <code>Global Environment</code>. Store <code>item_info.csv</code> as <code>words</code>, <code>ratings.csv</code> as <code>ratings</code>, and <code>groups.csv</code> as <code>groups</code>. Type your code in the code chunk below.</p>
<div class="sourceCode" id="cb466"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb466-1"><a href="#cb466-1" aria-hidden="true" tabindex="-1"></a>words <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb466-2"><a href="#cb466-2" aria-hidden="true" tabindex="-1"></a>ratings <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb466-3"><a href="#cb466-3" aria-hidden="true" tabindex="-1"></a>groups <span class="ot">&lt;-</span> <span class="cn">NULL</span></span></code></pre></div>
</div>
<div id="question-3-1" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Question 3<a href="#question-3-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Look at <code>ratings</code>. Oh dear - whoever has entered <code>ratings</code> data clearly doesn’t know about tidy data! Right now, each participant has their own row and each of the 240 words has their own column. We want to transform this data into long format so that the item numbers of the words (1-240) are in one column and all the ratings are in one column. Using <code>gather()</code>, make a new dataframe that has a column called <code>item</code>. This column should include the column headers (item number). Make another column that is called <code>rating</code>, which should include the cell values from columns that contain word ratings.</p>
<ul>
<li>Hint 1: Remember how to index columns which have numerical names?</li>
<li>Hint 2: Go to lecture 5 inclass material to see how to specify the arguments in <code>gather()</code></li>
</ul>
<div class="sourceCode" id="cb467"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb467-1"><a href="#cb467-1" aria-hidden="true" tabindex="-1"></a>ratings_long <span class="ot">&lt;-</span> <span class="cn">NULL</span></span></code></pre></div>
<p>You should end up with a dataframe that has 11280 observations and just three columns. The first 6 rows of <code>ratings_long</code> should look like the ones shown in the tibble below.</p>
<table>
<thead>
<tr class="header">
<th align="right">participant</th>
<th align="left">item</th>
<th align="right">rating</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">1</td>
<td align="right">8</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">1</td>
<td align="right">8</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">1</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">1</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="left">1</td>
<td align="right">5</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="left">1</td>
<td align="right">6</td>
</tr>
</tbody>
</table>
</div>
<div id="question-4-1" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Question 4<a href="#question-4-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now look at <code>words</code> dataframe. We don’t need all these columns. Make a new dataframe called <code>words_small</code> that only includes columns <code>item</code>, <code>Word</code>,<code>AROUSAL</code> and <code>VALENCE</code>.</p>
<div class="sourceCode" id="cb468"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb468-1"><a href="#cb468-1" aria-hidden="true" tabindex="-1"></a>words_small <span class="ot">&lt;-</span> <span class="cn">NULL</span></span></code></pre></div>
<p>The first 6 rows of <code>words_small</code> should look like the ones shown in the tibble below.</p>
<table>
<thead>
<tr class="header">
<th align="left">item</th>
<th align="left">Word</th>
<th align="right">AROUSAL</th>
<th align="right">VALENCE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1_HA</td>
<td align="left">porn</td>
<td align="right">7.24</td>
<td align="right">4.32</td>
</tr>
<tr class="even">
<td align="left">2_LA</td>
<td align="left">ford</td>
<td align="right">2.85</td>
<td align="right">5.79</td>
</tr>
<tr class="odd">
<td align="left">3_DI</td>
<td align="left">bolt</td>
<td align="right">4.55</td>
<td align="right">3.90</td>
</tr>
<tr class="even">
<td align="left">4_HA</td>
<td align="left">leopard</td>
<td align="right">6.26</td>
<td align="right">6.43</td>
</tr>
<tr class="odd">
<td align="left">5_LA</td>
<td align="left">dryer</td>
<td align="right">2.43</td>
<td align="right">5.21</td>
</tr>
<tr class="even">
<td align="left">6_DI</td>
<td align="left">fireman</td>
<td align="right">4.52</td>
<td align="right">6.47</td>
</tr>
</tbody>
</table>
</div>
<div id="question-5-1" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Question 5<a href="#question-5-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now we should put the tables together. But there is a problem! The columns don’t match. We need to change the <code>words_small</code> dataframe slightly. Separate the <code>item</code> column into two columns called <code>item</code> and <code>condition</code>, and remove the underscore.</p>
<p>Hint: Look at lecture 5 for help with this.</p>
<div class="sourceCode" id="cb469"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb469-1"><a href="#cb469-1" aria-hidden="true" tabindex="-1"></a>words_small <span class="ot">&lt;-</span> <span class="cn">NULL</span></span></code></pre></div>
<p>The first 6 rows of <code>words_small</code> should look like the ones shown in the tibble below.</p>
<table>
<thead>
<tr class="header">
<th align="left">item</th>
<th align="left">condition</th>
<th align="left">Word</th>
<th align="right">AROUSAL</th>
<th align="right">VALENCE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="left">HA</td>
<td align="left">porn</td>
<td align="right">7.24</td>
<td align="right">4.32</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="left">LA</td>
<td align="left">ford</td>
<td align="right">2.85</td>
<td align="right">5.79</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="left">DI</td>
<td align="left">bolt</td>
<td align="right">4.55</td>
<td align="right">3.90</td>
</tr>
<tr class="even">
<td align="left">4</td>
<td align="left">HA</td>
<td align="left">leopard</td>
<td align="right">6.26</td>
<td align="right">6.43</td>
</tr>
<tr class="odd">
<td align="left">5</td>
<td align="left">LA</td>
<td align="left">dryer</td>
<td align="right">2.43</td>
<td align="right">5.21</td>
</tr>
<tr class="even">
<td align="left">6</td>
<td align="left">DI</td>
<td align="left">fireman</td>
<td align="right">4.52</td>
<td align="right">6.47</td>
</tr>
</tbody>
</table>
</div>
<div id="question-6" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Question 6<a href="#question-6" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Join <code>ratings_long</code> with <code>words_small</code> and store this in <code>combined_data</code>. Here, we want to use a mutating join that will join the tables based on the column they have in common.</p>
<div class="sourceCode" id="cb470"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb470-1"><a href="#cb470-1" aria-hidden="true" tabindex="-1"></a>combined_data <span class="ot">&lt;-</span> <span class="cn">NULL</span></span></code></pre></div>
</div>
<div id="question-7" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Question 7<a href="#question-7" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We are almost ready to look at summary statistics, but we need to do two more things first. The participants have entered 0 as a rating when they didn’t know the word, or didn’t have time to read it. We only want to look at the trials where the participant knows what the word is. Remove the rows where the rating is 0 from <code>combined_data</code>. Store this in a dataframe called <code>combined_recog</code>.</p>
<div class="sourceCode" id="cb471"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb471-1"><a href="#cb471-1" aria-hidden="true" tabindex="-1"></a>combined_recog <span class="ot">&lt;-</span> <span class="cn">NULL</span></span></code></pre></div>
</div>
<div id="question-8" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Question 8<a href="#question-8" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Final step before summary statistics! Join <code>combined_recog</code> with <code>groups</code> and save it to <code>preprocessed_data</code>. You will get an error message trying to do this. Solve the error so you get the dataframe we are asking for.</p>
<p>HINT: There are multiple ways of solving the error. You can change your dataframe heading in an additional step, or you can use the help function to figure out what to do when the dataframes you are trying to join don’t match.</p>
<div class="sourceCode" id="cb472"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb472-1"><a href="#cb472-1" aria-hidden="true" tabindex="-1"></a>preprocessed_data <span class="ot">&lt;-</span> <span class="cn">NULL</span></span></code></pre></div>
</div>
<div id="question-9" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Question 9<a href="#question-9" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now we can calculate summary statistics from <code>preprocessed_data</code>. Make a new dataframe <code>rating_summary</code> in which you calculate mean rating and standard deviation of ratings (<code>rating</code> column) for each of the conditions and both participant groups. Call the columns in your summary table <code>mean</code> and <code>sd</code>.</p>
<ul>
<li>Hint 1: You need to do this in two steps. Combine the steps together with a pipeline operator: %&gt;%</li>
<li>Hint 2: You first want to make R think of the data in subgroups based on <code>condition</code> and <code>Group</code>. Only after that you should calculate the summary statistics.</li>
<li>Hint 3: Which dplyr function lets you calculate summary statistics for data?</li>
</ul>
<div class="sourceCode" id="cb473"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb473-1"><a href="#cb473-1" aria-hidden="true" tabindex="-1"></a>rating_summary <span class="ot">&lt;-</span> <span class="cn">NULL</span></span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;condition&#39;. You can override using the
## `.groups` argument.</code></pre>
<p>Now let’s visualise the data! We will use <code>preprocessed_data</code> for all the visualisations.</p>
</div>
<div id="question-10" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Question 10<a href="#question-10" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Make a boxplot of ratings. You want <code>condition</code> as the x-axis and <code>rating</code> as the y-axis. Make the ticks on the y-axis to show numbers from 1-9. Also, facet the plot by <code>Group</code>, and make the different <code>conditions</code> different colours (hint: use <code>fill</code> argument in the ggplot aes() to achieve this). When you are done, your boxplot should look like the one below.</p>
<div class="sourceCode" id="cb475"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb475-1"><a href="#cb475-1" aria-hidden="true" tabindex="-1"></a><span class="cn">NULL</span></span></code></pre></div>
<p><img src="Intro-to-R-GU-Open-Studies-2021-2022_files/figure-html/Q10S-1.png" width="672" /></p>
</div>
<div id="question-11" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Question 11<a href="#question-11" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Next, we want to see how the different features of the words we have collected from the database map onto each other. In dataframe <code>preprocessed_data</code>, we have a column for arousal ratings taken from the database called <code>AROUSAL</code>. We also have a column called <code>VALENCE</code> which shows how negative or positive the participants think these words are. Create a scatterplot to map <code>VALENCE</code> against <code>AROUSAL</code>.
Extra challenge: make the scatterplot points into different colours based on the word type (<code>condition</code>). When you are done, your scatterplot should look like the one below.</p>
<div class="sourceCode" id="cb476"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb476-1"><a href="#cb476-1" aria-hidden="true" tabindex="-1"></a><span class="cn">NULL</span></span></code></pre></div>
<p><img src="Intro-to-R-GU-Open-Studies-2021-2022_files/figure-html/Q11S-1.png" width="672" /></p>
<p><span style="font-size: 22px; font-weight: bold; color: hsl(24, 100%, 50%);">Finished</span></p>
<p>Well done, this is the end of the in-class exercise! We have three extra questions for those who are up for a challenge and would like to play around with the data a bit more.</p>
<H2>
Bonus Questions
</H2>
<p>We want to know which word people think is the most exciting and which one is the most boring. Let’s find out!</p>
</div>
<div id="question-12-bonus" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Question 12 (Bonus)<a href="#question-12-bonus" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We’ll go back to working with the <code>combined_recog</code> dataframe. Calculate a mean rating based on our participants’ ratings (the <code>rating</code> column) for each of the words. Call this column <code>mean_rating</code>. This process involves two steps, but put them together with the pipe operator and store it in <code>by_item_ratings</code>.
Hint: You need to make R think about the data in subsets based on the column <code>Word</code>, and then calculate the mean scores.</p>
<div class="sourceCode" id="cb477"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb477-1"><a href="#cb477-1" aria-hidden="true" tabindex="-1"></a>by_item_ratings <span class="ot">&lt;-</span> <span class="cn">NULL</span></span></code></pre></div>
<p>You should end up with a dataframe that has 240 rows and 2 columns.</p>
</div>
<div id="question-13-bonus" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Question 13 (Bonus)<a href="#question-13-bonus" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now we just need to find out which are the words with highest and lowest mean ratings. Arrange <code>by_item_ratings</code> in ascending order based on the mean rating.</p>
<div class="sourceCode" id="cb478"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb478-1"><a href="#cb478-1" aria-hidden="true" tabindex="-1"></a>by_item_arranged <span class="ot">&lt;-</span> <span class="cn">NULL</span></span></code></pre></div>
</div>
<div id="question-14-bonus" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Question 14 (Bonus)<a href="#question-14-bonus" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Which word is the least exciting (lowest mean rating) and which one is the most exciting (highest mean rating)? Type the words in the code chunk below. REMEMBER TO TYPE THEM WITH QUOTATION MARKS.</p>
<div class="sourceCode" id="cb479"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb479-1"><a href="#cb479-1" aria-hidden="true" tabindex="-1"></a>least_boring <span class="ot">&lt;-</span> <span class="st">&quot;NULL&quot;</span></span>
<span id="cb479-2"><a href="#cb479-2" aria-hidden="true" tabindex="-1"></a>most_exciting <span class="ot">&lt;-</span> <span class="st">&quot;NULL&quot;</span></span></code></pre></div>
</div>
</div>
<div id="solutions" class="section level2 hasAnchor" number="10.3">
<h2 class="hasAnchor"><span class="header-section-number">10.3</span> Solutions<a href="#solutions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="webex-solution">
<button>
Question 1
</button>
<div class="sourceCode" id="cb480"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb480-1"><a href="#cb480-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
</div>
<div class="webex-solution">
<button>
Question 2
</button>
<div class="sourceCode" id="cb481"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb481-1"><a href="#cb481-1" aria-hidden="true" tabindex="-1"></a>words <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;item_info.csv&quot;</span>)</span>
<span id="cb481-2"><a href="#cb481-2" aria-hidden="true" tabindex="-1"></a>ratings <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;ratings.csv&quot;</span>)</span>
<span id="cb481-3"><a href="#cb481-3" aria-hidden="true" tabindex="-1"></a>groups <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;groups.csv&quot;</span>)</span></code></pre></div>
</div>
<div class="webex-solution">
<button>
Question 3
</button>
<div class="sourceCode" id="cb482"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb482-1"><a href="#cb482-1" aria-hidden="true" tabindex="-1"></a>ratings_long <span class="ot">&lt;-</span> <span class="fu">gather</span>(ratings, <span class="st">&quot;item&quot;</span>, <span class="st">&quot;rating&quot;</span>, <span class="st">`</span><span class="at">1</span><span class="st">`</span><span class="sc">:</span><span class="st">`</span><span class="at">240</span><span class="st">`</span>)</span></code></pre></div>
</div>
<div class="webex-solution">
<button>
Question 4
</button>
<div class="sourceCode" id="cb483"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb483-1"><a href="#cb483-1" aria-hidden="true" tabindex="-1"></a>words_small <span class="ot">&lt;-</span> <span class="fu">select</span>(words, item, Word, AROUSAL, VALENCE)</span></code></pre></div>
</div>
<div class="webex-solution">
<button>
Question 5
</button>
<div class="sourceCode" id="cb484"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb484-1"><a href="#cb484-1" aria-hidden="true" tabindex="-1"></a>words_small <span class="ot">&lt;-</span> <span class="fu">separate</span>(words_small, item, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;item&quot;</span>, <span class="st">&quot;condition&quot;</span>), <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>)</span></code></pre></div>
</div>
<div class="webex-solution">
<button>
Question 6
</button>
<div class="sourceCode" id="cb485"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb485-1"><a href="#cb485-1" aria-hidden="true" tabindex="-1"></a>combined_data <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(ratings_long, words_small, <span class="at">by =</span> <span class="st">&quot;item&quot;</span>)</span></code></pre></div>
</div>
<div class="webex-solution">
<button>
Question 7
</button>
<div class="sourceCode" id="cb486"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb486-1"><a href="#cb486-1" aria-hidden="true" tabindex="-1"></a>combined_recog <span class="ot">&lt;-</span> <span class="fu">filter</span>(combined_data, rating<span class="sc">!=</span><span class="dv">0</span>)</span></code></pre></div>
</div>
<div class="webex-solution">
<button>
Question 8
</button>
<div class="sourceCode" id="cb487"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb487-1"><a href="#cb487-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Solution 1 - renaming the column in `combined_recog`</span></span>
<span id="cb487-2"><a href="#cb487-2" aria-hidden="true" tabindex="-1"></a>combined_data <span class="ot">&lt;-</span> combined_recog <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="st">&quot;Participant&quot;</span> <span class="ot">=</span> participant)</span>
<span id="cb487-3"><a href="#cb487-3" aria-hidden="true" tabindex="-1"></a>preprocessed_data <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(combined_data, groups, <span class="at">by =</span> <span class="st">&quot;Participant&quot;</span>)</span>
<span id="cb487-4"><a href="#cb487-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-5"><a href="#cb487-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Solution 1 as a pipe</span></span>
<span id="cb487-6"><a href="#cb487-6" aria-hidden="true" tabindex="-1"></a>preprocessed_data <span class="ot">&lt;-</span> combined_recog <span class="sc">%&gt;%</span> </span>
<span id="cb487-7"><a href="#cb487-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">&quot;Participant&quot;</span> <span class="ot">=</span> participant) <span class="sc">%&gt;%</span> </span>
<span id="cb487-8"><a href="#cb487-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(groups, <span class="at">by =</span> <span class="st">&quot;Participant&quot;</span>)</span>
<span id="cb487-9"><a href="#cb487-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb487-10"><a href="#cb487-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Solution 2 - using inner_join to match two headers that don&#39;t match</span></span>
<span id="cb487-11"><a href="#cb487-11" aria-hidden="true" tabindex="-1"></a>preprocessed_data <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(combined_recog, groups, <span class="fu">c</span>(<span class="st">&quot;participant&quot;</span> <span class="ot">=</span> <span class="st">&quot;Participant&quot;</span>))</span></code></pre></div>
</div>
<div class="webex-solution">
<button>
Question 9
</button>
<div class="sourceCode" id="cb488"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb488-1"><a href="#cb488-1" aria-hidden="true" tabindex="-1"></a>rating_summary <span class="ot">&lt;-</span> <span class="fu">group_by</span>(preprocessed_data, condition, Group) <span class="sc">%&gt;%</span> </span>
<span id="cb488-2"><a href="#cb488-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(rating), <span class="at">sd =</span> <span class="fu">sd</span>(rating))</span></code></pre></div>
</div>
<div class="webex-solution">
<button>
Question 10
</button>
<div class="sourceCode" id="cb489"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb489-1"><a href="#cb489-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(preprocessed_data, <span class="fu">aes</span>(condition, rating, <span class="at">fill=</span>condition)) <span class="sc">+</span> </span>
<span id="cb489-2"><a href="#cb489-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb489-3"><a href="#cb489-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>)) <span class="sc">+</span> </span>
<span id="cb489-4"><a href="#cb489-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Group)</span></code></pre></div>
<p><img src="Intro-to-R-GU-Open-Studies-2021-2022_files/figure-html/unnamed-chunk-392-1.png" width="672" /></p>
</div>
<div class="webex-solution">
<button>
Question 11
</button>
<div class="sourceCode" id="cb490"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb490-1"><a href="#cb490-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(preprocessed_data, <span class="fu">aes</span>(<span class="at">x=</span>AROUSAL, <span class="at">y=</span>VALENCE, <span class="at">colour=</span>condition)) <span class="sc">+</span> </span>
<span id="cb490-2"><a href="#cb490-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="Intro-to-R-GU-Open-Studies-2021-2022_files/figure-html/unnamed-chunk-393-1.png" width="672" /></p>
</div>
<div class="webex-solution">
<button>
Question 12 (Bonus)
</button>
<div class="sourceCode" id="cb491"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb491-1"><a href="#cb491-1" aria-hidden="true" tabindex="-1"></a>by_item_ratings <span class="ot">&lt;-</span> combined_recog <span class="sc">%&gt;%</span> </span>
<span id="cb491-2"><a href="#cb491-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Word) <span class="sc">%&gt;%</span> </span>
<span id="cb491-3"><a href="#cb491-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_rating =</span> <span class="fu">mean</span>(rating))</span></code></pre></div>
</div>
<div class="webex-solution">
<button>
Question 13 (Bonus)
</button>
<div class="sourceCode" id="cb492"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb492-1"><a href="#cb492-1" aria-hidden="true" tabindex="-1"></a>by_item_arranged <span class="ot">&lt;-</span> <span class="fu">arrange</span>(by_item_ratings, mean_rating)</span></code></pre></div>
</div>
<div class="webex-solution">
<button>
Question 14 (Bonus)
</button>
<div class="sourceCode" id="cb493"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb493-1"><a href="#cb493-1" aria-hidden="true" tabindex="-1"></a>least_exciting <span class="ot">&lt;-</span> <span class="st">&quot;slow&quot;</span></span>
<span id="cb493-2"><a href="#cb493-2" aria-hidden="true" tabindex="-1"></a>most_exciting <span class="ot">&lt;-</span> <span class="st">&quot;pleasure&quot;</span></span></code></pre></div>
</div>
<!--chapter:end:10-recap.Rmd-->
</div>
</div>
<div id="appendices" class="section level1 unnumbered hasAnchor">
<h1 class="unnumbered hasAnchor">Appendices<a href="#appendices" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="changing-the-appearance-of-rmarkdown" class="section level2 unnumbered hasAnchor">
<h2 class="unnumbered hasAnchor">Changing the Appearance of RMarkdown<a href="#changing-the-appearance-of-rmarkdown" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Spending any significant amount of time in front of a computer, especially in front of black text on a white background, can be headache inducing. Also, if your eyesight is not great, the effect can be multiplied and stressful.</p>
<p>You can change the appearance of RMarkdown, and many of us who spend hours on it usually do.</p>
<p>If you wish to change the appearance you can go to the tools menu and select “Global Options”:</p>
<center>
<img src="images/tools.png">
</center>
<p>Next, click “Appearance” in the box on the left:</p>
<center>
<img src="images/appearance.png">
</center>
<p>Here you can change the Editor font, font size and the editor theme (the colours of the text). Make the selections you want and then press “Apply” to make them stick.</p>
<div class="warning">
<p>
Changing the “zoom” to too big a size can make it <em>extremely</em>
difficult to use the software or to even change it back.
</p>
<p>
Edit the <strong>font size</strong> and only tinker with the zoom
when absolutely neccessary!
</p>
</div>
</div>
<div id="source-materials" class="section level2 unnumbered hasAnchor">
<h2 class="unnumbered hasAnchor">Source Materials<a href="#source-materials" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This course has been remixed from the following sources.</p>
<p>If you wish to further your reading we would advise looking over these sources yourself. They are aimed at a variety of different level students, thus they may move a little faster and have greater expectations of prior knowledge.</p>
<ul>
<li>Our Level 1 Data Skills Handbook <span class="citation">(<a href="#ref-l1book" role="doc-biblioref">Nordmann and Woods 2019</a>)</span></li>
</ul>
</div>
<div id="further-reading-1" class="section level2 unnumbered hasAnchor">
<h2 class="unnumbered hasAnchor">Further Reading<a href="#further-reading-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="statistics" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">Statistics<a href="#statistics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="learning-the-general-linear-model" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Learning the General Linear Model<a href="#learning-the-general-linear-model" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>For those who have some knowledge of statistics who wish to gain a wider understanding of the General linear model framework we recommend Miller and Haden <span class="citation">(<a href="#ref-millerandhaden" role="doc-biblioref">2013</a>)</span>. <a href="https://www.freetechbooks.com/statistical-analysis-with-the-general-linear-model-t1303.html">This textbook</a> is also open source and free to download and is the book that we recommend to our <strong>third year</strong> psychology students.</p>
</div>
</div>
<div id="more-advanced-use-of-r" class="section level3 unnumbered hasAnchor">
<h3 class="unnumbered hasAnchor">More Advanced Use of R<a href="#more-advanced-use-of-r" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For those who are looking to read in more detail about what we have been doing in this class:</p>
<ul>
<li>R for Data Science <span class="citation">(<a href="#ref-rfordatascience" role="doc-biblioref">Grolemund and Wickham 2016</a>)</span>.</li>
</ul>
<p>For those who want to use RMarkdown to publish documents:</p>
<ul>
<li>Bookdown: Authoring Books and Technical Documents with RMarkdown <span class="citation">(<a href="#ref-xie2015" role="doc-biblioref">Xie 2015</a>)</span>. This course book was written using this package.</li>
<li>RMarkdown Websites <span class="citation">(<a href="#ref-rmarkdownweb" role="doc-biblioref">Grolemund 2016</a>)</span>.</li>
</ul>
</div>
</div>
</div>
<div id="references" class="section level1 hasAnchor" number="11">
<h1 class="hasAnchor"><span class="header-section-number">11</span> References<a href="#references" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<!--chapter:end:11-appendices.Rmd-->
</div>
<div id="before" class="section level1 unnumbered hasAnchor">
<h1 class="unnumbered hasAnchor">Assignment before starting the course<a href="#before" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This assignment is an important one as it will enable you to complete your future assignments. It looks long, but it is mostly screenshots to guide you through the process of installing the required software, or a short guide on how to use RStudio Cloud.</p>
<div id="accessing" class="section level2 hasAnchor" number="11.1">
<h2 class="hasAnchor"><span class="header-section-number">11.1</span> Access to RStudio<a href="#accessing" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Please ensure by the next class that you have access to the software so that you can practice using the formative assignments and complete the summative assignments when they are issued.</p>
<p>The first summative assignment will be issued after class next week and you will be given one week to complete and submit it.</p>
<div id="install" class="section level3 hasAnchor" number="11.1.1">
<h3 class="hasAnchor"><span class="header-section-number">11.1.1</span> Installing R and RStudio on Your Own Machine<a href="#install" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Unfortunately this is not as simple as installing software normally is on your computer. There are two separate things that you will need to install.</p>
<div id="first-install-r-1" class="section level4 hasAnchor" number="11.1.1.1">
<h4 class="hasAnchor"><span class="header-section-number">11.1.1.1</span> First: Install R<a href="#first-install-r-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Follow <a href="https://www.stats.bris.ac.uk/R/">this link</a> and click on the part that says Download R R-4.1.3-win for Windows (or Mac). You will get the following pop-up dialogue (please note that as you are installing a newer version of R your download will be called R-4.1.3-win.exe instead of R-3.6.2 in the picture):</p>
<center>
<img src="images/download_prompt_R.png">
</center>
<p>Click “Save File”. The file will then be downloaded to your computer, most likely the “Downloads” folder unless you have changed your settings. Double click to run the file.</p>
<p>You will be asked if you want to allow this to make changes to your computer, click yes. Select your language preference, review the license agreement and click next. The following screen will be presented:</p>
<center>
<img src="images/install_wiz_1.png">
</center>
<p>Click next without changing the folder. The next screen let’s you customise the installation, but we shouldn’t need to make any changes at this point so click next without unselecting any components:</p>
<center>
<img src="images/install_wiz_2.png">
</center>
<p>Also leave the star-up options as standard and click next:</p>
<center>
<img src="images/install_wiz_3.png">
</center>
<p>Leave the start menu folder as standard:</p>
<center>
<img src="images/install_wiz_4.png">
</center>
<p>Don’t make any changes to the additional tasks part, just click next:</p>
<center>
<img src="images/install_wiz_5.png">
</center>
<p>The Install Wizard will then install R:</p>
<center>
<img src="images/install_wiz_6.png">
</center>
<p>You will be told when installation is complete:</p>
<center>
<img src="images/install_wiz_7.png">
</center>
</div>
<div id="second-install-rstudio-1" class="section level4 hasAnchor" number="11.1.1.2">
<h4 class="hasAnchor"><span class="header-section-number">11.1.1.2</span> Second: Install RStudio<a href="#second-install-rstudio-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Follow <a href="https://rstudio.com/products/rstudio/download/">this link</a> to the RStudio website. Scroll down and press the button “Download” under RStudio Desktop- not the Server Option. On the next page press the button under stage 2, “Download RStudio for Windows”. Your download will start and you will see the following prompt (note your as your download is a newer version it will again be named slightly differently RStudio-2022.02.1-461) :</p>
<center>
<img src="images/download_prompt_Rstudio.png">
</center>
<p>Click “Save File” when the button becomes active.</p>
<p>Look in your download folder and double click the downloaded file. Click to allow the program to make changes to your computer. You will see this part next:</p>
<center>
<img src="images/install_wiz_studio_1.png">
</center>
<p>Click next on this next window. Do not change the installation location. Click next:</p>
<center>
<img src="images/install_wiz_studio_2.png">
</center>
<p>You will be taken to this screen. Again, don’t change the start menu folder location here.</p>
<center>
<img src="images/install_wiz_studio_3.png">
</center>
<p>Click next and the installation will begin:</p>
<center>
<img src="images/install_wiz_studio_4.png">
</center>
<p>You will then be notified when the installation is complete with this screen:</p>
<center>
<img src="images/install_wiz_studio_5.png">
</center>
</div>
<div id="opening-rstudio-1" class="section level4 hasAnchor" number="11.1.1.3">
<h4 class="hasAnchor"><span class="header-section-number">11.1.1.3</span> Opening RStudio<a href="#opening-rstudio-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Remember that we have installed <strong>two</strong> programs on our computer. R, which is the base program, and RStudio, which is an extension of R.</p>
<p>The software that we want to open and use is RStudio, not R. We want the shiny interface and added features.</p>
</div>
</div>
<div id="accessing-rstudio-on-university-computers-1" class="section level3 hasAnchor" number="11.1.2">
<h3 class="hasAnchor"><span class="header-section-number">11.1.2</span> Accessing RStudio on University Computers<a href="#accessing-rstudio-on-university-computers-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If you have a student card you will be able to access computing facilities provided for students, including those in the various libraries across campus. All university computers should have R and RStudio installed, as well as the required packages for this course.</p>
<p>You will not be required to install anything on university computers, please don’t attempt to do so because we don’t want the IT guys to yell at us.</p>
<p>To login to the university computers you will require your GUID and password.</p>
</div>
<div id="using-rstudio-cloud-1" class="section level3 hasAnchor" number="11.1.3">
<h3 class="hasAnchor"><span class="header-section-number">11.1.3</span> Using RStudio Cloud<a href="#using-rstudio-cloud-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We recognise that not all students will have access to their own computers, and that some of those students will not be able to travel to campus to use the provided facilities. For this reason we recommend to those in that postition to think about using RStudio Cloud, available <a href="https://rstudio.cloud/">here</a>.</p>
<p>The RStudio Cloud allows you an electronic workspace, hosted by the RStudio team themselves.</p>
<p>Navigate to the page and click the “Sign Up” button at the top right-hand side of the page.</p>
<p>Once you are logged in you will see your (for now) empty workspace:</p>
<center>
<img src="images/rstudio_cloud.png">
</center>
<p>Click on “new project” and you will be taken to this page:</p>
<center>
<img src="images/rstudio_cloud_new.png">
</center>
<p>As you can see it is almost identical to the way the program would appear on your computer if you had installed it there.</p>
<p>To name your project you can click the name at the top of the page and type in a new one:</p>
<center>
<img src="images/rstudio_cloud_nameproj.png">
</center>
<p>You will also need to upload any data files to the server before you can work with them. This is done with the
addition to the panel Files/Plots/Packages/Help/Viewer on the right- the “Files” pane now had a button to upload:</p>
<center>
<img src="images/rstudio_cloud_upload1.png">
</center>
<p>Pressing this will open a pop-up box. Click on the “browse” button, navigate through your directories and identify the file you wish to upload and confirm. Then press ok. The file should then be uploaded and displayed in the files pane.</p>
<center>
<img src="images/rstudio_cloud_upload2.png">
</center>
<div class="info">
<p>
If at any point you are struggling to access the required materials
or software it is important that you contact the tutors <strong>at the
earliest opportunity</strong> to discuss the issues you are having.
</p>
<p>
We want you to do well and have a good experience learning with us,
let us know if you are experiencing difficulty so that we may help you
resolve it!
</p>
</div>
<div id="downloading-your-files-from-rstudio-cloud-1" class="section level4 hasAnchor" number="11.1.3.1">
<h4 class="hasAnchor"><span class="header-section-number">11.1.3.1</span> Downloading Your Files from RStudio Cloud<a href="#downloading-your-files-from-rstudio-cloud-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>If you are using RStudio Cloud your files will be saved on the cloud, but you will need to download the .Rmd files that you have been working with (containing coursework etc) to upload them to the assignment submission pages on Moodle.</p>
<p>Here you can see the file <code>myfile.Rmd</code> that I have made on the cloud. To download it I select the checkbox next to the file and click on the “More” drop-down menu and click “export”, as shown here:</p>
<center>
<img src="images/rstudio_cloud_download1.png">
</center>
<p>I then get a dialogue box asking me if I want to name the file something different. I will stick with the original name, so I just click “Download”:</p>
<center>
<img src="images/rstudio_cloud_download2.png">
</center>
<p>Now I get a pop-up as I would when downloading any other file. To save the file ensure “Save File” is selected and click “OK”:</p>
<center>
<img src="images/rstudio_cloud_download3.png">
</center>
<p>The file will then be saved in the folder where your downloads are saved (usually the “Downloads” folder by default). You can then navigate to this file when browsing files to upload to Moodle.</p>
</div>
</div>
</div>
<div id="maximising-reproducibility-and-visibility-1" class="section level2 hasAnchor" number="11.2">
<h2 class="hasAnchor"><span class="header-section-number">11.2</span> Maximising Reproducibility and Visibility<a href="#maximising-reproducibility-and-visibility-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In order to set up R the way that we require, there are a few more steps.</p>
<p>First, open RStudio and click on the Tools menu at the top of the page and click on the part that says “Global Options”:</p>
<center>
<img src="images/tools.png">
</center>
<p>Next, a dialogue box will open. Ensure that these tick boxes and options are selected on yours and click apply:</p>
<center>
<img src="images/options.png">
</center>
<p>Finally, go to RMarkdown and ensure that this option is unchecked:</p>
<center>
<img src="images/inline.png">
</center>
<p>This meaning of the first part will be discussed in future lessons, and the second will mean that graphs that you make will be in the “Plots” tab to the right of the console. This means that code will not be obscured whenever you make a graph.</p>
<!--chapter:end:test.Rmd-->
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-rmarkdownweb" class="csl-entry">
Grolemund, Garrett. 2016. <span>“RMarkdown Websites.”</span> 2016. <a href="https://garrettgman.github.io/rmarkdown/rmarkdown_websites.html">https://garrettgman.github.io/rmarkdown/rmarkdown_websites.html</a>.
</div>
<div id="ref-rfordatascience" class="csl-entry">
Grolemund, Garrett, and Hadley Wickham. 2016. <span>“R for Data Science.”</span> 2016. <a href="https://r4ds.had.co.nz/">https://r4ds.had.co.nz/</a>.
</div>
<div id="ref-millerandhaden" class="csl-entry">
Miller, Jeff, and Patricia Haden. 2013. <em>Statistical Analysis with the General Linear Model</em>. <a href="https://www.freetechbooks.com/statistical-analysis-with-the-general-linear-model-t1303.html">https://www.freetechbooks.com/statistical-analysis-with-the-general-linear-model-t1303.html</a>.
</div>
<div id="ref-l1book" class="csl-entry">
Nordmann, Emily, and Heather Cleland Woods. 2019. <span>“Level 1 Data Skills.”</span> 2019. <a href="https://psyteachr.github.io/ug1-practical/index.html">https://psyteachr.github.io/ug1-practical/index.html</a>.
</div>
<div id="ref-xie2015" class="csl-entry">
Xie, Yihui. 2015. <em>Dynamic Documents with <span>R</span> and Knitr</em>. 2nd ed. Boca Raton, Florida: Chapman; Hall/CRC. <a href="http://yihui.name/knitr/">http://yihui.name/knitr/</a>.
</div>
</div>
</div>
</div>
<!--bookdown:body:end-->
<script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  if (t = document.getElementById("webex-total_correct")) {
    var correct = document.getElementsByClassName("webex-correct").length;
    var solvemes = document.getElementsByClassName("webex-solveme").length;
    var radiogroups = document.getElementsByClassName("webex-radiogroup").length;
    var selects = document.getElementsByClassName("webex-select").length;
    
    t.innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");
  
  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");
  
  var cl = this.classList
  
  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;
  
  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }
  
  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

window.onload = function() {
  console.log("onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;
  }
  
  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }
  
  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
  }

  update_total_correct();
}

</script>

            </section>

          </div>
        </div>
      </div>
<!--bookdown:link_prev-->
<!--bookdown:link_next-->
    </div>
  </div>
<!--bookdown:config-->

</body>

</html>
